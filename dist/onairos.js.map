{"version":3,"file":"onairos.js","names":["_react","_interopRequireWildcard","require","_OnairosBlack","_interopRequireDefault","_kms","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","initiateOthent","userDetails","connect","console","log","OthentKey","getActiveKey","Onairos","_ref","requestData","webpageName","proofMode","OnairosAnime","ConnectOnairos","error","token","domain","window","location","href","HashedActive","EncryptUserDetails","postMessage","source","type","createElement","className","onClick","src","alt","_default","exports"],"sources":["../src/onairos.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport onairosLogo from \"./OnairosBlack.png\";\r\nimport {connect, encrypt, getActiveKey} from \"@othent/kms\";\r\n// import {connect, encrypt, getActiveKey} from \"@othent/kms-unbundled\";\r\n// const {connect, getActiveKey, encrypt, getActivePublicKey } = require(\"@othent/kms\");\r\n// const {connect, getActiveKey, encrypt, getActivePublicKey } = require(\"@othent/kms-unbundled\");\r\n// import * as OthentKMS from \"@othent/kms\";\r\n// import connect from '@othent/kms' ;\r\n// import  getActiveKey from '@othent/kms' ;\r\n\r\n\r\nasync function initiateOthent(){\r\n  // const userDetails = await OthentKMS.connect();\r\n\r\n//   // // New Othent KMS System\r\n  const userDetails = await connect();\r\n  console.log(\"Othent KMS : \", userDetails);\r\n  try{\r\n    const OthentKey = await getActiveKey();\r\n    console.log(\"OthentKey : \", OthentKey);\r\n  }catch(e){\r\n    console.log(\"Error : \", e);\r\n\r\n  }\r\n  \r\n  // async function handleEncrypt(data){\r\n  //   const res =  await encrypt(data);\r\n  //   console.log(`Encrypted USerdata: ${JSON.stringify(res)}, and length ${JSON.stringify(res).length}`)\r\n  //   return res;\r\n  // };\r\n  // // const encryptedOthentKey = await encryptWithPublicKey(OnairosPublicKey, OthentKey);\r\n  // // JWK Encyrpt Othent Web2 User Details, \r\n  // const encryptedOthentKey = await handleEncrypt(JSON.stringify(userDetails));\r\n  // console.log(\"encryptedOthentKey : \", encryptedOthentKey)\r\n}\r\n\r\nfunction Onairos( {requestData, webpageName, proofMode=false}) {\r\n  // const [token,setToken] = useState('');\r\n  const OnairosAnime = async () => {\r\n    try {\r\n      console.log(\"Clicked Onairos Connect\")\r\n      await ConnectOnairos();\r\n    } catch (error) {\r\n      // Handle any errors here\r\n      console.error(\"Error connecting to Onairos\", error);\r\n    }\r\n  };\r\n\r\n  var token;\r\n    // connect().then(\r\n    //   (response) =>{\r\n    //     console.log(\"USer Details: \", response)\r\n    //   }\r\n    // ).catch((e)=>{\r\n    //   console.log(\"error : \", e);\r\n    // }\r\n    // );\r\n  \r\n\r\n    const domain = window.location.href;\r\n\r\n  // async function requestToken(){\r\n  //   const response = await fetch('https://api2.onairos.uk/dev/request-token', {\r\n  //       method: 'POST',\r\n  //       headers: {\r\n  //           'Content-Type': 'application/json',\r\n  //       },\r\n  //       body: JSON.stringify({\r\n  //         domain:domain,\r\n  //         userOthentKey:userOthentKey\r\n  //       })\r\n  //   });\r\n\r\n  //   if (!response.ok) {\r\n  //       throw new Error('Token request failed: ' + response.statusText);\r\n  //   }\r\n\r\n  //   const data = await response.json();\r\n  //   token = data.token;\r\n  //   // this.token = data.token; // Store the token\r\n  // }\r\n\r\n  const ConnectOnairos = async () => {\r\n    // Title here has to match a model in the Users : accountInfo.AccountInfo.models\r\n    // Prepare the data to be sent\r\n    // Send the data to the content script\r\n    \r\n    // await requestToken();\r\n    // await initiateOthent();\r\n    const HashedActive = \"HashedActive\";\r\n    const EncryptUserDetails = \"EncryptUserDetails\";\r\n    window.postMessage({\r\n      source: 'webpage',\r\n      type: 'GET_API_URL',\r\n      webpageName: webpageName,\r\n      domain:domain,\r\n      requestData: requestData,\r\n      proofMode:proofMode,\r\n      HashedActive:HashedActive,\r\n      EncryptUserDetails:EncryptUserDetails\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button\r\n        className=\"OnairosConnect w-20 h-20 flex flex-col items-center justify-center text-white font-bold py-2 px-4 rounded cursor-pointer\"\r\n        onClick={OnairosAnime}\r\n      >\r\n        <img src={\"https://onairos.sirv.com/Images/OnairosBlack.png\"} \r\n        alt=\"Onairos Logo\" className=\"w-16 h-16 object-contain mb-2\" /> {/* Adjust size as needed */}\r\n        <span className=\"whitespace-nowrap\">Connect to Onairos</span> {/* Prevent text from wrapping */}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Onairos;\r\n\r\n"],"mappings":"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"}