{"version":3,"file":"812.js","mappings":"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","sources":["webpack://OnairosLaravel/./src/components/WelcomeScreen.jsx","webpack://OnairosLaravel/./src/theme/colors.js","webpack://OnairosLaravel/./src/components/ui/PrimaryButton.jsx","webpack://OnairosLaravel/./src/components/EmailAuth.js","webpack://OnairosLaravel/./src/components/ConnectChatGPTModal.jsx","webpack://OnairosLaravel/./src/components/UniversalOnboarding.jsx","webpack://OnairosLaravel/./src/components/PinSetup.js","webpack://OnairosLaravel/./src/components/DataRequest.js","webpack://OnairosLaravel/./src/components/TrainingComponent.jsx","webpack://OnairosLaravel/./src/components/TrainingScreen.jsx","webpack://OnairosLaravel/./src/components/LoadingScreen.jsx","webpack://OnairosLaravel/./src/components/WrappedLoadingPage.jsx","webpack://OnairosLaravel/./src/utils/responseFormatter.js","webpack://OnairosLaravel/./src/utils/userDataFormatter.js","webpack://OnairosLaravel/./src/components/ui/PageLayout.jsx","webpack://OnairosLaravel/./src/onairosButton.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { COLORS } from '../theme/colors.js';\n\nexport default function WelcomeScreen({ onContinue, onClose }) {\n  // Load Sirv script for responsive images\n  useEffect(() => {\n    const script = document.createElement('script');\n    script.src = 'https://scripts.sirv.com/sirvjs/v3/sirv.js';\n    script.async = true;\n    document.head.appendChild(script);\n    \n    return () => {\n      const existingScript = document.querySelector('script[src=\"https://scripts.sirv.com/sirvjs/v3/sirv.js\"]');\n      if (existingScript) {\n        document.head.removeChild(existingScript);\n      }\n    };\n  }, []);\n\n  return (\n    <div className=\"w-full flex flex-col\" style={{ height: '100%' }}>\n      {/* Content - Flexible center area */}\n      <div className=\"px-6 pt-16 text-center flex-1 flex flex-col\">\n        {/* Logo */}\n        <div className=\"mb-8 flex justify-center\">\n          <div className=\"w-20 h-20 flex items-center justify-center\">\n            <img \n              className=\"Sirv w-full h-full object-contain\" \n              data-src=\"https://anushkasirv.sirv.com/OnairosBlack.png\" \n              alt=\"Onairos Logo\"\n            />\n          </div>\n        </div>\n\n        {/* Welcome Text */}\n        <p className=\"text-gray-500 text-sm mb-2\">Welcome to</p>\n\n        {/* Main Title */}\n        <h1 className=\"text-4xl font-bold text-gray-900 mb-6 text-balance\">Onairos</h1>\n\n        {/* Description */}\n        <p className=\"text-gray-600 text-base leading-relaxed mb-12 text-pretty px-2\">\n          OnairOS personalizes your digital experience on every app so you can just enjoy being you!\n        </p>\n      </div>\n\n      {/* Get Started Button - Fixed at bottom */}\n      <div className=\"px-6 pb-8 flex-shrink-0\">\n        <button\n          className=\"w-full bg-gray-900 hover:bg-gray-800 text-white rounded-full py-4 text-base font-medium flex items-center justify-center gap-2 transition-colors\"\n          onClick={onContinue}\n        >\n          Get Started\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n          </svg>\n        </button>\n      </div>\n    </div>\n  );\n}\n","// Theme colors for Onairos SDK - derived from mobile design\nexport const COLORS = {\n  // Button gradient colors\n  btnGradStart: '#1A1A1A',\n  btnGradEnd: '#000000',\n  \n  // Button text and icon colors\n  btnLabel: '#FFFFFF',\n  btnBorder: 'rgba(0, 0, 0, 0.2)',\n  \n  // Icon circle gradient colors\n  iconCircleGradientStart: '#333333',\n  iconCircleGradientEnd: '#1A1A1A',\n  \n  // Background colors\n  background: '#FFFFFF',\n  backgroundSecondary: '#F8F9FA',\n  \n  // Text colors\n  textPrimary: '#1A1A1A',\n  textSecondary: '#6B7280',\n  textMuted: '#9CA3AF',\n  \n  // Border colors\n  border: '#E5E7EB',\n  borderLight: '#F3F4F6',\n  \n  // Status colors\n  success: '#10B981',\n  error: '#EF4444',\n  warning: '#F59E0B',\n  info: '#3B82F6',\n  \n  // Interactive states\n  hover: 'rgba(0, 0, 0, 0.05)',\n  pressed: 'rgba(0, 0, 0, 0.1)',\n  focus: 'rgba(59, 130, 246, 0.1)',\n};\n\nexport default COLORS; ","import React, { useState } from 'react';\nimport { COLORS } from '../../theme/colors.js';\n\n// Icon Circle component matching the React Native version\nconst IconCircle = ({ \n  size = 40, \n  children,\n  className = ''\n}) => {\n  return (\n    <div \n      className={`relative flex items-center justify-center border border-black border-opacity-25 ${className}`}\n      style={{\n        width: size,\n        height: size,\n        borderRadius: size / 2,\n        background: `linear-gradient(to bottom, ${COLORS.iconCircleGradientStart}, ${COLORS.iconCircleGradientEnd})`\n      }}\n    >\n      {children || (\n        <span \n          className=\"font-semibold opacity-95\"\n          style={{\n            fontSize: '20px',\n            color: COLORS.btnLabel,\n            backgroundColor: 'transparent'\n          }}\n        >\n          \n        </span>\n      )}\n    </div>\n  );\n};\n\n// Primary Button component matching the React Native design\nconst PrimaryButton = ({\n  label = \"Get Started\",\n  onClick,\n  iconRight,\n  loading = false,\n  disabled = false,\n  testId,\n  className = '',\n  style = {},\n  textStyle = {},\n  centered = false,\n  ...props\n}) => {\n  const [pressed, setPressed] = useState(false);\n\n  const handleMouseDown = () => setPressed(true);\n  const handleMouseUp = () => setPressed(false);\n  const handleMouseLeave = () => setPressed(false);\n\n  const buttonStyle = {\n    height: '48px',\n    borderRadius: '100px',\n    border: `1px solid ${COLORS.btnBorder}`,\n    background: `linear-gradient(to bottom, ${COLORS.btnGradStart}, ${COLORS.btnGradEnd})`,\n    position: 'relative',\n    overflow: 'hidden',\n    width: centered ? 'auto' : '100%',\n    minWidth: centered ? '250px' : 'auto',\n    maxWidth: centered ? '350px' : 'none',\n    margin: centered ? '0 auto' : '0',\n    cursor: disabled ? 'not-allowed' : 'pointer',\n    opacity: disabled ? 0.65 : 1,\n    boxShadow: disabled ? 'none' : '20px 30px 40px rgba(0,0,0,0.10)',\n    transition: 'all 0.2s ease',\n    ...style\n  };\n\n  const pressedOverlayStyle = {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(0,0,0,0.1)',\n    borderRadius: '100px',\n    opacity: pressed ? 1 : 0,\n    transition: 'opacity 0.1s ease'\n  };\n\n  const textContainerStyle = {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'transparent'\n  };\n\n  const iconPositionStyle = {\n    position: 'absolute',\n    right: '4px',\n    top: '4px',\n    bottom: '4px',\n    width: '40px',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'transparent'\n  };\n\n  const labelStyle = {\n    fontFamily: 'Inter, system-ui, sans-serif',\n    fontWeight: '600',\n    fontSize: '16px',\n    color: COLORS.btnLabel,\n    textAlign: 'center',\n    backgroundColor: 'transparent',\n    ...textStyle\n  };\n\n  return (\n    <button\n      className={`relative ${className}`}\n      style={buttonStyle}\n      onClick={onClick}\n      onMouseDown={handleMouseDown}\n      onMouseUp={handleMouseUp}\n      onMouseLeave={handleMouseLeave}\n      disabled={disabled || loading}\n      data-testid={testId}\n      aria-label={label}\n      {...props}\n    >\n      {/* Pressed state overlay */}\n      <div style={pressedOverlayStyle} />\n\n      {/* Centered text container */}\n      <div style={textContainerStyle}>\n        {loading ? (\n          <div \n            className=\"animate-spin rounded-full border-2 border-white border-t-transparent\"\n            style={{ width: '20px', height: '20px' }}\n          />\n        ) : (\n          <span style={labelStyle}>{label}</span>\n        )}\n      </div>\n\n      {/* Icon in fixed position on right */}\n      <div style={iconPositionStyle}>\n        {!loading && (iconRight || <IconCircle />)}\n      </div>\n    </button>\n  );\n};\n\nexport { IconCircle };\nexport default PrimaryButton; ","import React, { useState, useEffect, useRef } from 'react';\nimport PrimaryButton from './ui/PrimaryButton';\nimport { isMobileApp, isMobileBrowser } from '../utils/capacitorDetection';\n\nconst isMobile = () => {\n  if (typeof window === 'undefined') return false;\n  return isMobileApp() || isMobileBrowser() || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n};\n\nconst sdkConfig = {\n  apiKey: process.env.REACT_APP_ONAIROS_API_KEY || 'ona_VvoHNg1fdCCUa9eBy4Iz3IfvXdgLfMFI7TNcyHLDKEadPogkbjAeE2iDOs6M7Aey',\n  baseUrl: process.env.REACT_APP_ONAIROS_BASE_URL || 'https://api2.onairos.uk',\n};\n\nconst EmailAuth = ({ onComplete, appName = 'Onairos', appIcon, headerImage, username: initialUsername, rawMemoriesOnly, rawMemoriesConfig }) => {\n  const [step, setStep] = useState('email'); // email, verify, success\n  const [email, setEmail] = useState('');\n  const [otp, setOtp] = useState(['', '', '', '', '', '']);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [isNewUser, setIsNewUser] = useState(false);\n  const [resendTimer, setResendTimer] = useState(0);\n  \n  // Use a ref for inputs to manage focus\n  const otpRefs = useRef([]);\n\n  // Clear error when user types\n  useEffect(() => {\n    if (error) setError('');\n  }, [email, otp]);\n\n  // Timer for resend button\n  useEffect(() => {\n    let interval;\n    if (resendTimer > 0) {\n      interval = setInterval(() => {\n        setResendTimer((prev) => prev - 1);\n      }, 1000);\n    }\n    return () => clearInterval(interval);\n  }, [resendTimer]);\n\n  const handleEmailSubmit = async () => {\n    // Basic email validation\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      setError('Please enter a valid email address');\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const res = await fetch(`${sdkConfig.baseUrl}/auth/email/initiate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-api-key': sdkConfig.apiKey\n        },\n        body: JSON.stringify({ email })\n      });\n\n      const data = await res.json();\n      \n      if (!res.ok) {\n        throw new Error(data.message || 'Failed to send verification code');\n      }\n\n      setStep('verify');\n      setResendTimer(30); // 30 seconds cooldown\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleVerify = async () => {\n    const code = otp.join('');\n    if (code.length !== 6) {\n      setError('Please enter the complete 6-digit code');\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const res = await fetch(`${sdkConfig.baseUrl}/auth/email/verify`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-api-key': sdkConfig.apiKey\n        },\n        body: JSON.stringify({ email, code })\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        throw new Error(data.message || 'Invalid verification code');\n      }\n\n      // Store user info\n      localStorage.setItem('onairosUser', JSON.stringify({\n        email: data.user.email,\n        id: data.user.id,\n        isNewUser: data.isNewUser\n      }));\n      \n      // If we got a username back, store it\n      if (data.user.username) {\n        localStorage.setItem('username', data.user.username);\n      }\n\n      setIsNewUser(data.isNewUser);\n      \n      // Call onComplete with the user data\n      onComplete({\n        email: data.user.email,\n        userId: data.user.id,\n        isNewUser: data.isNewUser,\n        username: data.user.username\n      });\n      \n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleOtpChange = (index, value) => {\n    // Allow only numbers\n    if (value && !/^\\d+$/.test(value)) return;\n\n    const newOtp = [...otp];\n    newOtp[index] = value;\n    setOtp(newOtp);\n\n    // Auto-advance focus\n    if (value && index < 5) {\n      otpRefs.current[index + 1]?.focus();\n    }\n  };\n\n  const handleKeyDown = (index, e) => {\n    // Handle backspace\n    if (e.key === 'Backspace' && !otp[index] && index > 0) {\n      otpRefs.current[index - 1]?.focus();\n    }\n  };\n\n  const handlePaste = (e) => {\n    e.preventDefault();\n    const pastedData = e.clipboardData.getData('text').slice(0, 6).replace(/\\D/g, '');\n    \n    if (pastedData) {\n      const newOtp = [...otp];\n      pastedData.split('').forEach((char, index) => {\n        if (index < 6) newOtp[index] = char;\n      });\n      setOtp(newOtp);\n      \n      // Focus the next empty input or the last one\n      const nextIndex = Math.min(pastedData.length, 5);\n      otpRefs.current[nextIndex]?.focus();\n    }\n  };\n\n  // Render Step 1: Email Input\n  if (step === 'email') {\n    return (\n      <div className=\"flex flex-col h-full px-6 pt-4\">\n        <div className=\"flex-1 flex flex-col\">\n          {/* Header */}\n          <div className=\"mb-6 w-full text-left\">\n            <h1 \n              className=\"text-2xl font-bold mb-2 leading-tight\"\n              style={{ \n                fontFamily: 'IBM Plex Sans, system-ui, sans-serif',\n                color: '#1F242F' \n              }}\n            >\n              Build your Onairos persona to own your digital identity\n            </h1>\n            <p \n              className=\"text-base\"\n              style={{ \n                fontFamily: 'Inter, system-ui, sans-serif',\n                color: '#62646C' \n              }}\n            >\n              Sign in or create an account\n            </p>\n          </div>\n\n          {/* Input */}\n          <div className=\"w-full mb-6\">\n            <input\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              placeholder=\"Enter your email\"\n              className=\"w-full outline-none transition-all placeholder-gray-500\"\n              style={{\n                height: 56,\n                backgroundColor: '#F5F5F5',\n                borderRadius: 8,\n                paddingLeft: 16,\n                paddingRight: 16,\n                fontSize: 16,\n                fontFamily: 'Inter, system-ui, sans-serif',\n                color: '#1F242F',\n                border: '1px solid #E5E5E5'\n              }}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') handleEmailSubmit();\n              }}\n              disabled={isLoading}\n              autoFocus\n            />\n            {error && (\n              <p className=\"mt-2 text-sm text-red-500 font-medium text-left\">\n                {error}\n              </p>\n            )}\n          </div>\n\n          <div className=\"flex-1\" />\n\n          {/* Button */}\n          <div className=\"w-full pb-6\">\n            <PrimaryButton\n              label={isLoading ? 'Loading...' : 'Continue'}\n              onClick={handleEmailSubmit}\n              disabled={isLoading || !email.trim()}\n              loading={isLoading}\n              className=\"!text-white w-full\"\n              textStyle={{ color: '#FFFFFF' }}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Render Step 2: Verify Code\n  return (\n    <div className=\"flex flex-col h-full px-6 pt-4\">\n      <div className=\"flex-1 flex flex-col\">\n        {/* Header */}\n        <div className=\"mb-8 w-full text-left\">\n          <h1 \n            className=\"text-2xl font-bold mb-2 leading-tight\"\n            style={{ \n              fontFamily: 'IBM Plex Sans, system-ui, sans-serif',\n              color: '#1F242F' \n            }}\n          >\n            Check your email\n          </h1>\n          <p \n            className=\"text-base\"\n            style={{ \n              fontFamily: 'Inter, system-ui, sans-serif',\n              color: '#62646C' \n            }}\n          >\n            We sent a code to <span className=\"font-semibold text-gray-900\">{email}</span>\n          </p>\n        </div>\n\n        {/* OTP Inputs */}\n        <div className=\"flex justify-between gap-2 mb-8\" onPaste={handlePaste}>\n          {otp.map((digit, index) => (\n            <input\n              key={index}\n              ref={(el) => (otpRefs.current[index] = el)}\n              type=\"text\"\n              inputMode=\"numeric\"\n              maxLength={1}\n              value={digit}\n              onChange={(e) => handleOtpChange(index, e.target.value)}\n              onKeyDown={(e) => handleKeyDown(index, e)}\n              className=\"w-12 h-14 text-center text-xl font-bold rounded-lg outline-none transition-all focus:border-blue-500 focus:ring-1 focus:ring-blue-500\"\n              style={{\n                backgroundColor: '#F5F5F5',\n                border: '1px solid #E5E5E5',\n                color: '#1F242F',\n                fontFamily: 'IBM Plex Sans, system-ui, sans-serif'\n              }}\n              disabled={isLoading}\n            />\n          ))}\n        </div>\n\n        {error && (\n          <p className=\"mb-4 text-sm text-red-500 font-medium text-center\">\n            {error}\n          </p>\n        )}\n\n        <div className=\"flex-1\" />\n\n        {/* Actions */}\n        <div className=\"w-full pb-6 flex flex-col gap-4\">\n          <PrimaryButton\n            label={isLoading ? 'Verifying...' : 'Verify'}\n            onClick={handleVerify}\n            disabled={isLoading || otp.join('').length !== 6}\n            loading={isLoading}\n            className=\"!text-white w-full\"\n            textStyle={{ color: '#FFFFFF' }}\n          />\n          \n          <button\n            onClick={handleEmailSubmit} // Resend logic uses same init endpoint\n            disabled={resendTimer > 0 || isLoading}\n            className=\"text-sm font-medium text-gray-500 disabled:opacity-50 transition-colors hover:text-gray-700\"\n            style={{ fontFamily: 'Inter, system-ui, sans-serif' }}\n          >\n            {resendTimer > 0 \n              ? `Resend code in ${resendTimer}s` \n              : \"Didn't receive code? Resend\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmailAuth;\n","import React from 'react';\nimport { createPortal } from 'react-dom';\n\nconst BOOKMARKLET_HREF =\n  \"javascript:(async()=>{let loader=null;function showLoader(msg){if(!loader){loader=document.createElement('div');loader.style.cssText='position:fixed;top:20px;right:20px;width:280px;background:rgba(15,23,42,0.95);color:white;padding:14px 20px;border-radius:12px;font-family:-apple-system,BlinkMacSystemFont,\\\"Segoe UI\\\",Roboto,sans-serif;font-size:13px;font-weight:500;z-index:999999;box-shadow:0 8px 24px rgba(0,0,0,0.4),0 2px 8px rgba(0,0,0,0.2);border:1px solid rgba(255,255,255,0.1);backdrop-filter:blur(12px);line-height:1.4;text-align:center';document.body.appendChild(loader)}loader.textContent=msg}function hideLoader(){if(loader){loader.remove();loader=null}}function h(){try{const e=window.location.hostname||'';return e==='chat.openai.com'||e==='chatgpt.com'||e.endsWith('.chatgpt.com')}catch{return false}}function getDeviceId(){try{const c=document.cookie.match(/oai-did=([^;]+)/);return c?c[1]:null}catch{return null}}async function getAccessToken(){const url=`${window.location.origin}/api/auth/session`;const r=await fetch(url,{method:'GET',credentials:'include',headers:{'Accept':'application/json','Referer':window.location.origin}});if(!r.ok)return null;const data=await r.json();return data?.accessToken||null}async function fetchList(token,deviceId){const url=`${window.location.origin}/backend-api/conversations?offset=0&limit=10`;const headers={'Accept':'*/*','oai-language':'en-US'};if(token)headers['Authorization']=`Bearer ${token}`;if(deviceId)headers['oai-device-id']=deviceId;const r=await fetch(url,{method:'GET',credentials:'include',headers});if(!r.ok)throw new Error(`HTTP ${r.status}`);return r.json()}async function fetchConvo(id,token,deviceId){const url=`${window.location.origin}/backend-api/conversation/${id}`;const headers={'Accept':'*/*','oai-language':'en-US','Referer':window.location.origin};if(token)headers['Authorization']=`Bearer ${token}`;if(deviceId)headers['oai-device-id']=deviceId;const r=await fetch(url,{method:'GET',credentials:'include',headers});if(!r.ok)throw new Error(`HTTP ${r.status}`);return r.json()}async function fetchMemories(token,deviceId){const url=`${window.location.origin}/backend-api/memories?include_memory_entries=true&memory_entries_filter=all`;const headers={'Accept':'application/json','Referer':window.location.origin};if(token)headers['Authorization']=`Bearer ${token}`;if(deviceId)headers['oai-device-id']=deviceId;try{const r=await fetch(url,{method:'GET',credentials:'include',headers});if(!r.ok)return null;return r.json()}catch{return null}}function extractUserMessages(data){const mapping=data?.mapping||{};const msgs=[];for(const node of Object.values(mapping)){const msg=node?.message;if(!msg||!msg.author)continue;if(msg.author.role!=='user')continue;const time=msg.create_time?new Date(msg.create_time*1000).toISOString():null;let text='';const content=msg.content||{};if(Array.isArray(content.parts)){text=content.parts.join('\\\\n').trim()}else if(content.text){text=content.text.trim()}if(text){msgs.push({content:text,timestamp:time})}}return msgs}if(!h()){alert(' Please open ChatGPT and try again.');return}const popup=window.open('about:blank','OnairosSync','width=500,height=600');if(!popup){alert(' Please allow popups for ChatGPT to sync with Onairos!\\\\n\\\\nEnable popups and try again.');return}popup.document.write('<html><head><title>Onairos Sync</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:\\\"Shne\\\",-apple-system,BlinkMacSystemFont,\\\"Segoe UI\\\",Helvetica,Arial,sans-serif;background:#0D0D0D;color:#ECECEC;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}.container{max-width:450px;width:100%;background:#212121;border-radius:16px;padding:32px;box-shadow:0 4px 24px rgba(0,0,0,0.4)}h1{font-size:24px;font-weight:600;text-align:center;margin-bottom:8px}.subtitle{font-size:14px;color:#8E8EA0;text-align:center;margin-bottom:32px}.status-text{text-align:center;font-size:16px;margin-bottom:16px}.spinner{width:40px;height:40px;border:3px solid #2F2F2F;border-top-color:#10A37F;border-radius:50%;animation:spin 0.6s linear infinite;margin:0 auto 16px}@keyframes spin{to{transform:rotate(360deg)}}</style></head><body><div class=\\\"container\\\"><h1> Onairos Sync</h1><p class=\\\"subtitle\\\">Collecting your ChatGPT data</p><div class=\\\"spinner\\\"></div><div class=\\\"status-text\\\" id=\\\"status\\\">Starting...</div></div></body></html>');popup.document.close();function updatePopup(msg){try{if(popup&&!popup.closed){popup.document.getElementById('status').textContent=msg}}catch(e){}}showLoader(' Starting export...');console.log('[Onairos]  Starting export...');(async()=>{try{updatePopup(' Getting access token...');showLoader(' Getting access token...');const token=await getAccessToken();const deviceId=getDeviceId();if(!token){hideLoader();updatePopup(' Could not get access token. Make sure you\\\\'re logged into ChatGPT.');setTimeout(()=>popup.close(),5000);return}updatePopup(' Fetching conversations...');showLoader(' Fetching conversations...');let list;try{list=await fetchList(token,deviceId)}catch(err){hideLoader();updatePopup(' Failed: '+err.message);setTimeout(()=>popup.close(),5000);return}const items=(list?.items||[]).slice(0,10);if(items.length===0){hideLoader();updatePopup(' No conversations found');setTimeout(()=>popup.close(),3000);return}const convos=[];for(let i=0;i<items.length;i++){const c=items[i];updatePopup(` ${i+1}/${items.length}: ${c.title||'Untitled'}...`);showLoader(` ${i+1}/${items.length}: ${c.title||'Untitled'}...`);try{const data=await fetchConvo(c.id,token,deviceId);const userMsgs=extractUserMessages(data);convos.push({id:c.id,title:c.title||'Untitled',url:`${window.location.origin}/c/${c.id}`,messageCount:userMsgs.length,messages:userMsgs})}catch(err){convos.push({id:c.id,title:c.title||'Untitled',error:err.message})}}updatePopup(' Fetching memories...');showLoader(' Fetching memories...');const memories=await fetchMemories(token,deviceId);updatePopup(' Syncing to Onairos...');showLoader(' Syncing to Onairos...');const userData=JSON.parse(localStorage.getItem('onairosUser')||'{}');let jwtToken=userData.token||localStorage.getItem('onairos_user_token');if(!jwtToken){hideLoader();updatePopup(' Please log into Onairos first');setTimeout(()=>popup.close(),5000);return}const syncData={convos,memories,token:jwtToken};updatePopup(' Opening sync page...');const form=popup.document.createElement('form');form.method='POST';form.action='https://api2.onairos.uk/chatgpt-sync';form.style.display='none';const input=popup.document.createElement('input');input.type='hidden';input.name='data';input.value=JSON.stringify(syncData);form.appendChild(input);popup.document.body.appendChild(form);form.submit();hideLoader();console.log(' [Onairos] Submitting sync form')}catch(e){hideLoader();updatePopup(' Error: '+e.message);console.error(e);setTimeout(()=>popup.close(),5000)}})()})();\";\n\nexport const getOnairosChatGPTBookmarklet = () => BOOKMARKLET_HREF;\n\nexport default function ConnectChatGPTModal({ open, onClose, onConnected }) {\n  // Debug log to confirm render attempt\n  if (open) {\n    console.log(' ConnectChatGPTModal rendering! Open:', open);\n  }\n\n  if (!open) return null;\n\n  // Get user token from localStorage to embed in bookmarklet\n  const getUserToken = () => {\n    try {\n      // Try onairos_user_token first\n      const directToken = localStorage.getItem('onairos_user_token');\n      if (directToken) return directToken;\n      \n      // Try onairosUser.token\n      const userData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n      if (userData.token) return userData.token;\n      \n      return null;\n    } catch (e) {\n      console.error('Error getting token:', e);\n      return null;\n    }\n  };\n\n  const userToken = getUserToken();\n  console.log(' User token for bookmarklet:', userToken ? userToken.substring(0, 20) + '...' : 'NOT FOUND');\n\n  // Create bookmarklet with embedded token\n  const createBookmarkletWithToken = (token) => {\n    if (!token) {\n      // Fallback to original bookmarklet that checks localStorage\n      return BOOKMARKLET_HREF;\n    }\n    \n    // Embed the token directly in the bookmarklet\n    return BOOKMARKLET_HREF.replace(\n      'const userData=JSON.parse(localStorage.getItem(\\'onairosUser\\')||\\'{}\\')',\n      `const userData={token:'${token}'}`\n    );\n  };\n\n  const bookmarkletHref = createBookmarkletWithToken(userToken);\n\n  const handleGotIt = () => {\n    if (typeof onConnected === 'function') {\n      onConnected();\n    }\n    if (typeof onClose === 'function') {\n      onClose();\n    }\n  };\n\n  // Use a portal to break out of any parent transforms/overflows\n  return createPortal(\n    <div style={{ position: 'fixed', inset: 0, zIndex: 2147483647, pointerEvents: 'auto' }}>\n      <style>{`\n        @keyframes gentlePulse {\n          0%, 100% {\n            box-shadow: 0 0 0 0 rgba(148, 163, 184, 0.35);\n          }\n          50% {\n            box-shadow: 0 0 0 10px rgba(148, 163, 184, 0);\n          }\n        }\n        .bookmarklet-button {\n          background: rgba(15, 23, 42, 0.85);\n          border-radius: 9999px;\n          border: 1px solid rgba(255,255,255,0.16);\n          backdrop-filter: blur(18px);\n        }\n        .bookmarklet-button:hover {\n          background: rgba(15, 23, 42, 0.92);\n        }\n        @keyframes fadeInScale {\n          0% { opacity: 0; transform: translateY(8px) scale(0.96); }\n          100% { opacity: 1; transform: translateY(0) scale(1); }\n        }\n        .chatgpt-modal-card {\n          animation: fadeInScale 200ms cubic-bezier(0.16, 1, 0.3, 1);\n        }\n        .step-circle {\n          background: rgba(15, 23, 42, 0.9);\n          min-width: 28px;\n          width: 28px;\n          height: 28px;\n        }\n        .chatgpt-got-it-button {\n          color: #FFFFFF !important;\n          background-color: rgba(15, 23, 42, 0.8) !important;\n        }\n        .chatgpt-got-it-button:hover {\n          background-color: rgba(15, 23, 42, 0.9) !important;\n        }\n        .chatgpt-got-it-button * {\n          color: #FFFFFF !important;\n        }\n        .chatgpt-got-it-button span {\n          color: #FFFFFF !important;\n        }\n        /* Mobile browser specific styling */\n        @media (max-width: 768px) {\n          .chatgpt-modal-backdrop {\n            align-items: flex-end !important;\n            padding: 0 !important;\n          }\n          .chatgpt-modal-card {\n            max-width: 100% !important;\n            height: 100% !important;\n            max-height: 100% !important;\n            border-radius: 24px 24px 0 0 !important;\n            animation: slideUpFromBottom 300ms cubic-bezier(0.16, 1, 0.3, 1) !important;\n          }\n        }\n        @keyframes slideUpFromBottom {\n          0% { transform: translateY(100%); }\n          100% { transform: translateY(0); }\n        }\n      `}</style>\n\n      <div \n        className=\"chatgpt-modal-backdrop fixed inset-0 flex items-center justify-center p-4 bg-black/60\" \n        style={{ zIndex: 2147483647 }}\n      >\n        <div \n          className=\"chatgpt-modal-card w-full max-w-md rounded-3xl shadow-2xl border border-white/10 overflow-hidden text-white relative\"\n          style={{\n            background: 'linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.92) 50%, rgba(15, 23, 42, 0.95) 100%)',\n            boxShadow: 'inset 0 1px 0 0 rgba(255, 255, 255, 0.1), 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 100px rgba(148, 163, 184, 0.15)'\n          }}\n        >\n            <div className=\"relative px-5 py-4 border-b border-white/10 bg-white/5\">\n              <button\n                onClick={onClose}\n                className=\"absolute right-4 top-4 p-2 hover:bg-white/10 rounded-full transition-colors z-50 cursor-pointer\"\n                aria-label=\"Close\"\n              >\n                <svg\n                  className=\"w-5 h-5 text-slate-300\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M6 18L18 6M6 6l12 12\"\n                  />\n                </svg>\n              </button>\n\n              <h2 className=\"text-xl font-semibold pr-8 text-white\">\n                Connect ChatGPT\n              </h2>\n              <p className=\"text-sm mt-0.5 text-white\">\n                Three quick steps to import your conversations\n              </p>\n\n              <div className=\"mt-3 flex items-start gap-2 bg-white/12 rounded-2xl px-3 py-2\">\n                <svg\n                  className=\"w-4 h-4 text-emerald-300 mt-0.5 flex-shrink-0\"\n                  fill=\"currentColor\"\n                  viewBox=\"0 0 20 20\"\n                >\n                  <path\n                    fillRule=\"evenodd\"\n                    d=\"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\"\n                    clipRule=\"evenodd\"\n                  />\n                </svg>\n                <p className=\"text-xs leading-relaxed text-white\">\n                  <strong className=\"font-semibold\">Private &amp; secure.</strong>{' '}\n                  We only access your chat history. No one else sees this data.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"px-5 py-4 space-y-4\">\n              <div className=\"flex gap-3\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"step-circle rounded-full flex items-center justify-center\">\n                    <span className=\"text-white font-bold text-sm\">1</span>\n                  </div>\n                </div>\n                <div className=\"flex-1 pt-0.5\">\n                  <h3 className=\"text-sm font-semibold mb-1 text-white\">\n                    Drag this button to your bookmarks bar\n                  </h3>\n                  <div className=\"relative inline-block mt-2\">\n                    <div\n                      className=\"absolute inset-0 rounded-full\"\n                      style={{ animation: 'gentlePulse 2s ease-in-out infinite' }}\n                    />\n                    <a\n                      href={bookmarkletHref}\n                      title=\" Onairos ChatGPT Sync\"\n                      draggable=\"true\"\n                      onDragStart={(e) => {\n                        try {\n                          // Set the bookmark URL\n                          e.dataTransfer.setData('text/uri-list', bookmarkletHref);\n                          e.dataTransfer.setData('text/plain', bookmarkletHref);\n                          \n                          // IMPORTANT: Set bookmark title for different browsers\n                          // Firefox uses text/x-moz-url format: URL\\nTitle\n                          e.dataTransfer.setData('text/x-moz-url', `${bookmarkletHref}\\n Onairos ChatGPT`);\n                          \n                          // Chrome/Safari: Set via DownloadURL\n                          e.dataTransfer.setData('DownloadURL', `application/javascript: Onairos ChatGPT:${bookmarkletHref}`);\n                          \n                          e.dataTransfer.effectAllowed = 'copy';\n                          console.log(' Bookmarklet drag started with title:  Onairos ChatGPT');\n                        } catch (err) {\n                          console.warn('Drag start error:', err);\n                        }\n                      }}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        alert(' Please drag this button to your bookmarks bar!\\n\\nTip: Press Ctrl+Shift+B (or Cmd+Shift+B on Mac) to show your bookmarks bar.');\n                      }}\n                      className=\"bookmarklet-button relative inline-flex items-center gap-1.5 px-4 py-2 font-medium cursor-move select-none transition-all hover:scale-[1.03]\"\n                      suppressHydrationWarning\n                    >\n                      <span className=\"text-base\"></span>\n                      <span className=\"text-sm\">Onairos ChatGPT</span>\n                    </a>\n                  </div>\n                  <p className=\"text-xs mt-2 text-slate-200\">\n                    <kbd className=\"px-1.5 py-0.5 bg-white/10 rounded-full text-[10px] font-mono border border-white/10 text-slate-50\">\n                      Ctrl+Shift+B\n                    </kbd>{' '}\n                    (or{' '}\n                    <kbd className=\"px-1.5 py-0.5 bg-white/10 rounded-full text-[10px] font-mono border border-white/10 text-slate-50\">\n                      Cmd+Shift+B\n                    </kbd>{' '}\n                    on Mac) to show bookmarks bar\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"border-t border-white/10 ml-10\" />\n\n              <div className=\"flex gap-3\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"step-circle rounded-full flex items-center justify-center\">\n                    <span className=\"text-white font-bold text-sm\">2</span>\n                  </div>\n                </div>\n                <div className=\"flex-1 pt-0.5\">\n                  <h3 className=\"text-sm font-semibold mb-1 text-white\">\n                    Open ChatGPT and log in\n                  </h3>\n                  <p className=\"text-xs mb-2 text-slate-200\">\n                    Make sure you're logged into your ChatGPT account\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      window.open('https://chat.openai.com', '_blank', 'noopener,noreferrer');\n                    }}\n                    className=\"inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-medium transition-all hover:scale-[1.02] active:scale-[0.98]\"\n                    style={{\n                      background: 'linear-gradient(135deg, #10a37f 0%, #0d9270 100%)',\n                      color: '#ffffff',\n                      boxShadow: '0 0 25px rgba(16, 163, 127, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)'\n                    }}\n                  >\n                    <svg\n                      className=\"w-3.5 h-3.5\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"\n                      />\n                    </svg>\n                    Open ChatGPT\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"border-t border-white/10 ml-10\" />\n\n              <div className=\"flex gap-3\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"step-circle rounded-full flex items-center justify-center\">\n                    <span className=\"text-white font-bold text-sm\">3</span>\n                  </div>\n                </div>\n                <div className=\"flex-1 pt-0.5\">\n                  <h3 className=\"text-sm font-semibold mb-1 text-white\">\n                    Click the bookmark on ChatGPT\n                  </h3>\n                  <p className=\"text-xs text-slate-200\">\n                    Click the <strong className=\"text-white\">&quot;Onairos ChatGPT&quot;</strong>{' '}\n                    bookmark you added. We&apos;ll securely import your last 10 conversations.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"px-5 py-4 bg-white/5 border-t border-white/10\">\n              <button\n                type=\"button\"\n                onClick={handleGotIt}\n                className=\"w-full px-4 py-2.5 rounded-full font-medium text-sm transition-all hover:scale-[1.01] active:scale-[0.99] shadow-[0_10px_30px_rgba(15,23,42,0.45)] border border-white/40 chatgpt-got-it-button\"\n              >\n                <span>Got it! </span>\n              </button>\n            </div>\n          </div>\n        </div>\n    </div>,\n    document.body\n  );\n}\n\n\n","import React, { useEffect, useId, useState, useRef } from 'react';\nimport { Browser } from '@capacitor/browser';\nimport Lottie from 'lottie-react';\nimport personaAnim from '../../public/persona-anim.json';\nimport { isMobileApp, isMobileBrowser } from '../utils/capacitorDetection';\nimport ConnectChatGPTModal from './ConnectChatGPTModal.jsx';\n\n// Mobile detection\nconst isMobile = () => {\n  if (typeof window === 'undefined') return false;\n  return isMobileApp() || isMobileBrowser() || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n};\nconst chatgptIcon = 'https://anushkasirv.sirv.com/openai.png';\nconst claudeIcon = 'https://anushkasirv.sirv.com/claude-color.png';\nconst geminiIcon = 'https://anushkasirv.sirv.com/gemini-color.png';\nconst grokIcon = 'https://anushkasirv.sirv.com/grok.png';\n\nconst sdkConfig = {\n  apiKey: process.env.REACT_APP_ONAIROS_API_KEY || 'ona_VvoHNg1fdCCUa9eBy4Iz3IfvXdgLfMFI7TNcyHLDKEadPogkbjAeE2iDOs6M7Aey',\n  baseUrl: process.env.REACT_APP_ONAIROS_BASE_URL || 'https://api2.onairos.uk',\n  sdkType: 'web',\n  enableHealthMonitoring: true,\n  enableAutoRefresh: true,\n  enableConnectionValidation: true,\n};\n\n// Keyframes for fade-in animations\nconst fadeSlideInKeyframes = `\n@keyframes fadeSlideIn {\n  from { opacity: 0; transform: translateX(var(--slide-x)); }\n  to { opacity: 1; transform: translateX(0); }\n}\n`;\n\nexport default function UniversalOnboarding({ onComplete, onBack, appIcon, appName, username, testMode, priorityPlatform, rawMemoriesOnly, rawMemoriesConfig, isMobile: isMobileProp = false }) {\n  const lottieRef = useRef(null);\n  const lastFrameRef = useRef(0);\n  const rafRef = useRef(null);\n  const initialLoadDone = useRef(false);\n  const scrollRef = useRef(null);\n\n  const [connectedAccounts, setConnectedAccounts] = useState({});\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [connectingPlatform, setConnectingPlatform] = useState(null);\n  const [selected, setSelected] = useState('YouTube'); // Default to first item\n  const [showChatGPTModal, setShowChatGPTModal] = useState(false);\n\n  // Mobile detection\n  const isActualMobileDevice = typeof navigator !== 'undefined' && \n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n  const isNativePlatform = typeof window !== 'undefined' && \n    window.Capacitor?.isNativePlatform?.() === true;\n  // Use prop or detection\n  const isMobile = isMobileProp || isNativePlatform || isActualMobileDevice;\n\n  const [vh, setVh] = useState(() => (typeof window !== 'undefined' ? window.innerHeight : 800));\n  useEffect(() => {\n    const onResize = () => setVh(window.innerHeight);\n    window.addEventListener('resize', onResize);\n    return () => window.removeEventListener('resize', onResize);\n  }, []);\n\n  const isSmallMobile = isMobile && vh < 700;\n\n  // Persona sizing and positioning (matching native app)\n  // Native uses fixed sizes: width 500, height 500\n  const PERSONA_SIZE = isMobile ? Math.min(vh * 0.5, 500) : 420;\n  const PERSONA_TOP = isMobile ? (isSmallMobile ? 0 : 20) : 40;\n\n  const igGradId = useId();\n\n  // ---- Icons ----\n  const Brand = {\n    ChatGPT: <img src={chatgptIcon} alt=\"ChatGPT\" style={{ width: '100%', height: '100%', objectFit: 'contain' }} />,\n    Claude: <img src={claudeIcon} alt=\"Claude\" style={{ width: '100%', height: '100%', objectFit: 'contain' }} />,\n    Gemini: <img src={geminiIcon} alt=\"Gemini\" style={{ width: '100%', height: '100%', objectFit: 'contain' }} />,\n    Grok: <img src={grokIcon} alt=\"Grok\" style={{ width: '100%', height: '100%', objectFit: 'contain' }} />,\n    Instagram: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden width=\"100%\" height=\"100%\">\n        <defs>\n          <radialGradient id={igGradId} cx=\"0.5\" cy=\"1\" r=\"1\">\n            <stop offset=\"0%\" stopColor=\"#FDBB4B\"/>\n            <stop offset=\"40%\" stopColor=\"#E95950\"/>\n            <stop offset=\"70%\" stopColor=\"#BC2A8D\"/>\n            <stop offset=\"100%\" stopColor=\"#4C68D7\"/>\n          </radialGradient>\n        </defs>\n        <path fill={`url(#${igGradId})`} d=\"M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5.5A4.5 4.5 0 1 0 16.5 12 4.5 4.5 0 0 0 12 7.5zm0 7.4A2.9 2.9 0 1 1 14.9 12 2.9 2.9 0 0 1 12 14.9Zm5.35-8.25a1.15 1.15 0 1 0 1.15 1.15 1.15 1.15 0 0 0-1.15-1.15Z\"/>\n      </svg>\n    ),\n    YouTube: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden width=\"100%\" height=\"100%\">\n        <path fill=\"#FF0000\" d=\"M22.54 6.42a3 3 0 0 0-2.11-2.12C18.49 3.75 12 3.75 12 3.75s-6.49 0-8.43.55A3 3 0 0 0 1.46 6.42 31.63 31.63 0 0 0 1 12a31.63 31.63 0 0 0 .46 5.58 3 3 0 0 0 2.11 2.12C5.51 20.25 12 20.25 12 20.25s6.49 0 8.43-.55a3 3 0 0 0 2.11-2.12A31.63 31.63 0 0 0 23 12a31.63 31.63 0 0 0-.46-5.58z\"/>\n        <path fill=\"#FFF\" d=\"M10 8.75v6.5l6-3.25-6-3.25z\"/>\n      </svg>\n    ),\n    Reddit: (\n      <img src=\"https://upload.wikimedia.org/wikipedia/en/b/bd/Reddit_Logo_Icon.svg\" alt=\"Reddit\" width=\"100%\" height=\"100%\" />\n    ),\n    LinkedIn: (\n      <img src=\"https://upload.wikimedia.org/wikipedia/commons/c/ca/LinkedIn_logo_initials.png\" alt=\"LinkedIn\" width=\"100%\" height=\"100%\" />\n    ),\n    Twitter: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden width=\"100%\" height=\"100%\">\n        <path fill=\"#1DA1F2\" d=\"M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z\"/>\n      </svg>\n    ),\n  };\n\n  const aiLinks = {\n    ChatGPT: 'https://chat.openai.com',\n    Claude: 'https://claude.ai',\n    Gemini: 'https://gemini.google.com',\n    Grok: 'https://grok.x.ai',\n  };\n\n  const descriptions = {\n    ChatGPT: 'Use chat and memory information to enrich your model further.',\n    Claude: 'Use chat and memory information to enrich your model further.',\n    Gemini: 'Use chat and memory information to enrich your model further. Coming soon.',\n    Grok: 'Use chat and memory information to enrich your model further. Coming soon.',\n    Twitter: 'Use your tweets and interests to enrich your model.',\n    YouTube: 'Use your watch history, likes, and subscriptions to enrich your model.',\n    Reddit: 'Use your posts and comments to enrich your model.',\n    Instagram: 'Use your photos and interactions to learn visual preferences.',\n    LinkedIn: 'Use your professional network and career interests to enrich your model.',\n  };\n\n  // Full platform list\n  const allPlatformsDefault = [\n    { name: 'YouTube', connector: 'youtube', icon: Brand.YouTube },\n    { name: 'Reddit', connector: 'reddit', icon: Brand.Reddit },\n    { name: 'LinkedIn', connector: 'linkedin', icon: Brand.LinkedIn },\n    { name: 'Instagram', connector: 'instagram', icon: Brand.Instagram },\n    { name: 'Twitter', connector: 'twitter', icon: Brand.Twitter },\n    { name: 'ChatGPT', connector: 'chatgpt', icon: Brand.ChatGPT, directLink: aiLinks.ChatGPT },\n    { name: 'Claude', connector: 'claude', icon: Brand.Claude, directLink: aiLinks.Claude },\n    { name: 'Gemini', connector: 'gemini', icon: Brand.Gemini, directLink: aiLinks.Gemini },\n    { name: 'Grok', connector: 'grok', icon: Brand.Grok, directLink: aiLinks.Grok },\n  ];\n\n  // Restricted platform list for onairos-wrapped only\n  const wrappedPlatforms = [\n    { name: 'YouTube', connector: 'youtube', icon: Brand.YouTube },\n    { name: 'LinkedIn', connector: 'linkedin', icon: Brand.LinkedIn },\n    { name: 'Reddit', connector: 'reddit', icon: Brand.Reddit },\n  ];\n\n  // Check if this is onairos-wrapped\n  const isWrappedApp = typeof appName === 'string' && appName.toLowerCase().includes('onairos-wrapped');\n  const allPlatforms = isWrappedApp ? wrappedPlatforms : allPlatformsDefault;\n\n  // Helper to normalize platform names\n  const canonicalizePlatformName = (value) => {\n    const raw = String(value || '').trim();\n    if (!raw) return '';\n    const lower = raw.toLowerCase();\n    const byConnector = allPlatforms.find((p) => String(p.connector).toLowerCase() === lower);\n    if (byConnector) return byConnector.name;\n    const byName = allPlatforms.find((p) => String(p.name).toLowerCase() === lower);\n    if (byName) return byName.name;\n    return raw.charAt(0).toUpperCase() + raw.slice(1);\n  };\n\n  const notifyConnectedAccountsUpdate = () => {\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(new CustomEvent('onairos-connected-accounts-update'));\n    }\n  };\n\n  // Auto-persist connected accounts\n  useEffect(() => {\n    if (Object.keys(connectedAccounts).length === 0) return;\n    try {\n      const userData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n      const connectedArray = Object.entries(connectedAccounts)\n        .filter(([, v]) => !!v)\n        .map(([k]) => canonicalizePlatformName(k))\n        .filter(Boolean);\n      userData.connectedAccounts = connectedArray;\n      localStorage.setItem('onairosUser', JSON.stringify(userData));\n      notifyConnectedAccountsUpdate();\n    } catch (e) {\n      console.error(' Error auto-persisting connected accounts:', e);\n    }\n  }, [connectedAccounts]);\n\n  // Handle OAuth success events\n  useEffect(() => {\n    const handleAuthSuccess = (e) => {\n       const { platform } = e.detail;\n       const plat = allPlatforms.find((p) => p.connector === platform);\n       if (plat) {\n          sessionStorage.setItem('onairos_just_connected', Date.now().toString());\n          setConnectedAccounts((currentState) => ({ ...currentState, [plat.name]: true }));\n       }\n    };\n    if (typeof window !== 'undefined') {\n      window.addEventListener('onairos-oauth-success', handleAuthSuccess);\n    }\n\n    // Check for OAuth success on mount\n    const checkOAuthSuccess = () => {\n      const sessionSuccess = sessionStorage.getItem('onairos_oauth_return_success');\n      const sessionPlatform = sessionStorage.getItem('onairos_oauth_return_platform');\n      \n      if (sessionSuccess === 'true' && sessionPlatform) {\n        const plat = allPlatforms.find((p) => p.connector === sessionPlatform);\n        if (plat) {\n          sessionStorage.setItem('onairos_just_connected', Date.now().toString());\n          setConnectedAccounts((currentState) => ({ ...currentState, [plat.name]: true }));\n        }\n        sessionStorage.removeItem('onairos_oauth_return_success');\n        sessionStorage.removeItem('onairos_oauth_return_platform');\n        return true;\n      }\n      return false;\n    };\n\n    // Initial load from localStorage logic\n    const justConnectedTime = sessionStorage.getItem('onairos_just_connected');\n    const inOAuthFlow = justConnectedTime && (Date.now() - parseInt(justConnectedTime, 10) < 2000);\n    \n    if (!inOAuthFlow) {\n      try {\n        const userData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n        if (userData.connectedAccounts && Array.isArray(userData.connectedAccounts)) {\n          const accountsObj = userData.connectedAccounts.reduce((acc, platform) => {\n            acc[canonicalizePlatformName(platform)] = true;\n            return acc;\n          }, {});\n          setConnectedAccounts(accountsObj);\n        }\n      } catch (error) {\n        console.error(' Failed to load persisted connected accounts:', error);\n      }\n    }\n    \n    initialLoadDone.current = true;\n    checkOAuthSuccess();\n    \n    return () => {\n      if (typeof window !== 'undefined') {\n        window.removeEventListener('onairos-oauth-success', handleAuthSuccess);\n      }\n    };\n  }, []);\n\n  async function connectToPlatform(name) {\n    const plat = allPlatforms.find((p) => p.name === name);\n    if (!plat) return false;\n    try {\n      if (plat.directLink) {\n        setConnectedAccounts((s) => ({ ...s, [name]: true }));\n        setIsConnecting(false);\n        setConnectingPlatform(null);\n        return true;\n      }\n\n      setIsConnecting(true);\n      setConnectingPlatform(name);\n      \n      if (name === 'Twitter') {\n        setIsConnecting(false);\n        setConnectingPlatform(null);\n        return true;\n      }\n      \n      const username = localStorage.getItem('username') || (JSON.parse(localStorage.getItem('onairosUser') || '{}')?.email) || 'user@example.com';\n      const isCapacitorNative = typeof window !== 'undefined' && window.Capacitor?.isNativePlatform?.();\n      const isMobileBrowser = typeof navigator !== 'undefined' && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n      const effectiveMobile = isMobileProp || isMobileBrowser;\n\n      let returnUrl = '';\n      if (isCapacitorNative) {\n        returnUrl = `mobiletest://oauth-callback?success=true&platform=${plat.connector}`;\n      } else if (effectiveMobile) {\n        const cleanUrl = window.location.origin + window.location.pathname;\n        returnUrl = cleanUrl;\n      }\n\n      const sessionPayload = {\n        username,\n        ...(effectiveMobile && { sdkType: 'web', returnUrl })\n      };\n\n      const bodyPayload = {\n        session: sessionPayload,\n        ...(!isCapacitorNative && effectiveMobile && { returnUrl })\n      };\n\n      const res = await fetch(`${sdkConfig.baseUrl}/${plat.connector}/authorize`, {\n        method: 'POST',\n        headers: { 'x-api-key': sdkConfig.apiKey, 'Content-Type': 'application/json' },\n        body: JSON.stringify(bodyPayload),\n      });\n      if (!res.ok) throw new Error('auth failed');\n      const data = await res.json();\n\n      const candidates = (\n        {\n          youtube: ['youtubeURL','youtubeUrl','youtube_url'],\n          linkedin: ['linkedinURL','linkedinUrl','linkedin_url'],\n          reddit: ['redditURL','redditUrl','reddit_url'],\n          pinterest: ['pinterestURL','pinterestUrl','pinterest_url'],\n          instagram: ['instagramURL','instagramUrl','instagram_url'],\n          github: ['githubURL','githubUrl','github_url'],\n          facebook: ['facebookURL','facebookUrl','facebook_url'],\n          gmail: ['gmailURL','gmailUrl','gmail_url'],\n        }[plat.connector]\n      ) || [`${plat.connector}URL`, `${plat.connector}Url`, `${plat.connector}_url`, 'platformURL', 'authUrl', 'url'];\n\n      let oauthUrl = null;\n      for (const k of candidates) {\n        if (data[k]) {\n          oauthUrl = data[k];\n          break;\n        }\n      }\n      \n      if (!oauthUrl) {\n        const keys = Object.keys(data);\n        const candidateLower = candidates.map(c => c.toLowerCase());\n        for (const key of keys) {\n           if (candidateLower.includes(key.toLowerCase()) && data[key]) {\n              oauthUrl = data[key];\n              break;\n           }\n        }\n      }\n      \n      if (!oauthUrl) throw new Error('no url');\n\n      try {\n        localStorage.setItem('onairos_post_oauth_flow', 'onboarding');\n        const returnUrl = window.location.href;\n        localStorage.setItem('onairos_return_url', returnUrl);\n        localStorage.setItem('onairos_oauth_context', 'platform-connector');\n        localStorage.setItem('onairos_oauth_platform', plat.connector);\n      } catch (e) {}\n\n      if (isCapacitorNative) {\n        try {\n          await Browser.open({ url: oauthUrl, windowName: '_blank', presentationStyle: 'fullscreen' });\n          return true;\n        } catch (err) {\n          // Fallback\n        }\n      }\n\n      if (effectiveMobile) {\n        setIsConnecting(false);\n        setConnectingPlatform(null);\n        window.location.href = oauthUrl;\n        return true;\n      }\n\n      // Desktop popup logic\n      const popup = window.open(oauthUrl, 'onairos_oauth_popup', 'width=500,height=600,scrollbars=yes,resizable=yes');\n      if (!popup || popup.closed) {\n        setIsConnecting(false);\n        setConnectingPlatform(null);\n        window.location.href = oauthUrl;\n        return true;\n      }\n\n      const messageHandler = (event) => {\n        if (!event.origin.includes('onairos.uk')) return;\n        if (event.data && event.data.type === 'oauth-success' && event.data.platform === plat.connector) {\n          window.removeEventListener('message', messageHandler);\n          clearInterval(pollInterval);\n          setIsConnecting(false);\n          setConnectingPlatform(null);\n          setConnectedAccounts((currentState) => ({ ...currentState, [plat.name]: true }));\n          try { popup.close(); } catch (e) {}\n        }\n      };\n\n      window.addEventListener('message', messageHandler);\n\n      const localStorageKey = `onairos_${plat.connector}_success`;\n      const timestampKey = `onairos_${plat.connector}_timestamp`;\n      let pollCount = 0;\n      const pollInterval = setInterval(() => {\n        pollCount++;\n        const success = localStorage.getItem(localStorageKey);\n        const timestamp = localStorage.getItem(timestampKey);\n        if (success === 'true' && timestamp) {\n          const timestampNum = parseInt(timestamp, 10);\n          if (Date.now() - timestampNum < 30000) {\n            clearInterval(pollInterval);\n            window.removeEventListener('message', messageHandler);\n            setIsConnecting(false);\n            setConnectingPlatform(null);\n            setConnectedAccounts((currentState) => ({ ...currentState, [plat.name]: true }));\n            try { \n                localStorage.removeItem(localStorageKey);\n                localStorage.removeItem(timestampKey);\n                popup.close(); \n            } catch (e) {}\n            return;\n          }\n        }\n        if (pollCount >= 300 || popup.closed) {\n          clearInterval(pollInterval);\n          window.removeEventListener('message', messageHandler);\n          setIsConnecting(false);\n          setConnectingPlatform(null);\n        }\n      }, 1000);\n\n      return true;\n    } catch (e) {\n      console.error(` Error connecting to ${name}:`, e);\n      setConnectedAccounts((s) => ({ ...s, [name]: false }));\n      setIsConnecting(false); setConnectingPlatform(null); return false;\n    }\n  }\n\n  const handleSwitch = async (name) => {\n    // Mobile restrictions\n    const aiNoopOnMobile = ['ChatGPT', 'Claude', 'Gemini', 'Grok'];\n    if (isMobile && aiNoopOnMobile.includes(name)) return;\n    \n    if (isConnecting && connectingPlatform !== name) return;\n    const on = !!connectedAccounts[name];\n    if (on) {\n      setConnectedAccounts((currentState) => ({ ...currentState, [name]: false }));\n    } else {\n      await connectToPlatform(name);\n    }\n  };\n\n  const connectedCount = Object.values(connectedAccounts).filter(Boolean).length;\n\n  useEffect(() => {\n    if (!lottieRef.current) return;\n    const totalFrames = (personaAnim.op || 0) - (personaAnim.ip || 0);\n    const TOTAL_PLATFORMS = isWrappedApp ? 3 : 9;\n    const progress = connectedCount / TOTAL_PLATFORMS;\n    const target = Math.max(0, Math.floor(progress * totalFrames));\n    const start = lastFrameRef.current || 0;\n    const duration = 420; const startTs = performance.now();\n    const step = (now) => {\n      const t = Math.min(1, (now - startTs) / duration);\n      const eased = t < 0.5 ? 2*t*t : -1 + (4 - 2*t)*t;\n      const frame = Math.floor(start + (target - start) * eased);\n      lottieRef.current.goToAndStop(frame, true);\n      if (t < 1) rafRef.current = requestAnimationFrame(step); else lastFrameRef.current = target;\n    };\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    rafRef.current = requestAnimationFrame(step);\n    return () => { if (rafRef.current) cancelAnimationFrame(rafRef.current); };\n  }, [connectedCount]);\n\n  return (\n    <div className=\"w-full h-full relative flex flex-col\" style={{ \n      height: '100%',\n      // Hide scrollbars for mobile\n      ...(isMobile && {\n        scrollbarWidth: 'none',\n        msOverflowStyle: 'none',\n      })\n    }}>\n      <style>{fadeSlideInKeyframes}</style>\n\n      {/* Header */}\n      <div className=\"px-6 flex-shrink-0 text-left\" style={{ paddingTop: '1.5rem', paddingBottom: '0.25rem' }}>\n        <h1 \n          className=\"text-2xl font-bold mb-1 leading-tight\"\n          style={{ fontFamily: 'IBM Plex Sans, system-ui, sans-serif', color: '#1F242F' }}\n        >\n          Connect platforms\n        </h1>\n        <p \n          className=\"text-base\"\n          style={{ fontFamily: 'Inter, system-ui, sans-serif', color: '#62646C' }}\n        >\n          More connections, smarter personalization.\n        </p>\n      </div>\n\n      {/* Persona & Horizontal Scroll Container - mimics native structure */}\n      <div className=\"relative flex-shrink-0 flex justify-center items-center\" style={{ height: 420, marginBottom: -60, marginTop: -20 }}>\n        {/* Lottie Persona */}\n        <div style={{ width: PERSONA_SIZE, height: PERSONA_SIZE }}>\n          <Lottie lottieRef={lottieRef} animationData={personaAnim} autoplay={false} loop={false} style={{ width: '100%', height: '100%' }} />\n        </div>\n\n        {/* Horizontal Icons Overlay */}\n        <div \n          className=\"absolute left-0 w-full z-10 flex items-center\"\n          style={{ bottom: 80, height: 70 }}\n        >\n          {/* Gradients */}\n          <div className=\"absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-[#FAFAFA] to-transparent z-20 pointer-events-none\" />\n          <div className=\"absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-[#FAFAFA] to-transparent z-20 pointer-events-none\" />\n\n          <div \n            className=\"w-full overflow-x-auto no-scrollbar px-6 flex items-center gap-4 snap-x\"\n            style={{ \n              scrollbarWidth: 'none', \n              msOverflowStyle: 'none',\n              paddingLeft: '1.5rem',\n              paddingRight: '1.5rem'\n            }}\n          >\n            {allPlatforms.map((p) => {\n              const isSelected = selected === p.name;\n              const isConnected = !!connectedAccounts[p.name];\n              const isConnectingThis = isConnecting && connectingPlatform === p.name;\n\n              return (\n                <button\n                  key={p.name}\n                  onClick={() => setSelected(p.name)}\n                  className={`flex-shrink-0 w-[52px] h-[52px] rounded-full flex items-center justify-center bg-white shadow-sm border-[3px] transition-all snap-center ${isSelected ? 'border-blue-100 bg-blue-50' : 'border-transparent'}`}\n                  style={{\n                    boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n                    borderColor: isSelected ? '#3B82F6' : 'transparent', // Match native selection color\n                    backgroundColor: isSelected ? '#EFF6FF' : '#FFFFFF'\n                  }}\n                >\n                  <div style={{ width: 30, height: 30 }} className=\"flex items-center justify-center\">\n                    {p.icon}\n                  </div>\n                  {/* Status Dot */}\n                  {(isConnected || isConnectingThis) && (\n                    <div \n                      className=\"absolute top-0.5 right-0.5 w-3 h-3 rounded-full border-2 border-white\"\n                      style={{ backgroundColor: isConnectingThis ? '#FFA500' : '#10B981' }} \n                    />\n                  )}\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Selected Card - Single detail card style */}\n      <div className=\"flex-1 px-6 flex flex-col items-center justify-start z-20\">\n        <div \n          className=\"w-full bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex flex-col gap-3\"\n          style={{ maxWidth: 340, boxShadow: '0 2px 8px rgba(0,0,0,0.05)' }}\n        >\n          {/* Header Row: Title & Toggle */}\n          <div className=\"flex items-center justify-between\">\n            <span \n              className=\"text-base font-semibold\" \n              style={{ fontFamily: 'IBM Plex Sans, system-ui, sans-serif', color: '#1F242F' }}\n            >\n              {selected}\n            </span>\n            \n            <button\n              onClick={() => handleSwitch(selected)}\n              disabled={isConnecting && connectingPlatform !== selected}\n              className={`relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none ${connectedAccounts[selected] ? 'bg-emerald-500' : 'bg-gray-200'}`}\n              style={{ backgroundColor: connectedAccounts[selected] ? '#10B981' : '#E5E7EB' }}\n            >\n              <span\n                className={`inline-block h-6 w-6 transform rounded-full bg-white shadow transition-transform ${connectedAccounts[selected] ? 'translate-x-7' : 'translate-x-1'}`}\n              />\n            </button>\n          </div>\n\n          {/* Description Row */}\n          <div className=\"bg-gray-50 rounded-lg p-3\">\n            <p \n              className=\"text-sm leading-snug\"\n              style={{ fontFamily: 'Inter, system-ui, sans-serif', color: '#62646C' }}\n            >\n              {descriptions[selected] || 'Connect this platform to enhance your personalization model.'}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Footer - Pushed to bottom */}\n      <div className=\"px-6 pb-6 pt-2 w-full mt-auto flex-shrink-0 z-30 bg-transparent\">\n        <div \n          className=\"w-full rounded-full h-12 flex items-center justify-center gap-2 cursor-pointer shadow-lg active:scale-95 transition-transform\"\n          style={{ \n            background: 'linear-gradient(to bottom, #29292B, #17181C)',\n            color: '#FFFFFF',\n            fontFamily: 'Inter, system-ui, sans-serif',\n            fontWeight: 600,\n            fontSize: '16px'\n          }}\n          onClick={() => onComplete?.({ connectedAccounts: Object.keys(connectedAccounts).filter(k => connectedAccounts[k]), totalConnections: Object.values(connectedAccounts).filter(Boolean).length })}\n        >\n          Continue\n        </div>\n        <div \n          onClick={() => onComplete?.({ connectedAccounts: [], totalConnections: 0 })}\n          className=\"w-full text-center mt-3 cursor-pointer p-2\"\n          style={{ \n            fontFamily: 'Inter, system-ui, sans-serif', \n            fontSize: '14px', \n            fontWeight: 500, \n            color: '#86888E' \n          }}\n        >\n          Skip\n        </div>\n      </div>\n\n      <ConnectChatGPTModal\n        open={showChatGPTModal}\n        onClose={() => setShowChatGPTModal(false)}\n        onConnected={() => setConnectedAccounts((s) => ({ ...s, ChatGPT: true }))}\n      />\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\n\nexport default function PinSetup({ onComplete, onBack, userEmail }) {\n  const [pin, setPin] = useState('');\n  const [pinRequirements, setPinRequirements] = useState({\n    length: false,\n    uppercase: false,\n    number: false,\n  });\n\n  // Check PIN requirements\n  useEffect(() => {\n    setPinRequirements({\n      length: pin.length >= 6,\n      uppercase: /[A-Z]/.test(pin),\n      number: /\\d/.test(pin),\n    });\n  }, [pin]);\n\n  const allRequirementsMet = pinRequirements.length && pinRequirements.uppercase && pinRequirements.number;\n\n  const handleSubmit = () => {\n    if (allRequirementsMet) {\n      onComplete({\n        pin: pin, // This should be hashed in production\n        pinCreated: true,\n        timestamp: new Date().toISOString()\n      });\n    }\n  };\n\n  return (\n    <div className=\"w-full h-full flex flex-col\" style={{ height: '100%', minHeight: 0 }}>\n      {/* Content - Flexible center area */}\n      <div className=\"px-6 pt-16 flex-1 flex flex-col\" style={{ minHeight: 0, overflow: 'hidden' }}>\n        <div className=\"mb-6 flex-shrink-0\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Create a PIN</h1>\n          <p className=\"text-gray-600 text-base\">A PIN so only you have the access to your data</p>\n        </div>\n\n        <div className=\"mb-6 flex-shrink-0\">\n          <input\n            type=\"password\"\n            value={pin}\n            onChange={(e) => setPin(e.target.value)}\n            className=\"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-center text-lg font-medium focus:border-gray-900 focus:outline-none bg-white !text-black\"\n            placeholder=\"Enter your PIN\"\n            maxLength={20}\n            style={{\n              WebkitTextFillColor: '#000000',\n              backgroundColor: '#FFFFFF',\n              color: '#000000'\n            }}\n          />\n        </div>\n\n        {/* Scrollable requirements list */}\n        <div className=\"flex-1 overflow-y-auto\" style={{ minHeight: 0 }}>\n          <div className=\"space-y-3 pb-4\">\n            <p className=\"text-gray-900 font-medium mb-4\">Your PIN must:</p>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-3\">\n                <div\n                  className={`w-5 h-5 rounded-full border-2 ${pinRequirements.length ? \"border-green-500 bg-green-500\" : \"border-gray-300 bg-white\"}`}\n                >\n                  {pinRequirements.length && (\n                    <svg className=\"w-3 h-3 text-white m-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                    </svg>\n                  )}\n                </div>\n                <span className=\"text-gray-700\">Be at least 6 characters in length.</span>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <div\n                  className={`w-5 h-5 rounded-full border-2 ${pinRequirements.uppercase ? \"border-green-500 bg-green-500\" : \"border-gray-300 bg-white\"}`}\n                >\n                  {pinRequirements.uppercase && (\n                    <svg className=\"w-3 h-3 text-white m-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                    </svg>\n                  )}\n                </div>\n                <span className=\"text-gray-700\">Contain an uppercase letter.</span>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <div\n                  className={`w-5 h-5 rounded-full border-2 ${pinRequirements.number ? \"border-green-500 bg-green-500\" : \"border-gray-300 bg-white\"}`}\n                >\n                  {pinRequirements.number && (\n                    <svg className=\"w-3 h-3 text-white m-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                    </svg>\n                  )}\n                </div>\n                <span className=\"text-gray-700\">Contain a number.</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Buttons - Fixed at bottom */}\n      <div className=\"px-6 pb-6 pt-4 flex-shrink-0 space-y-3\" style={{ minHeight: 'auto' }}>\n        <div\n          className={`w-full rounded-full py-4 text-base font-medium flex items-center justify-center gap-2 transition-colors ${\n            allRequirementsMet \n              ? \"bg-gray-900 hover:bg-gray-800 cursor-pointer\" \n              : \"bg-gray-300 text-gray-500 cursor-not-allowed\"\n          }`}\n          style={allRequirementsMet ? { color: '#ffffff' } : {}}\n          onClick={allRequirementsMet ? handleSubmit : undefined}\n        >\n          Continue\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n          </svg>\n        </div>\n      </div>\n    </div>\n  );\n} ","import React, { useState, useEffect } from \"react\";\nimport personaImg from \"../assets/persona.png\";\n\n/* -------------------------\n   ICON COMPONENTS\n-------------------------- */\nconst Icon = ({ type }) => {\n  const base = \"w-4 h-4 text-gray-700\";\n\n  switch (type) {\n    case \"User\":\n      return (\n        <svg className={base} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4\n           1.79-4 4 1.79 4 4 4zm0 2c-2.67\n           0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"/>\n        </svg>\n      );\n    case \"Memory\":\n      return (\n        <svg className={base} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M12 2C6.48 2 2 6.48 2\n           12s4.48 10 10 10 10-4.48 10-10S17.52\n           2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z\"/>\n        </svg>\n      );\n    case \"Grid3X3\":\n      return (\n        <svg className={base} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10\n           0h8V11h-8v10zm0-18v6h8V3h-8z\"/>\n        </svg>\n      );\n    case \"Brain\":\n      return (\n        <svg className={base} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n          <path d=\"M11.99 2C6.47 2 2 6.48 2\n           12s4.47 10 9.99 10C17.52\n           22 22 17.52 22 12S17.52\n           2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8\n           8-8 8 3.58 8 8-3.58 8-8\n           8zm3.5-9c.83 0 1.5-.67\n           1.5-1.5S16.33 8 15.5\n           8 14 8.67 14 9.5s.67 1.5\n           1.5 1.5zm-7 0c.83 0 1.5-.67\n           1.5-1.5S9.33 8 8.5\n           8 7 8.67 7 9.5s.67 1.5\n           1.5 1.5zm3.5 6.5c2.33\n           0 4.31-1.46 5.11-3.5H6.89c.8\n           2.04 2.78 3.5 5.11 3.5z\"/>\n        </svg>\n      );\n    default:\n      return null;\n  }\n};\n\n/* -------------------------\n   TOGGLE (soft apple style)\n-------------------------- */\nconst DataTypeToggle = ({ dataType, enabled, onToggle, isNative }) => {\n  const handle = () => {\n    if (dataType.required) return;\n    onToggle(dataType.id, !enabled);\n  };\n\n  return (\n    <button\n      onClick={handle}\n      className=\"\n        w-full flex items-center justify-between\n        py-2 px-2\n        bg-white/40 backdrop-blur-sm\n        hover:bg-white/70\n        transition rounded-xl shadow-sm\n      \"\n    >\n      <div className=\"flex items-center gap-3\">\n        <div className=\"w-7 h-7 flex items-center justify-center rounded-full bg-gray-100\">\n          <Icon type={dataType.icon} />\n        </div>\n        <span className={`${isNative ? 'text-[15px]' : 'text-[14px]'} text-gray-900 font-medium`}>\n          {dataType.name}\n        </span>\n      </div>\n\n      <div\n        className={`w-5 h-5 rounded-md border flex items-center justify-center shadow-sm\n          transition\n          ${enabled\n            ? \"bg-gray-900 border-gray-900\"\n            : \"bg-white border-gray-300\"\n          }`}\n      >\n        {enabled && (\n          <svg className=\"w-3 h-3 text-white\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path d=\"M16.707 5.293a1 1 0 010\n            1.414l-8 8a1 1 0 01-1.414\n            0l-4-4a1 1 0 011.414-1.414L8\n            12.586l7.293-7.293a1 1 0\n            011.414 0z\"/>\n          </svg>\n        )}\n      </div>\n    </button>\n  );\n};\n\n/* -------------------------\n   MAIN COMPONENT\n-------------------------- */\n\nconst options = [\n  { id: \"basic\", name: \"Basic Profile\", icon: \"User\", required: true },\n  { id: \"rawMemories\", name: \"Raw Memory Data\", icon: \"Memory\" },\n  { id: \"preferences\", name: \"User Preferences\", icon: \"Grid3X3\" },\n  { id: \"personality\", name: \"Personality Traits\", icon: \"Brain\" },\n];\n\nconst DataRequest = ({ appName = \"My App\", onComplete, onConnectMoreApps, connectedPlatforms = [], showTime = false }) => {\n  const [selected, setSelected] = useState({\n    basic: true,\n    rawMemories: false,\n    preferences: false,\n    personality: false,\n  });\n\n  const [freq, setFreq] = useState(\"weekly\");\n  const [platformIconFailed, setPlatformIconFailed] = useState({});\n  const [platforms, setPlatforms] = useState([]);\n\n  const isWrappedApp = typeof appName === 'string' && appName.toLowerCase().includes('wrapped');\n\n  // Normalize platform ids/names coming from different sources (SDK, backend, localStorage)\n  // so logos always render (e.g. \"linkedin\" -> \"LinkedIn\").\n  const normalizePlatformName = (p) => {\n    const key = String(p || '').trim();\n    const lower = key.toLowerCase();\n    const map = {\n      instagram: 'Instagram',\n      youtube: 'YouTube',\n      linkedin: 'LinkedIn',\n      reddit: 'Reddit',\n      pinterest: 'Pinterest',\n      github: 'GitHub',\n      facebook: 'Facebook',\n      gmail: 'Gmail',\n      twitter: 'Twitter',\n      x: 'Twitter',\n      chatgpt: 'ChatGPT',\n      claude: 'Claude',\n      gemini: 'Gemini',\n      grok: 'Grok',\n    };\n    return map[lower] || (key ? key.charAt(0).toUpperCase() + key.slice(1) : '');\n  };\n\n  const toggle = (id, val) =>\n    setSelected((p) => ({ ...p, [id]: val }));\n\n  const selectedCount = Object.values(selected).filter(Boolean).length;\n\n  // Ensure we actually show connected platforms even if prop isn't passed\n  const getConnected = () => {\n    console.log(' DataRequest getConnected:', { \n      connectedPlatforms, \n      isArray: Array.isArray(connectedPlatforms),\n      type: typeof connectedPlatforms \n    });\n\n    // Prefer localStorage as the source of truth (it is updated by UniversalOnboarding on OAuth return).\n    // This avoids stale props causing \"added platforms\" to not show up until a full refresh.\n    try {\n      const u = JSON.parse(localStorage.getItem(\"onairosUser\") || \"{}\");\n      if (u && u.connectedAccounts) {\n        // Check if it's an array\n        if (Array.isArray(u.connectedAccounts)) {\n          const normalized = u.connectedAccounts.map(normalizePlatformName).filter(Boolean);\n          console.log(' Using localStorage connectedAccounts (array):', u.connectedAccounts, '', normalized);\n          return normalized;\n        }\n        // Check if it's an object\n        if (typeof u.connectedAccounts === \"object\") {\n          const mappedRaw = Object.entries(u.connectedAccounts).filter(([_, v]) => Boolean(v)).map(([k]) => k);\n          const mapped = mappedRaw.map(normalizePlatformName).filter(Boolean);\n          console.log(' Using localStorage connectedAccounts (object):', mappedRaw, '', mapped);\n          return mapped;\n        }\n      }\n    } catch (e) {\n      console.error(' Failed to read localStorage:', e);\n    }\n\n    // Fall back to prop if localStorage isn't available / doesn't have the field.\n    // If array provided, use it\n    if (Array.isArray(connectedPlatforms) && connectedPlatforms.length > 0) {\n      const normalized = connectedPlatforms.map(normalizePlatformName).filter(Boolean);\n      console.log(' Using connectedPlatforms prop (array):', connectedPlatforms, '', normalized);\n      return normalized;\n    }\n    \n    // If object provided, map truthy keys\n    if (connectedPlatforms && typeof connectedPlatforms === \"object\" && !Array.isArray(connectedPlatforms)) {\n      const mappedRaw = Object.entries(connectedPlatforms).filter(([_, v]) => Boolean(v)).map(([k]) => k);\n      const mapped = mappedRaw.map(normalizePlatformName).filter(Boolean);\n      console.log(' Using connectedPlatforms prop (object):', mappedRaw, '', mapped);\n      return mapped;\n    }\n    \n    console.log(' No connected platforms found');\n    return [];\n  };\n\n  // Refresh platforms list on mount and when connectedAccounts changes\n  useEffect(() => {\n    const refreshPlatforms = () => {\n      const newPlatforms = getConnected();\n      console.log(' DataRequest refreshing platforms:', newPlatforms);\n      setPlatforms(newPlatforms);\n    };\n\n    // Initial load\n    refreshPlatforms();\n\n    // Listen for custom event from UniversalOnboarding\n    const handleConnectedAccountsUpdate = () => {\n      console.log(' DataRequest received connectedAccountsUpdate event');\n      refreshPlatforms();\n    };\n    window.addEventListener('onairos-connected-accounts-update', handleConnectedAccountsUpdate);\n\n    return () => {\n      window.removeEventListener('onairos-connected-accounts-update', handleConnectedAccountsUpdate);\n    };\n  }, [connectedPlatforms]); // Re-run if connectedPlatforms prop changes\n\n  console.log(' Final platforms to display:', platforms);\n\n  const isCapacitorNative = typeof window !== 'undefined' && \n    window.Capacitor && \n    typeof window.Capacitor.isNativePlatform === 'function' && \n    window.Capacitor.isNativePlatform();\n\n  // Check if user has any LLM connections\n  const hasLLMConnections = () => {\n    const llmPlatforms = ['chatgpt', 'claude', 'gemini', 'grok', 'ChatGPT', 'Claude', 'Gemini', 'Grok'];\n    return platforms.some(p => llmPlatforms.includes(p));\n  };\n\n  // Filter options based on LLM connections\n  const availableOptions = options.filter(opt => {\n    if (opt.id === 'rawMemories') {\n      return hasLLMConnections();\n    }\n    return true;\n  });\n\n  const freqToPercent = (f) => (f === \"once\" ? 0 : f === \"weekly\" ? 50 : 100);\n  const handleRailClick = (e) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = Math.max(0, Math.min(rect.width, e.clientX - rect.left));\n    const ratio = x / rect.width;\n    if (ratio < 1 / 3) setFreq(\"once\");\n    else if (ratio < 2 / 3) setFreq(\"weekly\");\n    else setFreq(\"daily\");\n  };\n\n  return (\n    <div className=\"flex flex-col h-full max-h-full md:max-h-[90vh] bg-white/70 backdrop-blur-2xl rounded-3xl overflow-hidden\">\n\n      {/* CONTENT */}\n      <div className=\"flex-1 overflow-y-auto px-6 pt-4 md:pt-10 pb-3\">\n\n        {/* ICONS */}\n        <div className=\"flex justify-center items-center gap-4 mb-3 md:mb-6\">\n          {/* Wrapped: Onairos -> Persona. Non-wrapped: Onairos -> app placeholder */}\n          <div className={`${isCapacitorNative ? 'w-14 h-14' : 'w-12 h-12'} rounded-2xl bg-white shadow flex items-center justify-center`}>\n            {isWrappedApp ? (\n              <img \n                src=\"https://onairos.sirv.com/Images/OnairosBlack.png\" \n                alt=\"Onairos\"\n                className={`${isCapacitorNative ? 'w-10 h-10' : 'w-8 h-8'} object-contain`}\n              />\n            ) : (\n              <img \n                src=\"https://onairos.sirv.com/Images/OnairosBlack.png\" \n                alt=\"Onairos\"\n                className={`${isCapacitorNative ? 'w-10 h-10' : 'w-8 h-8'} object-contain`}\n              />\n            )}\n          </div>\n          <svg className={`${isCapacitorNative ? 'w-8 h-8' : 'w-6 h-6'} text-gray-400`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14 5l7 7m0 0l-7 7m7-7H3\" />\n          </svg>\n          <div className={`${isCapacitorNative ? 'w-14 h-14' : 'w-12 h-12'} rounded-2xl bg-white shadow flex items-center justify-center`}>\n            {isWrappedApp ? (\n              <img \n                src={personaImg}\n                alt=\"Persona\"\n                className={`${isCapacitorNative ? 'w-10 h-10' : 'w-8 h-8'} object-contain rounded-xl`}\n                onError={(e) => { e.currentTarget.style.display = 'none'; }}\n              />\n            ) : (\n              <span className={`${isCapacitorNative ? 'text-2xl' : 'text-xl'} font-serif font-bold`}>J</span>\n            )}\n          </div>\n        </div>\n\n        {/* TITLE */}\n        <div className=\"text-center mb-4 md:mb-8\">\n          <h1 \n            className={`${isCapacitorNative ? 'text-[22px] md:text-[28px]' : 'text-[20px] md:text-[26px]'} font-bold text-gray-900 leading-tight`}\n            style={{ fontFamily: 'IBM Plex Sans, system-ui, sans-serif' }}\n          >\n            {appName} wants to personalize your experience\n          </h1>\n          <p \n            className={`${isCapacitorNative ? 'text-[13px]' : 'text-[12px]'} text-gray-500 mt-0.5`}\n            style={{ fontFamily: 'Inter, system-ui, sans-serif' }}\n          >\n            choose what to share\n          </p>\n        </div>\n\n        {/* TOGGLES */}\n        <div className={`${isCapacitorNative ? 'flex flex-col gap-2' : 'flex flex-col sm:grid sm:grid-cols-2 gap-2 sm:gap-4'} mb-4 md:mb-10`}>\n          {availableOptions.map((opt) => (\n            <DataTypeToggle\n              key={opt.id}\n              dataType={opt}\n              enabled={selected[opt.id]}\n              onToggle={toggle}\n              isNative={isCapacitorNative}\n            />\n          ))}\n        </div>\n\n        {/* FREQUENCY PANEL - Only shown if showTime is true */}\n        {showTime && (\n          <div className=\"p-5 rounded-3xl bg-white/50 backdrop-blur-md border border-black/5 shadow-sm\">\n            <div className=\"flex justify-between items-center mb-3\">\n              <span className=\"text-sm font-medium text-gray-900\">\n                How often can {appName} receive updates?\n              </span>\n              <span className=\"text-[11px] text-gray-500\">\n                {freq === \"once\"\n                  ? \"one-time only\"\n                  : freq === \"weekly\"\n                  ? \"once per week\"\n                  : \"once per day\"}\n              </span>\n            </div>\n\n            {/* SLIDER: subtle rail, monochrome progress, click-to-set */}\n            <div\n              className=\"relative h-2.5 rounded-full bg-gray-200/90 overflow-hidden mb-4 border border-black/5 shadow-inner cursor-pointer\"\n              onClick={handleRailClick}\n            >\n              <div\n                className=\"absolute h-full transition-all rounded-full\"\n                style={{\n                  width: `${freqToPercent(freq)}%`,\n                  background: \"linear-gradient(90deg, rgba(31,41,55,0.95) 0%, rgba(107,114,128,0.9) 60%, rgba(209,213,219,0.85) 100%)\",\n                }}\n              />\n              {/* Tick marks for 3 stops */}\n              <span className=\"absolute left-0 top-1/2 -translate-y-1/2 w-[2px] h-3 bg-black/10\" />\n              <span className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[2px] h-3 bg-black/10\" />\n              <span className=\"absolute right-0 top-1/2 -translate-y-1/2 w-[2px] h-3 bg-black/10\" />\n              {/* Thumb indicator (sleek) */}\n              <span\n                className=\"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 w-4.5 h-4.5 rounded-full bg-white border border-black/20 shadow-md\"\n                style={{\n                  left: `${freqToPercent(freq)}%`,\n                }}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-3 text-center text-[12px] font-medium\">\n              <button onClick={() => setFreq(\"once\")} className=\"text-gray-700\">1 only</button>\n              <button onClick={() => setFreq(\"weekly\")} className=\"text-gray-900 font-semibold\">1 weekly</button>\n              <button onClick={() => setFreq(\"daily\")} className=\"text-gray-700\">1 daily</button>\n            </div>\n\n            <p className=\"text-[11px] text-gray-500 mt-3 leading-snug\">\n              This only controls update frequency; It does not grant more access.\n            </p>\n          </div>\n        )}\n\n      </div>\n\n      {/* FOOTER */}\n      <div className=\"px-6 py-4 md:py-5 bg-white/80 backdrop-blur border-t border-black/5\">\n        {/* Connected platforms pinned above CTAs so it never gets cropped on mobile */}\n        {platforms && platforms.length > 0 && (\n          <div className=\"mb-3 rounded-2xl bg-white/60 backdrop-blur border border-black/5 px-3 py-2\">\n            <div className=\"text-center text-[11px] text-gray-500 mb-1\">Connected Platforms</div>\n            <div className=\"flex items-center justify-center gap-2 overflow-x-auto whitespace-nowrap pb-1\" style={{ WebkitOverflowScrolling: 'touch' }}>\n              {platforms.map((platform, index) => {\n                const logoMap = {\n                  Instagram: 'https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png',\n                  YouTube: 'https://upload.wikimedia.org/wikipedia/commons/0/09/YouTube_full-color_icon_%282017%29.svg',\n                  LinkedIn: 'https://upload.wikimedia.org/wikipedia/commons/c/ca/LinkedIn_logo_initials.png',\n                  Reddit: 'https://upload.wikimedia.org/wikipedia/en/b/bd/Reddit_Logo_Icon.svg',\n                  Pinterest: 'https://upload.wikimedia.org/wikipedia/commons/0/08/Pinterest-logo.png',\n                  GitHub: 'https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png',\n                  Facebook: 'https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg',\n                  Gmail: 'https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg',\n                  Twitter: 'https://upload.wikimedia.org/wikipedia/commons/6/6f/Logo_of_Twitter.svg',\n                  ChatGPT: 'https://anushkasirv.sirv.com/openai.png',\n                  Claude: 'https://anushkasirv.sirv.com/claude-color.png',\n                  Gemini: 'https://anushkasirv.sirv.com/gemini-color.png',\n                  Grok: 'https://anushkasirv.sirv.com/grok.png'\n                };\n                const src = logoMap[platform] || '';\n                const key = `${platform}-${index}`;\n                const failed = !!platformIconFailed[key];\n                const fallbackText = (() => {\n                  if (platform === 'LinkedIn') return 'in';\n                  if (platform === 'YouTube') return 'YT';\n                  if (platform === 'ChatGPT') return 'AI';\n                  return String(platform || '?').slice(0, 2).toUpperCase();\n                })();\n                return (\n                  failed || !src ? (\n                    <div\n                      key={key}\n                      title={platform}\n                      className=\"w-6 h-6 rounded-md shadow-sm flex-shrink-0 bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-semibold\"\n                    >\n                      {fallbackText}\n                    </div>\n                  ) : (\n                    <img\n                      key={key}\n                      src={src}\n                      alt={platform}\n                      title={platform}\n                      className=\"w-6 h-6 rounded-md shadow-sm flex-shrink-0\"\n                      onError={() => setPlatformIconFailed((p) => ({ ...p, [key]: true }))}\n                    />\n                  )\n                );\n              })}\n            </div>\n            {typeof onConnectMoreApps === 'function' && (\n              <div className=\"mt-1 flex justify-center\">\n                <button\n                  type=\"button\"\n                  onClick={onConnectMoreApps}\n                  className=\"text-[11px] font-medium text-gray-700 hover:text-gray-900 inline-flex items-center gap-1.5\"\n                  style={{ WebkitTextFillColor: '#111827' }}\n                >\n                  <span>Connect more</span>\n                  <span\n                    aria-hidden=\"true\"\n                    className=\"inline-flex items-center justify-center w-4 h-4 rounded-full border border-gray-400 text-gray-800 leading-none\"\n                    style={{ WebkitTextFillColor: '#111827' }}\n                  >\n                    +\n                  </span>\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* If no platforms are connected yet, still allow user to go connect apps */}\n        {(!platforms || platforms.length === 0) && typeof onConnectMoreApps === 'function' && (\n          <div className=\"mb-3 rounded-2xl bg-white/60 backdrop-blur border border-black/5 px-3 py-2 text-center\">\n            <div className=\"text-[11px] text-gray-500 mb-1\">No apps connected yet</div>\n            <button\n              type=\"button\"\n              onClick={onConnectMoreApps}\n              className=\"text-[12px] font-medium underline underline-offset-2 text-gray-700 hover:text-gray-900\"\n              style={{ WebkitTextFillColor: '#111827' }}\n            >\n              Connect apps?\n            </button>\n          </div>\n        )}\n        <button\n          className=\"w-full rounded-full py-3 bg-gray-900 text-sm font-medium shadow-sm flex items-center justify-center mb-3\"\n          style={{ color: '#ffffff' }}\n          disabled={selectedCount === 0}\n          onClick={() => {\n            if (selectedCount === 0) return;\n            onComplete?.({\n              approved: Object.keys(selected).filter(id => selected[id]),\n              freq,\n            });\n          }}\n        >\n          Accept & Continue\n        </button>\n\n        <style>{`\n          .decline-button {\n            color: #000000 !important;\n          }\n          .decline-button * {\n            color: #000000 !important;\n          }\n          .decline-button span {\n            color: #000000 !important;\n          }\n          button.decline-button {\n            color: #000000 !important;\n          }\n          .decline-button-text {\n            color: #000000 !important;\n            -webkit-text-fill-color: #000000 !important;\n          }\n        `}</style>\n        <button\n          className=\"w-full rounded-full py-3 bg-gray-100 text-sm font-medium shadow-sm decline-button\"\n          style={{ color: '#000000' }}\n          onClick={() => {\n            onComplete?.({\n              approved: [],\n              freq,\n              declined: true,\n            });\n          }}\n        >\n          <span className=\"decline-button-text\" style={{ color: '#000000' }}>Decline</span>\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default DataRequest;\n","import React, { useState, useEffect } from 'react';\nimport { COLORS } from '../theme/colors.js';\n\nexport default function TrainingComponent({ onComplete, userEmail, appName = 'App', testMode = false }) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [progress, setProgress] = useState(0);\n  const [isComplete, setIsComplete] = useState(false);\n\n  const steps = [\n    {\n      title: 'Setting up your personal AI',\n      description: 'Initializing your secure data model',\n      icon: '',\n      duration: testMode ? 800 : 2000 // Much faster in test mode\n    },\n    {\n      title: 'Processing your connections',\n      description: 'Analyzing your social media patterns',\n      icon: '',\n      duration: testMode ? 600 : 2500\n    },\n    {\n      title: 'Training your model',\n      description: 'Building your personalized insights',\n      icon: '',\n      duration: testMode ? 700 : 3000\n    },\n    {\n      title: 'Finalizing setup',\n      description: 'Preparing your Onairos experience',\n      icon: '',\n      duration: testMode ? 500 : 2000\n    }\n  ];\n\n  useEffect(() => {\n    let interval;\n    let stepTimeout;\n\n    if (currentStep < steps.length) {\n      const stepDuration = steps[currentStep].duration;\n      const stepProgress = 100 / steps.length;\n\n      // Update progress gradually\n      interval = setInterval(() => {\n        setProgress(prev => {\n          const newProgress = prev + (stepProgress / (stepDuration / 100));\n          return Math.min(newProgress, (currentStep + 1) * stepProgress);\n        });\n      }, 100);\n\n      // Move to next step after duration\n      stepTimeout = setTimeout(() => {\n        if (currentStep < steps.length - 1) {\n          setCurrentStep(prev => prev + 1);\n        } else {\n          setIsComplete(true);\n          const completionDelay = testMode ? 400 : 1000; // Faster completion in test mode\n          \n          if (testMode) {\n            console.log(' Test mode: Training simulation completed');\n          }\n          \n          setTimeout(() => {\n            onComplete({\n              trainingComplete: true,\n              timestamp: new Date().toISOString(),\n              userEmail: userEmail,\n              appName: appName,\n              testMode: testMode,\n              simulatedTraining: testMode\n            });\n          }, completionDelay);\n        }\n      }, stepDuration);\n    }\n\n    return () => {\n      if (interval) clearInterval(interval);\n      if (stepTimeout) clearTimeout(stepTimeout);\n    };\n  }, [currentStep, onComplete, userEmail, appName]);\n\n  return (\n    <div className=\"w-full flex flex-col items-center space-y-8\">\n      <div className=\"text-center\">\n        <div \n          className=\"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4\"\n          style={{\n            background: `linear-gradient(135deg, ${COLORS.info}, #8B5CF6)`\n          }}\n        >\n          <div className=\"text-3xl\">\n            {isComplete ? '' : steps[currentStep]?.icon}\n          </div>\n        </div>\n        <h2 \n          className=\"text-2xl font-bold mb-2\"\n          style={{ color: COLORS.textPrimary }}\n        >\n          {isComplete ? 'All set!' : steps[currentStep]?.title}\n        </h2>\n        <p style={{ color: COLORS.textSecondary }}>\n          {isComplete \n            ? 'Your personal AI is ready to use' \n            : steps[currentStep]?.description\n          }\n        </p>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"w-full\">\n        <div \n          className=\"flex justify-between text-sm mb-2\"\n          style={{ color: COLORS.textSecondary }}\n        >\n          <span>Progress</span>\n          <span>{Math.round(progress)}%</span>\n        </div>\n        <div \n          className=\"w-full rounded-full h-2\"\n          style={{ backgroundColor: COLORS.borderLight }}\n        >\n          <div \n            className=\"h-2 rounded-full transition-all duration-300 ease-out\"\n            style={{ \n              width: `${progress}%`,\n              background: `linear-gradient(90deg, ${COLORS.info}, #8B5CF6)`\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Steps Indicator */}\n      <div className=\"flex justify-center space-x-2\">\n        {steps.map((_, index) => (\n          <div\n            key={index}\n            className=\"w-3 h-3 rounded-full transition-all duration-300\"\n            style={{\n              backgroundColor: index <= currentStep ? COLORS.info : COLORS.border\n            }}\n          />\n        ))}\n      </div>\n\n      {/* Current Step Details */}\n      <div \n        className=\"p-4 rounded-lg w-full\"\n        style={{ backgroundColor: COLORS.backgroundSecondary }}\n      >\n        <div className=\"flex items-center space-x-3\">\n          <div \n            className=\"w-8 h-8 rounded-full flex items-center justify-center\"\n            style={{ backgroundColor: '#DBEAFE' }}\n          >\n            <div className=\"text-sm\">\n              {isComplete ? '' : steps[currentStep]?.icon}\n            </div>\n          </div>\n          <div>\n            <h3 \n              className=\"font-medium\"\n              style={{ color: COLORS.textPrimary }}\n            >\n              {isComplete ? 'Training Complete' : `Step ${currentStep + 1} of ${steps.length}`}\n            </h3>\n            <p \n              className=\"text-sm\"\n              style={{ color: COLORS.textSecondary }}\n            >\n              {isComplete \n                ? 'Your Onairos experience is ready' \n                : steps[currentStep]?.description\n              }\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* App Info */}\n      <div className=\"text-center\">\n        <p \n          className=\"text-sm\"\n          style={{ color: COLORS.textSecondary }}\n        >\n          Setting up for <span className=\"font-medium\">{appName}</span>\n        </p>\n        {userEmail && (\n          <p \n            className=\"text-xs mt-1\"\n            style={{ color: COLORS.textMuted }}\n          >\n            {userEmail}\n          </p>\n        )}\n      </div>\n    </div>\n  );\n} ","import React, { useEffect, useState, useRef } from 'react';\nimport Lottie from 'lottie-react';\nimport rainAnim from '../../public/rain-anim.json';\nimport io from 'socket.io-client';\n\nconst trainingPhrases = [\n  \"Analyzing your data patterns...\",\n  \"Building your personality model...\",\n  \"Training neural networks...\",\n  \"Running inference algorithms...\",\n  \"Generating personalized insights...\",\n  \"Finalizing your profile...\",\n  \"Almost done...\"\n];\n\nexport default function TrainingScreen({ onComplete, onTrainingStart, userEmail, connectedAccounts = [], userToken }) {\n  const [progress, setProgress] = useState(0);\n  const [currentPhrase, setCurrentPhrase] = useState(trainingPhrases[0]);\n  const [currentStage, setCurrentStage] = useState('training'); // 'training' | 'inference' | 'complete'\n  const lottieRef = useRef(null);\n\n  useEffect(() => {\n    let socket = null;\n    let progressTimer = null;\n    let didSignalStart = false;\n\n    const signalTrainingStarted = () => {\n      if (didSignalStart) return;\n      didSignalStart = true;\n      try {\n        onTrainingStart?.();\n      } catch (e) {\n        // never block training due to callback issues\n      }\n    };\n    \n    // ACTUALLY run training + inference using Socket.IO\n    const runTrainingAndInference = async () => {\n      console.log(' Starting REAL training for:', userEmail);\n      console.log(' Connected accounts:', connectedAccounts);\n      console.log(' userToken prop received:', userToken ? `${userToken.substring(0, 20)}...` : 'UNDEFINED');\n\n      try {\n        // Use token passed from parent component, fallback to localStorage\n        let token = userToken;\n        \n        if (!token) {\n          console.warn(' Token not passed as prop, checking localStorage...');\n          try {\n            const storedToken = localStorage.getItem('onairos_user_token');\n            if (storedToken) {\n              token = storedToken;\n              console.log(' Found token in localStorage');\n            } else {\n              const userData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n              token = userData.token;\n              if (token) {\n                console.log(' Found token in onairosUser localStorage');\n              }\n            }\n          } catch (e) {\n            console.error(' Error reading from localStorage:', e);\n          }\n        }\n\n        if (!token) {\n          console.error(' No token found anywhere - cannot run training');\n          console.error(' Token should be passed from parent component OR stored in localStorage');\n          throw new Error('No authentication token');\n        }\n        \n        console.log(' Token found, starting Socket.IO training...', token.substring(0, 20) + '...');\n\n        // Phase 1: Connect to Socket.IO\n        setCurrentStage('training');\n        setCurrentPhrase('Connecting to server...');\n        console.log(' Connecting to Socket.IO server...');\n\n        socket = io('https://api2.onairos.uk', {\n          auth: { token },\n          transports: ['websocket', 'polling'],\n          reconnection: false, // Don't reconnect automatically for this one-time operation\n          timeout: 60000 // 60 second timeout\n        });\n\n        // Handle connection\n        socket.on('connect', () => {\n          console.log(' Socket connected:', socket.id);\n          // At this point, training can actually start (server reachable).\n          signalTrainingStarted();\n          setCurrentPhrase('Starting training...');\n          \n          // Start progress animation\n          progressTimer = setInterval(() => {\n            setProgress(prev => {\n              if (prev < 95) return prev + 0.5; // Slow smooth progress\n              return prev;\n            });\n          }, 200);\n\n          // Trigger training\n          console.log(' Emitting start-training event with:', {\n            socketId: socket.id,\n            email: userEmail,\n            platforms: connectedAccounts\n          });\n\n          socket.emit('start-training', {\n            socketId: socket.id,\n            email: userEmail,\n            username: userEmail,\n            platforms: connectedAccounts,\n            connectedAccounts: connectedAccounts\n          });\n        });\n\n        // Handle training progress updates\n        socket.on('training-progress', (data) => {\n          console.log(' Training progress:', data);\n          // Progress events mean training has definitely started.\n          signalTrainingStarted();\n          if (data.percentage) {\n            setProgress(Math.min(data.percentage, 95)); // Cap at 95% until complete\n          }\n          if (data.message) {\n            setCurrentPhrase(data.message);\n          }\n          if (data.stage) {\n            setCurrentStage(data.stage);\n          }\n        });\n\n        // Handle training completion\n        socket.on('training-complete', (result) => {\n          console.log(' Training complete via Socket.IO:', result);\n          \n          if (progressTimer) clearInterval(progressTimer);\n          setProgress(100);\n          setCurrentStage('complete');\n          setCurrentPhrase('Training complete!');\n\n          // Log complete results to console\n          console.log('\\n ===== TRAINING + INFERENCE COMPLETE =====\\n');\n          console.log(' Training Results:', {\n            status: 'completed',\n            userEmail,\n            connectedPlatforms: connectedAccounts,\n            traits: result.traits || result.trainingResults?.traits || {},\n            timestamp: new Date().toISOString()\n          });\n          \n          console.log('\\n Traits Retrieved:', {\n            traits: result.traits || result.trainingResults?.traits || {},\n            userTraits: result.userTraits || result.trainingResults?.userTraits || {},\n            hasLlmData: !!result.llmData,\n            inferenceResults: result.inferenceResults || null\n          });\n          \n          console.log('\\n Model ready for predictions!\\n');\n\n          // Disconnect socket\n          socket.disconnect();\n\n          // Complete after short delay\n          setTimeout(() => {\n            onComplete?.(result);\n          }, 500);\n        });\n\n        // Handle errors\n        socket.on('training-error', (error) => {\n          console.error(' Training error from Socket.IO:', error);\n          \n          if (progressTimer) clearInterval(progressTimer);\n          \n          setProgress(100);\n          setCurrentPhrase('Error occurred, continuing...');\n          \n          socket.disconnect();\n          \n          setTimeout(() => {\n            onComplete?.({ \n              error: error.message || 'Training failed',\n              fallback: true \n            });\n          }, 500);\n        });\n\n        // Handle connection errors\n        socket.on('connect_error', (error) => {\n          console.error(' Socket.IO connection error:', error);\n          \n          if (progressTimer) clearInterval(progressTimer);\n          \n          setProgress(100);\n          setCurrentPhrase('Connection error, continuing...');\n          \n          socket.disconnect();\n          \n          setTimeout(() => {\n            onComplete?.({ \n              error: 'Failed to connect to training server',\n              fallback: true \n            });\n          }, 500);\n        });\n\n        // Handle disconnect\n        socket.on('disconnect', (reason) => {\n          console.log(' Socket disconnected:', reason);\n        });\n\n      } catch (error) {\n        console.error(' Training/Inference Error:', error);\n        \n        if (progressTimer) clearInterval(progressTimer);\n        if (socket) socket.disconnect();\n        \n        // Fallback: still complete but show error\n        console.warn(' Falling back to cached data or skipping training');\n        setProgress(100);\n        setTimeout(() => {\n          onComplete?.({ \n            error: error.message,\n            fallback: true \n          });\n        }, 500);\n      }\n    };\n\n    runTrainingAndInference();\n\n    // Cleanup on unmount\n    return () => {\n      if (progressTimer) clearInterval(progressTimer);\n      if (socket) {\n        console.log(' Cleaning up socket connection');\n        socket.disconnect();\n      }\n    };\n  }, [userEmail, connectedAccounts, userToken, onComplete]);\n\n  return (\n    <div className=\"w-full h-full flex flex-col items-center justify-center p-8 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900\">\n      <style>{`\n        @keyframes float {\n          0%, 100% { transform: translateY(0px); }\n          50% { transform: translateY(-20px); }\n        }\n        .float-animation {\n          animation: float 6s ease-in-out infinite;\n        }\n        .glow-bar {\n          box-shadow: 0 0 20px rgba(59, 130, 246, 0.5),\n                      0 0 40px rgba(139, 92, 246, 0.3),\n                      inset 0 0 20px rgba(255, 255, 255, 0.1);\n        }\n      `}</style>\n\n      {/* Rain Animation - Sleek and centered */}\n      <div className=\"w-full max-w-sm mb-6 float-animation\">\n        <Lottie \n          lottieRef={lottieRef}\n          animationData={rainAnim}\n          loop={true}\n          autoplay={true}\n          style={{ width: '100%', height: '240px', filter: 'brightness(1.1)' }}\n        />\n      </div>\n\n      {/* Training Status - Sleeker design */}\n      <div className=\"w-full max-w-lg\">\n        {/* Title with stage indicator */}\n        <div className=\"text-center mb-6\">\n          <div className=\"inline-flex items-center gap-2 mb-3 px-4 py-1.5 rounded-full bg-white/10 backdrop-blur-sm border border-white/20\">\n            <div className=\"w-2 h-2 rounded-full bg-blue-400 animate-pulse\"></div>\n            <span className=\"text-xs font-medium text-blue-100 uppercase tracking-wider\">\n              {currentStage === 'training' ? 'Training Model' : \n               currentStage === 'inference' ? 'Running Inference' : 'Complete'}\n            </span>\n          </div>\n          \n          <h2 className=\"text-3xl font-bold text-white mb-2 tracking-tight\">\n            {currentStage === 'complete' ? 'Ready!' : 'Building Your Profile'}\n          </h2>\n          \n          <p className=\"text-blue-200 text-sm font-medium\">\n            {currentPhrase}\n          </p>\n        </div>\n\n        {/* Progress Bar - Sleek glassmorphism design */}\n        <div className=\"relative mb-4\">\n          <div className=\"w-full bg-white/5 backdrop-blur-sm rounded-full h-3 overflow-hidden border border-white/10\">\n            <div \n              className=\"h-full rounded-full transition-all duration-300 ease-out glow-bar\"\n              style={{ \n                width: `${progress}%`,\n                background: 'linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%)'\n              }}\n            />\n          </div>\n          \n          {/* Progress percentage overlay */}\n          <div className=\"absolute inset-0 flex items-center justify-center\">\n            <span className=\"text-xs font-bold text-white drop-shadow-lg\">\n              {progress}%\n            </span>\n          </div>\n        </div>\n\n        {/* Stage indicators */}\n        <div className=\"flex justify-between items-center px-2 mb-6\">\n          <div className={`text-xs font-medium transition-colors ${progress >= 0 ? 'text-blue-400' : 'text-gray-500'}`}>\n            Training\n          </div>\n          <div className={`text-xs font-medium transition-colors ${progress >= 50 ? 'text-purple-400' : 'text-gray-500'}`}>\n            Inference\n          </div>\n          <div className={`text-xs font-medium transition-colors ${progress >= 100 ? 'text-pink-400' : 'text-gray-500'}`}>\n            Complete\n          </div>\n        </div>\n\n        {/* Info box - Sleek and minimal */}\n        <div className=\"mt-6 p-4 rounded-2xl bg-white/5 backdrop-blur-md border border-white/10\">\n          <div className=\"flex items-center justify-center gap-2 text-blue-100\">\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\n            </svg>\n            <p className=\"text-xs\">\n              Processing your data securely  {connectedAccounts.length} {connectedAccounts.length === 1 ? 'platform' : 'platforms'} connected\n            </p>\n          </div>\n        </div>        \n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport Lottie from 'lottie-react';\nimport rainAnim from '../../public/rain-anim.json';\n\nexport default function LoadingScreen({ onComplete }) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [dotCount, setDotCount] = useState(0);\n\n  const loadingStates = [\n    { message: \"Validating PIN and continuing training\", progress: 20 },\n    { message: \"Uploading model to secure storage\", progress: 40 },\n    { message: \"Running test inference\", progress: 60 },\n    { message: \"Storing results in databases\", progress: 80 },\n    { message: \"Complete!\", progress: 100 },\n  ];\n\n  useEffect(() => {\n    const stateInterval = setInterval(() => {\n      setCurrentStep((prev) => {\n        const nextStep = prev + 1;\n        if (nextStep >= loadingStates.length) {\n          // Loading complete, call onComplete after a short delay\n          setTimeout(() => {\n            onComplete();\n          }, 1000);\n          return prev; // Keep at last step\n        }\n        return nextStep;\n      });\n    }, 3000); // Change state every 3 seconds\n\n    return () => clearInterval(stateInterval);\n  }, [loadingStates.length, onComplete]);\n\n  useEffect(() => {\n    const dotInterval = setInterval(() => {\n      setDotCount((prev) => (prev + 1) % 4); // 0, 1, 2, 3 dots\n    }, 500); // Change dots every 500ms\n\n    return () => clearInterval(dotInterval);\n  }, []);\n\n  const currentState = loadingStates[currentStep];\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-500 bg-opacity-50 flex items-center justify-center p-6\" style={{ zIndex: 2147483647, pointerEvents: 'auto' }}>\n      {/* Modal - Full height from bottom */}\n      <div className=\"bg-white rounded-3xl w-full max-w-lg mx-auto shadow-2xl overflow-hidden flex flex-col\" style={{ maxWidth: '500px', height: '100%', maxHeight: '90vh' }}>\n        {/* Header */}\n        <div className=\"px-6 pt-6 pb-4 flex-shrink-0\">\n        </div>\n\n        {/* Content - Rain animation and loading state */}\n        <div className=\"flex-1 flex flex-col px-6\">\n          {/* Rain Animation */}\n          <div className=\"flex-1 flex items-center justify-center\">\n            <div style={{ width: '100%', maxWidth: '400px', aspectRatio: '1' }}>\n              <Lottie\n                animationData={rainAnim}\n                loop={true}\n                autoplay={true}\n                style={{ width: '100%', height: '100%' }}\n              />\n            </div>\n          </div>\n\n          {/* Loading State - Positioned at bottom */}\n          <div className=\"flex-shrink-0 pb-12\">\n            <div className=\"text-center\">\n              <h1 className=\"font-bold text-gray-900 leading-tight mb-6\" style={{ fontSize: 'clamp(16px, 4vw, 20px)' }}>\n                {currentState.message}\n                {currentState.message !== \"Complete!\" && (\n                  <span className=\"inline-block w-8 text-left\">{\".\".repeat(dotCount)}</span>\n                )}\n              </h1>\n\n              <div className=\"mx-auto\" style={{ width: 'clamp(200px, 50vw, 300px)' }}>\n                <div className=\"w-full h-2 bg-gray-200 rounded-full\">\n                  <div\n                    className=\"h-2 bg-gray-900 rounded-full transition-all duration-1000 ease-out\"\n                    style={{ width: `${currentState.progress}%` }}\n                  ></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Bottom spacing */}\n        <div className=\"h-20 flex-shrink-0\"></div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport Lottie from 'lottie-react';\n\nexport default function WrappedLoadingPage({ appName }) {\n  const [animationData, setAnimationData] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [messageIndex, setMessageIndex] = useState(0);\n  \n  // Only show \"Updating your digital brain for 2025...\" if app name contains \"wrapped\"\n  const isWrappedApp = appName && appName.toLowerCase().includes('wrapped');\n\n  // Whimsical rotating messages\n  const messages = [\n    \"Reading your mind...\",\n    \"Connecting the dots...\",\n    \"Brewing insights...\",\n    \"Decoding your vibe...\",\n    \"Piecing together your story...\",\n    \"Finding patterns in the chaos...\",\n    \"Translating data to wisdom...\",\n    \"Your digital fingerprint is unique...\",\n    \"Almost done thinking...\",\n    \"Polishing the final details...\"\n  ];\n\n  useEffect(() => {\n    // Fetch the animation JSON from public folder\n    fetch('/rain-anim.json')\n      .then(res => res.json())\n      .then(data => setAnimationData(data))\n      .catch(err => {\n        console.error('Failed to load rain animation:', err);\n        // Fallback: try from the npm package public folder\n        fetch('https://onairos.sirv.com/rain-anim.json')\n          .then(res => res.json())\n          .then(data => setAnimationData(data))\n          .catch(err2 => console.error('Failed to load rain animation from fallback:', err2));\n      });\n  }, []);\n\n  // Animate progress bar over ~2 minutes (API can take 1-3 minutes)\n  useEffect(() => {\n    const duration = 120000; // 2 minutes in ms\n    const interval = 100; // Update every 100ms\n    const increment = (interval / duration) * 100;\n    \n    const timer = setInterval(() => {\n      setProgress(prev => {\n        const next = prev + increment;\n        // Cap at 95% to avoid reaching 100% before API completes\n        return next >= 95 ? 95 : next;\n      });\n    }, interval);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Rotate messages every 4 seconds\n  useEffect(() => {\n    const messageTimer = setInterval(() => {\n      setMessageIndex(prev => (prev + 1) % messages.length);\n    }, 4000);\n\n    return () => clearInterval(messageTimer);\n  }, []);\n\n  return (\n    <div className=\"flex flex-col items-center justify-center h-full px-6 py-4\">\n      {/* Content is centered vertically inside the modal card */}\n      <div className=\"flex flex-col items-center justify-center w-full max-w-2xl space-y-6\">\n        {/* Title */}\n        <div className=\"text-center\">\n          <h2 className=\"text-xl md:text-2xl font-semibold text-gray-900 mb-1\">\n            {isWrappedApp ? 'Updating your digital brain for 2025...' : 'Processing your data...'}\n          </h2>\n          <p className=\"text-xs md:text-sm text-gray-600\">\n            {isWrappedApp ? 'Crafting your personalized insights from your digital footprint' : 'This will just take a moment'}\n          </p>\n        </div>\n\n        {/* Lottie Animation */}\n        {animationData ? (\n          <div className=\"w-full max-w-sm mx-auto\">\n            {/* Fixed aspect ratio so the figure sits nicely in the center and never clips */}\n            <div className=\"relative w-full\" style={{ paddingBottom: '100%' }}>\n              <Lottie \n                animationData={animationData}\n                loop={true}\n                autoplay={true}\n                className=\"absolute inset-0 w-full h-full\"\n              />\n            </div>\n          </div>\n        ) : (\n          <div className=\"w-full max-w-sm h-64 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900\"></div>\n          </div>\n        )}\n\n        {/* Black and White Loading Bar - Below Lottie */}\n        <div className=\"w-full max-w-md\">\n          <div className=\"relative w-full h-1.5 bg-gray-200 rounded-full overflow-hidden\">\n            <div \n              className=\"absolute top-0 left-0 h-full bg-gray-900 rounded-full transition-all duration-300 ease-out\"\n              style={{ \n                width: `${progress}%`\n              }}\n            />\n          </div>\n          \n          {/* Rotating message with fade transition */}\n          <p \n            key={messageIndex}\n            className=\"text-center text-xs text-gray-600 mt-3 animate-fadeIn\"\n            style={{ \n              animation: 'fadeIn 0.5s ease-in-out'\n            }}\n          >\n            {messages[messageIndex]}\n          </p>\n        </div>\n\n        <style>{`\n          @keyframes fadeIn {\n            0% { opacity: 0; transform: translateY(-4px); }\n            100% { opacity: 1; transform: translateY(0); }\n          }\n        `}</style>\n      </div>\n    </div>\n  );\n}\n\n","/**\n * Response formatter utility for Onairos SDK\n * Converts array-based responses to dictionary format for better developer experience\n */\n\n// Standard 16 personality types in order that the API returns them\nexport const PERSONALITY_TYPES = [\n  'Analyst',\n  'Diplomat', \n  'Sentinel',\n  'Explorer',\n  'Architect',\n  'Logician',\n  'Commander',\n  'Debater',\n  'Advocate',\n  'Mediator',\n  'Protagonist',\n  'Campaigner',\n  'Logistician',\n  'Defender',\n  'Executive',\n  'Consul'\n];\n\n// Standard trait categories that might be returned\nexport const TRAIT_CATEGORIES = [\n  'Openness',\n  'Conscientiousness',\n  'Extraversion',\n  'Agreeableness',\n  'Neuroticism'\n];\n\n/**\n * Formats API response to include both array and dictionary formats\n * @param {Object} apiResponse - Raw API response from Onairos\n * @param {Object} options - Formatting options\n * @param {boolean} options.includeDictionary - Whether to include dictionary format (default: true)\n * @param {boolean} options.includeArray - Whether to include original array format (default: true)\n * @returns {Object} Formatted response with both formats\n */\nexport function formatOnairosResponse(apiResponse, options = {}) {\n  const { includeDictionary = true, includeArray = true } = options;\n  \n  if (!apiResponse) {\n    return apiResponse;\n  }\n\n  const formatted = { ...apiResponse };\n\n  // Handle personality scores if present\n  if (apiResponse.InferenceResult?.traits || apiResponse.traits || apiResponse.scores) {\n    const scores = apiResponse.InferenceResult?.traits || apiResponse.traits || apiResponse.scores;\n    \n    if (Array.isArray(scores) && scores.length >= 16) {\n      if (includeDictionary) {\n        // Create personality dictionary\n        const personalityDict = {};\n        PERSONALITY_TYPES.forEach((type, index) => {\n          personalityDict[type] = scores[index];\n        });\n        \n        // Add to formatted response\n        if (formatted.InferenceResult) {\n          formatted.InferenceResult.personalityDict = personalityDict;\n        } else {\n          formatted.personalityDict = personalityDict;\n        }\n      }\n      \n      if (!includeArray) {\n        // Remove array format if not requested\n        if (formatted.InferenceResult?.traits) {\n          delete formatted.InferenceResult.traits;\n        }\n        if (formatted.traits) {\n          delete formatted.traits;\n        }\n        if (formatted.scores) {\n          delete formatted.scores;\n        }\n      }\n    }\n  }\n\n  // Handle trait data if present (for preferences/traits)\n  if (apiResponse.traitResult || apiResponse.traits) {\n    const traits = apiResponse.traitResult || apiResponse.traits;\n    \n    if (Array.isArray(traits) && includeDictionary) {\n      const traitDict = {};\n      TRAIT_CATEGORIES.forEach((category, index) => {\n        if (traits[index] !== undefined) {\n          traitDict[category] = traits[index];\n        }\n      });\n      \n      formatted.traitDict = traitDict;\n    }\n  }\n\n  return formatted;\n}\n\n/**\n * Legacy formatter for backward compatibility\n * Converts scores array to personality dictionary only\n * @param {Array} scores - Array of personality scores\n * @returns {Object} Dictionary with personality type names as keys\n */\nexport function formatPersonalityScores(scores) {\n  if (!Array.isArray(scores) || scores.length < 16) {\n    console.warn('Invalid scores array provided to formatPersonalityScores');\n    return {};\n  }\n\n  const personalityDict = {};\n  PERSONALITY_TYPES.forEach((type, index) => {\n    personalityDict[type] = scores[index];\n  });\n  \n  return personalityDict;\n}\n\n/**\n * Get personality type names in order\n * @returns {Array} Array of personality type names\n */\nexport function getPersonalityTypes() {\n  return [...PERSONALITY_TYPES];\n}\n\n/**\n * Get trait category names in order  \n * @returns {Array} Array of trait category names\n */\nexport function getTraitCategories() {\n  return [...TRAIT_CATEGORIES];\n} ","/**\n * Enhanced User Data Formatter for onComplete Callback\n * Provides structured, readable formatting of Onairos user data\n */\n\n/**\n * Formats user data for better readability in onComplete callback\n * @param {Object} result - The complete result object from data request\n * @returns {Object} Enhanced result with formatted user data display\n */\nexport function formatUserDataForDisplay(result) {\n  if (!result) return result;\n\n  const formatted = { ...result };\n  \n  // Create a structured summary of the user data\n  const userDataSummary = {\n    // Basic request information\n    requestInfo: {\n      timestamp: result.timestamp || new Date().toISOString(),\n      appName: result.appName || 'Unknown App',\n      userHash: result.userHash || 'Unknown User',\n      testMode: result.testMode || false,\n      dataTypesRequested: Array.isArray(result.approvedData) ? result.approvedData : (result.approved || [])\n    },\n    \n    // User authentication and profile data\n    userProfile: {\n      email: result.userData?.email || 'Not provided',\n      userType: result.userData?.userType || 'Unknown',\n      onboardingComplete: result.userData?.onboardingComplete || false,\n      pinCreated: result.userData?.pinCreated || false,\n      trainingComplete: result.userData?.trainingComplete || false,\n      modelReady: result.userData?.modelReady || false\n    },\n    \n    // Connected platforms/accounts\n    connectedAccounts: formatConnectedAccounts(result.userData?.connectedAccounts || []),\n    \n    // API response data (personality, preferences, etc.)\n    aiData: formatAIResponseData(result.apiResponse),\n    \n    // Success status and any errors\n    status: {\n      success: result.success || false,\n      hasApiResponse: !!result.apiResponse,\n      hasErrors: !!result.error || !!result.apiError\n    }\n  };\n\n  // Add the formatted summary to the result\n  formatted.userDataSummary = userDataSummary;\n  \n  // Create a pretty-printed version for console logging\n  formatted.prettyPrint = createPrettyPrintVersion(userDataSummary);\n  \n  return formatted;\n}\n\n/**\n * Formats connected accounts data\n * @param {Array} accounts - Array of connected account objects\n * @returns {Object} Formatted accounts summary\n */\nfunction formatConnectedAccounts(accounts) {\n  if (!Array.isArray(accounts) || accounts.length === 0) {\n    return {\n      count: 0,\n      platforms: [],\n      summary: 'No connected accounts'\n    };\n  }\n\n  // SDK stores connectedAccounts as an array of strings (e.g. [\"YouTube\",\"Reddit\"])\n  // in several flows. Support that format as well as object arrays.\n  if (typeof accounts[0] === 'string') {\n    const names = accounts.map(a => String(a || '').trim()).filter(Boolean);\n    return {\n      count: names.length,\n      platforms: names.map(name => ({\n        name,\n        status: 'Connected',\n        connectedAt: 'Unknown date',\n        hasData: false\n      })),\n      summary: `${names.length} platform(s) connected: ${names.join(', ')}`\n    };\n  }\n\n  return {\n    count: accounts.length,\n    platforms: accounts.map(account => ({\n      name: account.platform || account.name || 'Unknown Platform',\n      status: account.status || 'Unknown',\n      connectedAt: account.connectedAt || 'Unknown date',\n      hasData: account.hasData || false\n    })),\n    summary: `${accounts.length} platform(s) connected: ${accounts.map(a => a.platform || a.name).join(', ')}`\n  };\n}\n\n/**\n * Formats AI response data (personality scores, traits, etc.)\n * @param {Object} apiResponse - The API response containing AI data\n * @returns {Object} Formatted AI data summary\n */\nfunction formatAIResponseData(apiResponse) {\n  if (!apiResponse) {\n    return {\n      available: false,\n      dataTypes: [],\n      summary: 'No AI data available'\n    };\n  }\n\n  const aiData = {\n    available: true,\n    dataTypes: []\n  };\n\n  // Check for Onairos Wrapped Dashboard\n  if (apiResponse.data?.dashboard || apiResponse.dashboard || apiResponse.slides) {\n    aiData.dataTypes.push({\n      type: 'wrapped_dashboard',\n      available: true,\n      data: apiResponse.data?.dashboard || apiResponse.dashboard || apiResponse,\n      summary: 'Onairos Wrapped / Neural Recall Dashboard'\n    });\n    \n    // Add apps if available\n    if (apiResponse.data?.apps || apiResponse.apps) {\n      aiData.dataTypes.push({\n        type: 'connected_apps',\n        available: true,\n        data: apiResponse.data?.apps || apiResponse.apps,\n        summary: `Connected apps list (${(apiResponse.data?.apps || apiResponse.apps).length})`\n      });\n    }\n  }\n\n  // Check for personality data\n  if (apiResponse.InferenceResult?.traits || apiResponse.personalityDict || apiResponse.traits) {\n    const personalityData = {\n      type: 'personality',\n      available: true\n    };\n\n    // If we have dictionary format, use it for better readability\n    if (apiResponse.personalityDict) {\n      personalityData.data = apiResponse.personalityDict;\n      personalityData.summary = `Personality analysis with ${Object.keys(apiResponse.personalityDict).length} traits`;\n    } else if (apiResponse.InferenceResult?.traits) {\n      personalityData.data = apiResponse.InferenceResult.traits;\n      personalityData.summary = `Personality scores array with ${apiResponse.InferenceResult.traits.length} values`;\n    } else if (apiResponse.traits) {\n      personalityData.data = apiResponse.traits;\n      personalityData.summary = `Personality traits with ${Array.isArray(apiResponse.traits) ? apiResponse.traits.length : Object.keys(apiResponse.traits).length} items`;\n    }\n\n    aiData.dataTypes.push(personalityData);\n  }\n\n  // Check for preferences/traits data\n  if (apiResponse.traitResult || apiResponse.traitDict) {\n    const preferencesData = {\n      type: 'preferences',\n      available: true\n    };\n\n    if (apiResponse.traitDict) {\n      preferencesData.data = apiResponse.traitDict;\n      preferencesData.summary = `Preferences analysis with ${Object.keys(apiResponse.traitDict).length} categories`;\n    } else if (apiResponse.traitResult) {\n      preferencesData.data = apiResponse.traitResult;\n      preferencesData.summary = `Trait results with ${Array.isArray(apiResponse.traitResult) ? apiResponse.traitResult.length : Object.keys(apiResponse.traitResult).length} items`;\n    }\n\n    aiData.dataTypes.push(preferencesData);\n  }\n\n  // Check for basic info/output\n  if (apiResponse.InferenceResult?.output || apiResponse.output) {\n    aiData.dataTypes.push({\n      type: 'basic_info',\n      available: true,\n      data: apiResponse.InferenceResult?.output || apiResponse.output,\n      summary: 'Basic user information and insights'\n    });\n  }\n\n  // Create overall summary\n  aiData.summary = aiData.dataTypes.length > 0 \n    ? `AI analysis complete with ${aiData.dataTypes.length} data type(s): ${aiData.dataTypes.map(d => d.type).join(', ')}`\n    : 'AI data structure present but no recognized data types found';\n\n  return aiData;\n}\n\n/**\n * Creates a pretty-printed version for console logging\n * @param {Object} userDataSummary - The formatted user data summary\n * @returns {string} Pretty-printed string for console output\n */\nfunction createPrettyPrintVersion(userDataSummary) {\n  const lines = [];\n  \n  lines.push(' ONAIROS USER DATA SUMMARY');\n  lines.push('=' .repeat(50));\n  \n  // Request Info\n  lines.push('\\n REQUEST INFORMATION:');\n  lines.push(`   App: ${userDataSummary.requestInfo.appName}`);\n  lines.push(`   User: ${userDataSummary.requestInfo.userHash}`);\n  lines.push(`   Mode: ${userDataSummary.requestInfo.testMode ? 'Test' : 'Production'}`);\n  lines.push(`   Data Types: ${Array.isArray(userDataSummary.requestInfo.dataTypesRequested) && userDataSummary.requestInfo.dataTypesRequested.length > 0 ? userDataSummary.requestInfo.dataTypesRequested.join(', ') : 'None'}`);\n  lines.push(`   Timestamp: ${new Date(userDataSummary.requestInfo.timestamp).toLocaleString()}`);\n  \n  // User Profile\n  lines.push('\\n USER PROFILE:');\n  lines.push(`   Email: ${userDataSummary.userProfile.email}`);\n  lines.push(`   Type: ${userDataSummary.userProfile.userType}`);\n  lines.push(`   Onboarding: ${userDataSummary.userProfile.onboardingComplete ? '' : ''}`);\n  lines.push(`   PIN Setup: ${userDataSummary.userProfile.pinCreated ? '' : ''}`);\n  lines.push(`   Training: ${userDataSummary.userProfile.trainingComplete ? '' : ''}`);\n  lines.push(`   Model Ready: ${userDataSummary.userProfile.modelReady ? '' : ''}`);\n  \n  // Connected Accounts\n  lines.push('\\n CONNECTED ACCOUNTS:');\n  lines.push(`   ${userDataSummary.connectedAccounts.summary}`);\n  if (userDataSummary.connectedAccounts.platforms.length > 0) {\n    userDataSummary.connectedAccounts.platforms.forEach(platform => {\n      lines.push(`    ${platform.name}: ${platform.status} ${platform.hasData ? '(has data)' : '(no data)'}`);\n    });\n  }\n  \n  // AI Data\n  lines.push('\\n AI ANALYSIS DATA:');\n  lines.push(`   ${userDataSummary.aiData.summary}`);\n  if (userDataSummary.aiData.dataTypes.length > 0) {\n    userDataSummary.aiData.dataTypes.forEach(dataType => {\n      lines.push(`    ${dataType.type.toUpperCase()}: ${dataType.summary}`);\n    });\n  }\n  \n  // Status\n  lines.push('\\n STATUS:');\n  lines.push(`   Success: ${userDataSummary.status.success ? '' : ''}`);\n  lines.push(`   API Response: ${userDataSummary.status.hasApiResponse ? '' : ''}`);\n  lines.push(`   Errors: ${userDataSummary.status.hasErrors ? ' Yes' : ' None'}`);\n  \n  lines.push('\\n' + '=' .repeat(50));\n  \n  return lines.join('\\n');\n}\n\n/**\n * Console logging helper that prints formatted user data\n * @param {Object} result - The result object from onComplete\n */\nexport function logFormattedUserData(result) {\n  const formatted = formatUserDataForDisplay(result);\n  \n  console.log('\\n' + formatted.prettyPrint + '\\n');\n  \n  // Also log the structured data for programmatic access\n  console.log(' Structured User Data Summary:', formatted.userDataSummary);\n  \n  return formatted;\n}\n\nexport default {\n  formatUserDataForDisplay,\n  logFormattedUserData\n};\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { COLORS } from '../../theme/colors.js';\n\n// Standardized page layout component with white background\nconst PageLayout = ({\n  children,\n  title,\n  subtitle,\n  icon,\n  showHeader = true,\n  showCloseButton = false,\n  onClose,\n  onBack,\n  showBackButton = false,\n  className = '',\n  contentClassName = '',\n  centerContent = true,\n  style = {},\n  ...props\n}) => {\n  const isSmallScreen = typeof window !== 'undefined' && window.innerWidth <= 768;\n\n  const layoutStyle = {\n    backgroundColor: COLORS.background,\n    minHeight: '100%',\n    width: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    ...style\n  };\n\n  const headerStyle = {\n    position: 'sticky',\n    top: 0,\n    backgroundColor: COLORS.background,\n    zIndex: 10,\n    padding: isSmallScreen\n      ? '10px 16px 8px'\n      : 'clamp(8px, 2vw, 16px) clamp(16px, 4vw, 32px) clamp(6px, 1.5vw, 12px)'\n  };\n\n  const contentStyle = {\n    flex: 1,\n    padding: isSmallScreen ? '16px 16px 18px' : 'clamp(16px, 4vw, 32px)',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'auto',\n    minHeight: 0, // Allow flex item to shrink below content size\n    ...(centerContent && {\n      alignItems: 'center',\n      justifyContent: 'flex-start'\n    })\n  };\n\n  const titleStyle = {\n    fontFamily: 'IBM Plex Sans, system-ui, sans-serif',\n    fontSize: 'clamp(20px, 5vw, 28px)',\n    fontWeight: '700',\n    color: COLORS.textPrimary,\n    margin: '0 0 clamp(6px, 1.5vw, 12px) 0',\n    textAlign: centerContent ? 'center' : 'left',\n    lineHeight: '1.2'\n  };\n\n  const subtitleStyle = {\n    fontFamily: 'Inter, system-ui, sans-serif',\n    fontSize: 'clamp(14px, 3.5vw, 18px)',\n    fontWeight: '400',\n    color: COLORS.textSecondary,\n    margin: isSmallScreen ? '0 0 18px 0' : '0 0 clamp(20px, 5vw, 40px) 0',\n    textAlign: centerContent ? 'center' : 'left',\n    lineHeight: '1.5'\n  };\n\n  const iconStyle = {\n    width: 'clamp(40px, 8vw, 56px)',\n    height: 'clamp(40px, 8vw, 56px)',\n    margin: '0 auto clamp(16px, 4vw, 32px)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    fontSize: 'clamp(20px, 5vw, 28px)'\n  };\n\n  return (\n    <div \n      className={`onairos-page-layout ${className}`}\n      style={layoutStyle}\n      {...props}\n    >\n      {/* Header with navigation */}\n      {showHeader && (\n        <div style={headerStyle}>\n          <div className=\"flex items-center justify-between\">\n            {/* Back button */}\n            {showBackButton && onBack && (\n              <button\n                onClick={onBack}\n                className=\"flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 transition-colors\"\n                aria-label=\"Go back\"\n              >\n                <span style={{ fontSize: '16px', color: COLORS.textPrimary }}></span>\n              </button>\n            )}\n\n\n            {/* Close button */}\n            {showCloseButton && onClose && (\n              <button\n                onClick={onClose}\n                className=\"flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 transition-colors\"\n                aria-label=\"Close\"\n              >\n                <span style={{ fontSize: '16px', color: COLORS.textPrimary }}></span>\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Main content area */}\n      <div \n        className={`onairos-page-content ${contentClassName}`}\n        style={contentStyle}\n      >\n        {/* Icon */}\n        {icon && (\n          <div style={iconStyle}>\n            {typeof icon === 'string' ? <span>{icon}</span> : icon}\n          </div>\n        )}\n\n        {/* Title */}\n        {title && (\n          <h1 style={titleStyle}>\n            {title}\n          </h1>\n        )}\n\n        {/* Subtitle */}\n        {subtitle && (\n          <p style={subtitleStyle}>\n            {subtitle}\n          </p>\n        )}\n\n        {/* Page content */}\n        {children}\n      </div>\n    </div>\n  );\n};\n\n// Modal wrapper component for overlay-style pages\nconst ModalPageLayout = ({\n  children,\n  visible = true,\n  onClose,\n  onBackdropClick,\n  backdropStyle = {},\n  modalStyle = {},\n  modalClassName = '',\n  ...pageLayoutProps\n}) => {\n  if (!visible) return null;\n\n  // Detect Capacitor native platform\n  // Must be defined BEFORE usage to avoid Temporal Dead Zone (TDZ) error\n  const isCapacitorNative = typeof window !== 'undefined' && \n    window.Capacitor && \n    typeof window.Capacitor.isNativePlatform === 'function' && \n    window.Capacitor.isNativePlatform();\n    \n  // Detect mobile browser (not Capacitor native)\n  const isMobileBrowser = typeof window !== 'undefined' && \n    window.innerWidth <= 768 && \n    !isCapacitorNative;\n\n  // Use INITIAL window height to avoid modal shrinking when keyboard appears.\n  // We do NOT recalculate on visualViewport resize (keyboard) - that would shrink the modal.\n  const [mobileModalHeightPx, setMobileModalHeightPx] = useState(() => {\n    if (typeof window === 'undefined') return null;\n    if (!isMobileBrowser) return null;\n    // Use window.innerHeight on initial mount (before keyboard)\n    const h = window.innerHeight;\n    return Math.round(h * 0.85);\n  });\n\n  // Only set height ONCE on mount - do NOT update when keyboard appears\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    if (!isMobileBrowser) return;\n    if (mobileModalHeightPx !== null) return; // Already set\n    \n    const h = window.innerHeight;\n    setMobileModalHeightPx(Math.round(h * 0.85));\n  }, [isMobileBrowser, mobileModalHeightPx]);\n    \n  // ENHANCED DEBUG LOGGING for mobile browser height issues\n  if (typeof window !== 'undefined') {\n    console.log('[Onairos SDK][ModalPageLayout] Mobile Detection', {\n      width: window.innerWidth,\n      height: window.innerHeight,\n      isCapacitorNative,\n      isMobileBrowser,\n      modalHeight: isMobileBrowser ? '80vh' : (isCapacitorNative ? '100vh' : 'auto'),\n      modalMaxHeight: isMobileBrowser ? '80vh' : (isCapacitorNative ? '100vh' : '90vh'),\n      modalMaxWidth: isMobileBrowser ? '100%' : '500px',\n      backdropAlign: (isCapacitorNative || isMobileBrowser) ? 'flex-end' : 'center',\n      backdropPadding: isMobileBrowser ? '0' : '16px'\n    });\n  }\n\n  const backdropStyles = {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    zIndex: 2147483647,\n    display: 'flex',\n    alignItems: (isCapacitorNative || isMobileBrowser) ? 'flex-end' : 'center',\n    justifyContent: 'center',\n    padding: isMobileBrowser ? '0' : '16px',\n    transition: 'opacity 200ms ease',\n    willChange: 'opacity',\n    ...backdropStyle\n  };\n  \n  console.log('[Onairos SDK][ModalPageLayout]  Backdrop Styles COMPUTED:', {\n    alignItems: backdropStyles.alignItems,\n    padding: backdropStyles.padding,\n    display: backdropStyles.display,\n    hasBackdropStyleOverride: Object.keys(backdropStyle).length > 0,\n    backdropStyleOverride: backdropStyle\n  });\n  \n  const modalStyles = {\n    backgroundColor: '#FAFAFA', // Updated to match OnairosEvents theme (COLORS.surface)\n    borderTopLeftRadius: '24px',\n    borderTopRightRadius: '24px',\n    borderBottomLeftRadius: (isCapacitorNative || isMobileBrowser) ? '0px' : '24px',\n    borderBottomRightRadius: (isCapacitorNative || isMobileBrowser) ? '0px' : '24px',\n    // Force height on mobile browser with !important via inline style\n    height: isMobileBrowser ? (mobileModalHeightPx ? `${mobileModalHeightPx}px` : '85vh') : (isCapacitorNative ? '100vh' : 'auto'),\n    maxHeight: isMobileBrowser ? (mobileModalHeightPx ? `${mobileModalHeightPx}px` : '85vh') : (isCapacitorNative ? '100vh' : '90vh'),\n    minHeight: (isCapacitorNative || isMobileBrowser) ? 'auto' : '600px',\n    width: '100%',\n    maxWidth: isMobileBrowser ? '100%' : '500px',\n    boxShadow: '0 -10px 40px rgba(0, 0, 0, 0.3)',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column',\n    // iOS safe-area: extend the white modal background into the home-indicator inset\n    ...(isMobileBrowser ? { paddingBottom: 'env(safe-area-inset-bottom)' } : {}),\n    transform: 'translateY(0)',\n    transition: 'transform 220ms ease, opacity 220ms ease',\n    willChange: 'transform, opacity',\n    marginLeft: (isCapacitorNative || isMobileBrowser) ? '0' : 'auto',\n    marginRight: (isCapacitorNative || isMobileBrowser) ? '0' : 'auto',\n    marginBottom: isMobileBrowser ? '0' : 'auto',\n    marginTop: isMobileBrowser ? 'auto' : 'auto',\n    // Ensure full height on Capacitor native\n    ...(isCapacitorNative && {\n      position: 'absolute',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      top: 0,\n      borderRadius: 0\n    }),\n    // Position mobile browser modal at bottom\n    ...(isMobileBrowser && {\n      flexShrink: 0\n    }),\n    // CRITICAL: Do NOT spread modalStyle on mobile browser - it breaks height\n    ...(isMobileBrowser ? {} : modalStyle)\n  };\n  \n  console.log('[Onairos SDK][ModalPageLayout]  Modal Styles COMPUTED:', {\n    height: modalStyles.height,\n    maxHeight: modalStyles.maxHeight,\n    minHeight: modalStyles.minHeight,\n    width: modalStyles.width,\n    maxWidth: modalStyles.maxWidth,\n    borderRadius: `${modalStyles.borderTopLeftRadius} / ${modalStyles.borderBottomLeftRadius}`,\n    hasModalStyleOverride: Object.keys(modalStyle).length > 0,\n    modalStyleWasApplied: isMobileBrowser ? 'NO (blocked for mobile)' : 'YES',\n    modalStyleOverride: modalStyle\n  });\n  \n  // Warn if modalStyle is trying to override on mobile browser\n  if (isMobileBrowser && modalStyle && Object.keys(modalStyle).length > 0) {\n    console.warn('[Onairos SDK][ModalPageLayout]  BLOCKED modalStyle override on mobile browser. Ignoring:', modalStyle);\n  }\n\n  //  Layout debug logging (desktop vs native)\n  try {\n    if (typeof window !== 'undefined') {\n      const width = window.innerWidth;\n      const isDesktop = width >= 1024 && !isCapacitorNative;\n      // Only spam logs in desktop where sizing issues occur\n      if (isDesktop) {\n        // Keep this fairly compact but detailed\n        console.log('[Onairos SDK][Layout][ModalPageLayout]', {\n          width,\n          isCapacitorNative,\n          modalClassName,\n          modalStyleKeys: Object.keys(modalStyle || {}),\n          backdropStyleKeys: Object.keys(backdropStyle || {}),\n          modalMaxWidth: modalStyles.maxWidth,\n          modalMinHeight: modalStyles.minHeight,\n          modalHeight: modalStyles.height,\n        });\n      }\n    }\n  } catch (e) {\n    // Never let logging break rendering\n  }\n\n  const handleBackdropClick = (e) => {\n    if (e.target === e.currentTarget) {\n      console.log(' Backdrop clicked outside modal');\n      if (onBackdropClick) {\n        console.log(' Calling onBackdropClick handler');\n        onBackdropClick();\n      } else if (onClose) {\n        console.log(' Calling onClose handler');\n        onClose();\n      }\n    }\n  };\n\n  // Handle bar style for mobile bottom sheet look\n  const handleStyle = {\n    width: '32px',\n    height: '4px',\n    backgroundColor: '#E5E7EB', // grey-200\n    borderRadius: '2px',\n    margin: '12px auto 8px', // Center horizontally, spacing\n    flexShrink: 0\n  };\n\n  return (\n    <div \n      style={backdropStyles} \n      onClick={handleBackdropClick}\n      data-onairos-backdrop=\"true\"\n      data-mobile-browser={isMobileBrowser ? 'true' : 'false'}\n      data-capacitor-native={isCapacitorNative ? 'true' : 'false'}\n    >\n      <div \n        style={modalStyles} \n        className={modalClassName}\n        onClick={(e) => e.stopPropagation()}\n        data-onairos-modal=\"true\"\n        data-mobile-browser={isMobileBrowser ? 'true' : 'false'}\n        data-modal-height={modalStyles.height}\n      >\n        {/* Mobile Handle Bar */}\n        {(isMobileBrowser || isCapacitorNative) && (\n          <div style={handleStyle} />\n        )}\n\n        <PageLayout\n          showHeader={true}\n          showCloseButton={true}\n          onClose={onClose}\n          {...pageLayoutProps}\n          // Remove default padding on mobile since we have handle bar space\n          style={{ \n            ...(pageLayoutProps.style || {}),\n            ...(isMobileBrowser ? { paddingTop: 0 } : {})\n          }}\n        >\n          {children}\n        </PageLayout>\n      </div>\n    </div>\n  );\n};\n\nexport { ModalPageLayout };\nexport default PageLayout; ","import React, { useEffect, useState } from 'react';\nimport { App } from '@capacitor/app';\nimport { Browser } from '@capacitor/browser';\nimport WelcomeScreen from './components/WelcomeScreen.jsx';\nimport EmailAuth from './components/EmailAuth.js';\nimport UniversalOnboarding from './components/UniversalOnboarding.jsx';\nimport PinSetup from './components/PinSetup.js';\nimport DataRequest from './components/DataRequest.js';\nimport TrainingComponent from './components/TrainingComponent.jsx';\nimport TrainingScreen from './components/TrainingScreen.jsx';\nimport LoadingScreen from './components/LoadingScreen.jsx';\nimport WrappedLoadingPage from './components/WrappedLoadingPage.jsx';\nimport { formatOnairosResponse } from './utils/responseFormatter.js';\nimport { logFormattedUserData } from './utils/userDataFormatter.js';\nimport { ModalPageLayout } from './components/ui/PageLayout.jsx';\nimport { isMobileApp, isMobileBrowser } from './utils/capacitorDetection.js';\n\nexport function OnairosButton({\n  requestData, \n  webpageName, \n  inferenceData = null, \n  onComplete = null, \n  autoFetch = true, // Auto-enabled for seamless testing experience\n  testMode = false, // Production mode by default - set to true for testing\n  proofMode = false, \n  textLayout = 'below', \n  textColor = 'white',\n  login = false,\n  buttonType = 'pill',\n  loginReturn = null,\n  loginType = 'signIn',\n  visualType = 'full',\n  appIcon = null,\n  enableTraining = true,\n  formatResponse = true,\n  responseFormat = { includeDictionary: true, includeArray: true },\n  priorityPlatform = null, // Platform to prioritize (e.g., 'gmail', 'pinterest', 'linkedin')\n  rawMemoriesOnly = false, // Show only LLM connections when true\n  rawMemoriesConfig = null, // Configuration for RAW memories collection\n  time = false // Show time frequency slider (default: false)\n}) {\n\n  const [showOverlay, setShowOverlay] = useState(false);\n  const [currentFlow, setCurrentFlow] = useState('welcome'); // 'welcome' | 'email' | 'onboarding' | 'pin' | 'trainingScreen' | 'dataRequest' | 'wrappedLoading'\n  const [trainingHasStarted, setTrainingHasStarted] = useState(false);\n  const [userData, setUserData] = useState(null);\n  const [error, setError] = useState(null);\n  const [oauthReturnDetected, setOauthReturnDetected] = useState(false);\n  const [returnToDataRequestAfterOnboarding, setReturnToDataRequestAfterOnboarding] = useState(false);\n  \n  // Detect mobile for conditional styling (MOBILE ONLY changes)\n  // Use a safer check that doesn't rely on window/navigator being immediately available\n  const [isMobileDevice, setIsMobileDevice] = useState(false);\n  \n  useEffect(() => {\n    // Determine mobile vs desktop based on viewport width + native runtime,\n    // and keep it updated on resize.\n    const computeMobile = () => {\n      try {\n        const hasWindow = typeof window !== 'undefined';\n        if (!hasWindow) {\n          setIsMobileDevice(false);\n          return;\n        }\n\n        // Base width from current window\n        let width = window.innerWidth || document.documentElement?.clientWidth || document.body?.clientWidth || 0;\n\n        // If running inside an iframe, try to use the parent window width as well\n        // so desktop pages embedding the SDK don't get misclassified as mobile.\n        try {\n          if (window.parent && window.parent !== window && window.parent.innerWidth) {\n            width = Math.max(width, window.parent.innerWidth);\n          }\n        } catch (_) {\n          // Cross-origin access can fail; ignore and fall back to local width.\n        }\n\n        const isCapNative = !!window.Capacitor?.isNativePlatform?.();\n\n        //  Final, explicit rule:\n        // - Capacitor native: ALWAYS mobile\n        // - Otherwise: viewport < 1024px (taking parent if available)  mobile; >= 1024px  desktop\n        const detectedMobile = isCapNative || width < 1024;\n\n        console.log('[Onairos SDK][Layout][MobileDetection simple]', {\n          width,\n          isCapNative,\n          detectedMobile,\n        });\n\n        setIsMobileDevice(detectedMobile);\n      } catch (e) {\n        setIsMobileDevice(false);\n      }\n    };\n\n    computeMobile();\n\n    // Desktop resize listener to keep classification accurate when user resizes window.\n    // This runs in all environments, but the rule above ensures iPhone/Capacitor\n    // keep their correct classification.\n    if (typeof window !== 'undefined') {\n      window.addEventListener('resize', computeMobile);\n      return () => window.removeEventListener('resize', computeMobile);\n    }\n  }, []);\n\n  // Lock background scroll on DESKTOP while modal is open (do not touch mobile/Capacitor)\n  useEffect(() => {\n    if (typeof document === 'undefined') return;\n\n    const body = document.body;\n    if (!body) return;\n\n    if (showOverlay && !isMobileDevice) {\n      // Remember previous overflow so we can restore it precisely\n      if (!body.dataset.onairosPrevOverflow) {\n        body.dataset.onairosPrevOverflow = body.style.overflow || '';\n      }\n      body.style.overflow = 'hidden';\n    } else {\n      // Restore previous overflow when modal closes or when switching back to mobile\n      if (body.dataset.onairosPrevOverflow !== undefined) {\n        body.style.overflow = body.dataset.onairosPrevOverflow;\n        delete body.dataset.onairosPrevOverflow;\n      }\n    }\n  }, [showOverlay, isMobileDevice]);\n\n  //  High-level layout debug for desktop vs mobile\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const width = window.innerWidth;\n    const isDesktop = width >= 1024 && !isMobileDevice;\n    console.log('[Onairos SDK][Layout][OnairosButton state]', {\n      width,\n      isDesktop,\n      isMobileDevice,\n      currentFlow,\n      showOverlay,\n    });\n  }, [isMobileDevice, currentFlow, showOverlay]);\n\n  //  DOM-level layout debug (only on desktop web)\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const width = window.innerWidth;\n    const isDesktopWeb = width >= 1024 && !isMobileDevice && !window.Capacitor?.isNativePlatform?.();\n    if (!isDesktopWeb || !showOverlay) return;\n\n    // Defer to allow React layout to flush\n    const id = window.setTimeout(() => {\n      try {\n        const modal = document.querySelector('.onairos-modal');\n        const pageContent = document.querySelector('.onairos-page-content');\n        const shell = document.querySelector('.onairos-modal-shell');\n\n        const getMetrics = (el) => {\n          if (!el) return null;\n          const rect = el.getBoundingClientRect();\n          const styles = window.getComputedStyle(el);\n          return {\n            width: rect.width,\n            height: rect.height,\n            maxWidth: styles.maxWidth,\n            paddingInline: styles.paddingLeft + ' / ' + styles.paddingRight,\n            classList: Array.from(el.classList || []),\n          };\n        };\n\n        console.log('[Onairos SDK][Layout][DOM snapshot]', {\n          currentFlow,\n          viewportWidth: width,\n          modal: getMetrics(modal),\n          pageContent: getMetrics(pageContent),\n          shell: getMetrics(shell),\n        });\n      } catch (e) {\n        console.log('[Onairos SDK][Layout][DOM snapshot] failed', e?.message);\n      }\n    }, 0);\n\n    return () => window.clearTimeout(id);\n  }, [currentFlow, showOverlay, isMobileDevice]);\n  \n  // Logic to process return URLs (Login & Connectors)\n  const handleDeepLink = (url) => {\n      try {\n        console.log(' Checking URL for OAuth return:', url);\n        \n        // Normalize URL to check for params\n        // For native apps, url might be 'mobiletest://oauth-callback?success=true...'\n        // Also check specifically for Reddit's return format or other providers\n        const hasSuccess = url.includes('success=true') || \n                          url.includes('onairos_oauth_success=true') ||\n                          (url.includes('state=') && url.includes('code='));\n        \n        const hasError = url.includes('error=') || url.includes('onairos_oauth_error=');\n        const isPopup = url.includes('is_popup=true'); // Check for our custom flag\n        \n        // Safety Check: If we are running inside a popup or iframe (desktop), we should close ourselves\n        // and notify the parent. This happens if the callback redirected instead of closing.\n        // We check for window.opener, parent!=window, OR our explicit is_popup flag\n        if ((hasSuccess || hasError) && typeof window !== 'undefined' && \n            (window.opener || window.parent !== window || isPopup)) {\n             console.log(' App loaded inside OAuth popup/iframe (detected via opener/parent/flag) - closing');\n             \n             // Extract params for storage/message\n             let params;\n             try {\n                const qIdx = url.indexOf('?');\n                if (qIdx !== -1) params = new URLSearchParams(url.substring(qIdx + 1));\n                else params = new URL(url).searchParams;\n             } catch(e) { params = new URLSearchParams(''); }\n             \n             const platform = params.get('platform') || params.get('onairos_oauth_platform');\n             const email = params.get('email') || params.get('onairos_oauth_email');\n             \n             // 1. Write to LocalStorage (Same Origin as Parent) - Primary mechanism for cross-origin flow fallback\n             if (hasSuccess && platform) {\n                 localStorage.setItem(`onairos_${platform}_success`, 'true');\n                 localStorage.setItem(`onairos_${platform}_timestamp`, Date.now().toString());\n                 if (email) localStorage.setItem(`onairos_${platform}_email`, email);\n             }\n             \n             // 2. Try postMessage (only works if opener exists)\n             try {\n                const target = window.opener || window.parent;\n                if (target) {\n                    target.postMessage({\n                        type: hasSuccess ? 'oauth-success' : 'oauth-error',\n                        platform: platform,\n                        email: email,\n                        error: params.get('error'),\n                        success: !!hasSuccess\n                    }, '*');\n                }\n             } catch (e) {}\n\n             // 3. Close window\n             window.close();\n             // If window.close() is blocked (scripts can't close windows they didn't open),\n             // show a message asking user to close.\n             setTimeout(() => {\n                 document.body.innerHTML = '<div style=\"display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column;font-family:sans-serif;\"><h1>Success!</h1><p>You can close this window now.</p><button onclick=\"window.close()\" style=\"padding:10px 20px;margin-top:20px;cursor:pointer;\">Close Window</button></div>';\n             }, 500);\n             \n             return; // Stop execution here\n        }\n        \n        if (hasSuccess) {\n           console.log(' Deep link/OAuth return detected:', url);\n           \n           // Close browser if open (Capacitor) - Important for Native\n           Browser.close().catch(() => {});\n\n           // Extract params from URL\n           let params;\n           try {\n             // Handle custom schemes that URL() constructor might reject if not fully standard\n             const questionMarkIndex = url.indexOf('?');\n             if (questionMarkIndex !== -1) {\n                params = new URLSearchParams(url.substring(questionMarkIndex + 1));\n             } else {\n                params = new URL(url).searchParams;\n             }\n           } catch (e) {\n             console.warn('URL parsing failed, trying fallback split:', e);\n             params = new URLSearchParams(url.split('?')[1] || '');\n           }\n\n           let platform = params.get('platform') || params.get('onairos_oauth_platform') || 'google';\n           let email = params.get('email') || params.get('onairos_oauth_email');\n           \n           // Fallback for Reddit/others that might rely on state\n           if (!platform || platform === 'null') {\n              const state = params.get('state');\n              if (state) {\n                 try {\n                    // Try to decode state if it's base64\n                    const decoded = JSON.parse(atob(state));\n                    if (decoded.connectionType) platform = decoded.connectionType;\n                    if (decoded.username) email = decoded.username; // Sometimes username is email\n                 } catch (e) {\n                    console.log('State decoding failed (not base64 JSON or invalid)');\n                 }\n              }\n           }\n\n           if (email) email = decodeURIComponent(email);\n           \n           console.log(` Detected return from ${platform} for ${email || 'unknown user'}`);\n           \n           // Set state to restore flow\n           setOauthReturnDetected(true);\n           \n           // 1. SUPPORT UNIVERSAL ONBOARDING (YouTube, LinkedIn, Reddit, etc.)\n           sessionStorage.setItem('onairos_oauth_return_success', 'true');\n           sessionStorage.setItem('onairos_oauth_return_platform', platform);\n\n           // Dispatch event to update UI immediately if component is mounted\n           if (typeof window !== 'undefined') {\n             window.dispatchEvent(new CustomEvent('onairos-oauth-success', { \n               detail: { platform: platform, email: email } \n             }));\n           }\n           \n           if (platform) {\n             localStorage.setItem(`onairos_${platform}_success`, 'true');\n             localStorage.setItem(`onairos_${platform}_timestamp`, Date.now().toString());\n           }\n\n           // 2. SUPPORT EMAIL AUTH (Gmail)\n           if (platform === 'google' || platform === 'gmail') {\n             localStorage.setItem('onairos_gmail_success', 'true');\n             localStorage.setItem('onairos_gmail_timestamp', Date.now().toString());\n             if (email) localStorage.setItem('onairos_gmail_email', email);\n           }\n           \n           // Restore session if possible (only for Login flow really, but safe to update)\n           if (email) {\n             // MERGE with existing userData to preserve connectedAccounts\n             const existingUserData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n             const userData = {\n                ...existingUserData, // Preserve existing data (like connectedAccounts)\n                email: email,\n                verified: true,\n                onboardingComplete: false,\n                provider: platform\n             };\n             console.log(' Merging OAuth return with existing userData:', { existing: existingUserData.connectedAccounts, merged: userData.connectedAccounts });\n             localStorage.setItem('onairosUser', JSON.stringify(userData));\n             setUserData(userData);\n           }\n           \n           // Open modal and go to onboarding immediately\n           setShowOverlay(true);\n           setCurrentFlow('onboarding');\n           \n           // Clean up URL if possible (on web)\n           if (window.history && window.history.replaceState && url.startsWith('http')) {\n             const cleanUrl = window.location.pathname;\n             window.history.replaceState({}, '', cleanUrl);\n           }\n        }\n      } catch (e) {\n        console.error('Error handling deep link:', e);\n      }\n  };\n\n  // Native Deep Link Listener (Runs once, stays active)\n  useEffect(() => {\n    let appListener = null;\n    const setupListener = async () => {\n      // Only run on native platforms (iOS/Android)\n      const isNative = typeof window !== 'undefined' && window.Capacitor?.isNativePlatform?.();\n      if (!isNative) return;\n\n      let AppPlugin = App;\n      if (!AppPlugin || !AppPlugin.addListener) {\n        if (typeof window !== 'undefined' && window.Capacitor?.Plugins?.App) {\n          AppPlugin = window.Capacitor.Plugins.App;\n        }\n      }\n\n      if (!AppPlugin || !AppPlugin.addListener) {\n         console.warn(' App plugin not found for deep linking listener');\n         return;\n      }\n\n      try {\n        appListener = await AppPlugin.addListener('appUrlOpen', (data) => {\n          console.log(' Native deep link received:', data.url);\n          handleDeepLink(data.url);\n        });\n        console.log(' App deep link listener registered successfully');\n      } catch (e) {\n        console.warn(' Failed to setup App listener:', e);\n      }\n    };\n    setupListener();\n    \n    return () => {\n      if (appListener) appListener.remove();\n    };\n  }, []);\n\n  // Web/Initial Check (Respects oauthReturnDetected)\n  useEffect(() => {\n    if (oauthReturnDetected) return;\n    \n    handleDeepLink(window.location.href);\n    \n    const checkWindowUrl = () => handleDeepLink(window.location.href);\n    window.addEventListener('popstate', checkWindowUrl);\n    \n    return () => window.removeEventListener('popstate', checkWindowUrl);\n  }, [oauthReturnDetected]);\n\n  // Check for existing user session\n  useEffect(() => {\n    const checkExistingSession = () => {\n      // In test mode, always start fresh to see the full flow\n      if (testMode) {\n        console.log(' Test mode: Starting fresh flow, clearing any cached user data');\n        localStorage.removeItem('onairosUser');\n        setCurrentFlow('welcome');\n        return;\n      }\n      \n      // If we just kicked off an OAuth connector flow, force return into onboarding\n      // so users can connect multiple apps without getting bounced to DataRequest.\n      const postOAuthFlow = (() => {\n        try { return localStorage.getItem('onairos_post_oauth_flow'); } catch { return null; }\n      })();\n      if (postOAuthFlow === 'onboarding') {\n        try { localStorage.removeItem('onairos_post_oauth_flow'); } catch {}\n        const savedUser = localStorage.getItem('onairosUser');\n        if (savedUser) {\n          try { setUserData(JSON.parse(savedUser)); } catch {}\n        }\n        setShowOverlay(true);\n        setCurrentFlow('onboarding');\n        return;\n      }\n      \n      const savedUser = localStorage.getItem('onairosUser');\n      if (savedUser) {\n        try {\n          const user = JSON.parse(savedUser);\n          setUserData(user);\n          // If user has completed onboarding and PIN setup, go directly to data request\n          if (user.onboardingComplete && user.pinCreated) {\n            setCurrentFlow('dataRequest');\n          } else if (user.verified && !user.onboardingComplete) {\n            setCurrentFlow('onboarding');\n          } else if (user.onboardingComplete && !user.pinCreated) {\n            setCurrentFlow('pin');\n          }\n        } catch (error) {\n          console.error('Error parsing saved user data:', error);\n          localStorage.removeItem('onairosUser');\n        }\n      }\n    };\n\n    checkExistingSession();\n  }, [testMode]);\n\n  // Check for OAuth return (Google login redirect back)\n  useEffect(() => {\n    if (oauthReturnDetected) return; // Prevent double-processing\n    \n    const checkOAuthReturn = () => {\n      // Check URL params for OAuth completion\n      const urlParams = new URLSearchParams(window.location.search);\n      const oauthSuccess = urlParams.get('onairos_oauth_success');\n      const oauthPlatform = urlParams.get('onairos_oauth_platform');\n      const oauthEmail = urlParams.get('onairos_oauth_email');\n\n      // Check for generic OAuth return (any platform)\n      if (oauthSuccess === 'true' && oauthPlatform) {\n        setOauthReturnDetected(true);\n        \n        // Clean up URL\n        const newUrl = window.location.pathname;\n        window.history.replaceState({}, '', newUrl);\n        \n        if (oauthPlatform === 'gmail' && oauthEmail) {\n          console.log(' Gmail OAuth return detected in URL params');\n          \n          // Create user data from OAuth\n          const authData = {\n            email: oauthEmail,\n            verified: true,\n            isNewUser: true, // Assume new user for now, backend will correct this\n            provider: 'google'\n          };\n          \n          // Save to localStorage - MERGE with existing to preserve connectedAccounts\n          const existingUserData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n          const userData = {\n            ...existingUserData, // Preserve existing data (like connectedAccounts)\n            email: oauthEmail,\n            verified: true,\n            onboardingComplete: false,\n            provider: 'google'\n          };\n          console.log(' Merging Google OAuth with existing userData:', { existing: existingUserData.connectedAccounts, merged: userData.connectedAccounts });\n          localStorage.setItem('onairosUser', JSON.stringify(userData));\n          setUserData(userData);\n          \n          // Open modal and go to onboarding\n          setShowOverlay(true);\n          setCurrentFlow('onboarding');\n          \n          // Clean up OAuth localStorage\n          localStorage.removeItem('onairos_gmail_success');\n          localStorage.removeItem('onairos_gmail_timestamp');\n          localStorage.removeItem('onairos_oauth_email');\n          localStorage.removeItem('onairos_return_url');\n          localStorage.removeItem('onairos_oauth_context');\n          \n        } else {\n          // Other platforms (Universal Onboarding connectors)\n          console.log(` ${oauthPlatform} OAuth return detected - restoring onboarding flow`);\n          \n          // Ensure we have user session to show the modal correctly\n          // (User should already be logged in if they were connecting apps)\n          const savedUser = localStorage.getItem('onairosUser');\n          if (savedUser) {\n            setUserData(JSON.parse(savedUser));\n          }\n          \n          // Open modal and restore flow\n          setShowOverlay(true);\n          setCurrentFlow('onboarding');\n          \n          // Pass the success signal to UniversalOnboarding via a temporary storage flag\n          // that works even if cross-domain cleared the original context\n          sessionStorage.setItem('onairos_oauth_return_success', 'true');\n          sessionStorage.setItem('onairos_oauth_return_platform', oauthPlatform);\n        }\n        \n        return;\n      }\n\n      // Also check localStorage for OAuth completion (fallback)\n      const gmailSuccess = localStorage.getItem('onairos_gmail_success');\n      const gmailTimestamp = localStorage.getItem('onairos_gmail_timestamp');\n      const gmailEmail = localStorage.getItem('onairos_gmail_email') || localStorage.getItem('onairos_oauth_email');\n\n      if (gmailSuccess === 'true' && gmailTimestamp && gmailEmail) {\n        const now = Date.now();\n        const timestamp = parseInt(gmailTimestamp, 10);\n        \n        // Only process if timestamp is recent (within last 60 seconds)\n        if (now - timestamp < 60000) {\n          console.log(' Gmail OAuth return detected in localStorage');\n          setOauthReturnDetected(true);\n          \n          // Create user data from OAuth - MERGE with existing to preserve connectedAccounts\n          const existingUserData = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n          const userData = {\n            ...existingUserData, // Preserve existing data (like connectedAccounts)\n            email: gmailEmail,\n            verified: true,\n            onboardingComplete: false,\n            provider: 'google'\n          };\n          console.log(' Merging Gmail OAuth with existing userData:', { existing: existingUserData.connectedAccounts, merged: userData.connectedAccounts });\n          localStorage.setItem('onairosUser', JSON.stringify(userData));\n          setUserData(userData);\n          \n          // Open modal and go to onboarding\n          setShowOverlay(true);\n          setCurrentFlow('onboarding');\n          \n          // Clean up OAuth localStorage\n          localStorage.removeItem('onairos_gmail_success');\n          localStorage.removeItem('onairos_gmail_timestamp');\n          localStorage.removeItem('onairos_gmail_email');\n          localStorage.removeItem('onairos_oauth_email');\n          localStorage.removeItem('onairos_return_url');\n          localStorage.removeItem('onairos_oauth_context');\n        }\n      }\n    };\n\n    checkOAuthReturn();\n  }, [oauthReturnDetected]);\n\n  const openTerminal = async () => {\n    try {\n      console.log(' openTerminal called - resetting flow');\n      console.log(' testMode prop:', testMode);\n      console.log(' window.onairosApiKey:', window.onairosApiKey);\n      // ALWAYS reset flow on open to start fresh every time\n      setCurrentFlow('welcome');\n      setUserData(null);\n      try { localStorage.removeItem('onairosUser'); } catch {}\n        setShowOverlay(true);\n    } catch (error) {\n      console.error('Error in openTerminal:', error);\n    }\n  };\n\n  const handleCloseOverlay = () => {\n    setShowOverlay(false);\n    setError(null);\n    // Reset flow and session so next open starts fresh\n    setCurrentFlow('welcome');\n    try { localStorage.removeItem('onairosUser'); } catch {}\n    setUserData(null);\n  };\n\n  // Handle clicks on the backdrop to close modal\n  const handleBackdropClick = (e) => {\n    if (e.target === e.currentTarget) {\n      handleCloseOverlay();\n    }\n  };\n\n  const handleWelcomeContinue = () => {\n    console.log(' Welcome screen continue clicked');\n    setCurrentFlow('email');\n  };\n\n  const handleEmailAuthSuccess = (authData) => {\n    console.log(' Email auth successful:', authData);\n    console.log(' User State:', {\n      isNewUser: authData.isNewUser,\n      userState: authData.userState,\n      flowType: authData.flowType,\n      existingUser: authData.existingUser,\n      hasAccountInfo: !!authData.accountInfo,\n      accountStatus: authData.accountStatus // NEW: Log accountStatus\n    });\n\n    // Save identity-bearing JWT immediately (email/id/userId/sub)\n    try {\n      const candidate = authData.jwtToken || authData.token || authData.accessToken;\n      if (candidate) {\n        const base64 = candidate.split('.')[1];\n        if (base64) {\n          const payload = JSON.parse(decodeURIComponent(atob(base64).split('').map(c => '%'+('00'+c.charCodeAt(0).toString(16)).slice(-2)).join('')));\n          if (payload && (payload.email || payload.id || payload.userId || payload.sub)) {\n            try { localStorage.setItem('onairos_user_token', candidate); } catch {}\n            console.log(' [OnairosButton] Identity JWT saved from email auth');\n          } else {\n            console.warn(' [OnairosButton] Email auth returned minimal token (no id/email)');\n          }\n        }\n      }\n    } catch (e) {\n      console.warn(' [OnairosButton] Failed to parse/save email auth token');\n    }\n    \n    // NEW: Use accountStatus if available (more reliable than legacy fields)\n    const accountStatus = authData.accountStatus;\n    let isNewUser;\n    \n    if (accountStatus) {\n      // Use the new accountStatus.exists field as the source of truth\n      isNewUser = !accountStatus.exists;\n      console.log(' Using accountStatus.exists for flow determination:', {\n        accountExists: accountStatus.exists,\n        hasTrainedModel: accountStatus.hasTrainedModel,\n        hasPersonalityTraits: accountStatus.hasPersonalityTraits,\n        connectedPlatforms: accountStatus.connectedPlatforms,\n        needsDataConnection: accountStatus.needsDataConnection,\n        needsTraining: accountStatus.needsTraining,\n        canUseInference: accountStatus.canUseInference\n      });\n    } else {\n      // Fallback to legacy field checking if accountStatus not available\n      isNewUser = authData.isNewUser === true || \n                  authData.existingUser === false || \n                  authData.flowType === 'onboarding' || \n                  authData.userState === 'new' ||\n                  !authData.accountInfo;\n      console.log(' Using legacy fields for flow determination (accountStatus not available)');\n    }\n    \n    console.log(' Flow determination:', {\n      finalDecision: isNewUser ? 'NEW USER  onboarding (data connectors)' : 'EXISTING USER  dataRequest (data permissions)',\n      reasoning: {\n        usingAccountStatus: !!accountStatus,\n        accountExists: accountStatus?.exists,\n        isNewUser: authData.isNewUser,\n        existingUserFalse: authData.existingUser === false,\n        flowTypeOnboarding: authData.flowType === 'onboarding',\n        noAccountInfo: !authData.accountInfo\n      }\n    });\n    \n    const newUserData = {\n      ...authData,\n      verified: true,\n      onboardingComplete: !isNewUser, // New users need onboarding, returning users have completed it\n      pinCreated: !isNewUser // Assume returning users have PIN, new users need to create it\n    };\n\n    // If backend provides connected platforms for existing users, carry them into connectedAccounts\n    // so DataRequest/Onboarding can reflect what is already connected.\n    const normalizePlatformName = (p) => {\n      const key = String(p || '').trim().toLowerCase();\n      const map = {\n        instagram: 'Instagram',\n        youtube: 'YouTube',\n        linkedin: 'LinkedIn',\n        reddit: 'Reddit',\n        pinterest: 'Pinterest',\n        github: 'GitHub',\n        gmail: 'Gmail',\n        twitter: 'Twitter',\n        x: 'Twitter',\n        chatgpt: 'ChatGPT',\n        claude: 'Claude',\n        gemini: 'Gemini',\n        grok: 'Grok',\n      };\n      return map[key] || (key ? key.charAt(0).toUpperCase() + key.slice(1) : '');\n    };\n    if (!isNewUser) {\n      const fromAccountStatus = Array.isArray(accountStatus?.connectedPlatforms)\n        ? accountStatus.connectedPlatforms\n        : [];\n      const normalized = fromAccountStatus.map(normalizePlatformName).filter(Boolean);\n      if (normalized.length > 0) {\n        newUserData.connectedAccounts = normalized;\n      }\n    } else {\n      // New user: never pre-populate connected apps.\n      // This prevents stale local state from previous sessions from auto-toggling connectors.\n      newUserData.connectedAccounts = [];\n    }\n    \n    // Ensure token is stored in userData and localStorage\n    const emailToken = authData.token || authData.jwtToken || authData.accessToken;\n    if (emailToken) {\n      newUserData.token = emailToken;\n      try {\n        localStorage.setItem('onairos_user_token', emailToken);\n        console.log(' Token from email verification saved to localStorage');\n      } catch (e) {\n        console.warn(' Could not save token to localStorage:', e);\n      }\n    }\n    \n    setUserData(newUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(newUserData));\n    \n    // Flow decision logic:\n    // - New users: go to UniversalOnboarding (connectors)\n    // - Existing users: go straight to DataRequest (data permissions)\n    if (isNewUser) {\n      console.log(' Auth successful (new user)  Starting onboarding flow (data connectors page)');\n    setCurrentFlow('onboarding');\n    } else {\n      console.log(' Auth successful (existing user)  Going straight to DataRequest (data permissions)');\n      setCurrentFlow('dataRequest');\n    }\n  };\n\n  const handleOnboardingComplete = (onboardingData) => {\n    console.log(' Onboarding completed:', onboardingData);\n    console.log(' Connected accounts from onboarding:', onboardingData.connectedAccounts);\n    const updatedUserData = {\n      ...userData,\n      onboardingComplete: true,\n      connectedAccounts: onboardingData.connectedAccounts || []\n    };\n    console.log(' Saving userData with connectedAccounts:', updatedUserData.connectedAccounts);\n    setUserData(updatedUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(updatedUserData));\n    if (returnToDataRequestAfterOnboarding) {\n      setReturnToDataRequestAfterOnboarding(false);\n      setCurrentFlow('dataRequest');\n    } else {\n    setCurrentFlow('pin');\n    }\n  };\n\n  const handlePinSetupComplete = async (pinData) => {\n    console.log('PIN setup completed:', pinData);\n    const updatedUserData = {\n      ...userData,\n      ...pinData,\n      pinCreated: true\n    };\n    setUserData(updatedUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(updatedUserData));\n    \n    // Check if this is a wrapped app\n    const isWrappedApp = webpageName && webpageName.toLowerCase().includes('wrapped');\n    \n    if (isWrappedApp) {\n      // Wrapped apps skip training screen - go directly to data request\n      console.log(' Wrapped app - skipping training screen, going to data request');\n      setCurrentFlow('dataRequest');\n    } else {\n      // Non-wrapped apps show training screen BEFORE data request\n      console.log(' Non-wrapped app - showing training screen');\n      // Reset training start watchdog state\n      setTrainingHasStarted(false);\n      setCurrentFlow('trainingScreen');\n    }\n  };\n\n  // Non-wrapped ONLY: if training does not START within 30s, move forward to DataRequest anyway.\n  // Wrapped apps must NOT do this.\n  useEffect(() => {\n    const isWrappedApp = webpageName && webpageName.toLowerCase().includes('wrapped');\n    if (isWrappedApp) return;\n\n    if (currentFlow !== 'trainingScreen') return;\n    if (trainingHasStarted) return;\n\n    const timeoutId = setTimeout(() => {\n      // Re-check conditions at fire time (effect cleanup should handle most cases).\n      const stillWrapped = webpageName && webpageName.toLowerCase().includes('wrapped');\n      if (stillWrapped) return;\n      if (currentFlow === 'trainingScreen' && !trainingHasStarted) {\n        console.warn(' Training did not start within 30s (non-wrapped). Continuing to DataRequest.');\n        setCurrentFlow('dataRequest');\n      }\n    }, 30000);\n\n    return () => clearTimeout(timeoutId);\n  }, [currentFlow, trainingHasStarted, webpageName]);\n\n  const handleLoadingComplete = () => {\n    setCurrentFlow('dataRequest');\n  };\n\n  const handleTrainingComplete = (trainingResult) => {\n    console.log(' Training completed:', trainingResult);\n    const updatedUserData = {\n      ...userData,\n      trainingCompleted: true,\n      ...trainingResult\n    };\n    setUserData(updatedUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(updatedUserData));\n    \n    // Move to data request after training\n    setCurrentFlow('dataRequest');\n  };\n\n  const handleTrainingScreenComplete = (trainingResult) => {\n    console.log(' Training screen completed:', trainingResult);\n    const updatedUserData = {\n      ...userData,\n      trainingCompleted: true,\n      ...trainingResult\n    };\n    setUserData(updatedUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(updatedUserData));\n    \n    // Move to data request after training screen\n    setCurrentFlow('dataRequest');\n  };\n\n  const handleDataRequestComplete = async (requestResult) => {\n    console.log(' OnairosButton: Data request completed:', requestResult);\n    \n    // Check if this is a wrapped app\n    const isWrappedApp = webpageName && webpageName.toLowerCase().includes('wrapped');\n    \n    // For non-wrapped apps, training and inference already happened in TrainingScreen\n    // No need to run it again here\n    if (!isWrappedApp && requestResult.approved?.length > 0) {\n      console.log(' Non-wrapped app: Training and inference already completed in TrainingScreen');\n      console.log(' Data approval recorded:', requestResult.approved);\n    }\n    \n    // Update user data with request result\n    const updatedUserData = {\n      ...userData,\n      lastDataRequest: requestResult\n    };\n    setUserData(updatedUserData);\n    localStorage.setItem('onairosUser', JSON.stringify(updatedUserData));\n\n    // Handle data fetching if autoFetch is enabled\n    // For non-wrapped apps, training already happened in TrainingScreen, so skip this\n    let finalResult = requestResult;\n    \n    if (autoFetch && requestResult.approved?.length > 0 && isWrappedApp) {\n      console.log(' Auto-fetching data from Onairos API for wrapped app...');\n      \n      try {\n        // 1. Get the API URL from the backend\n        const urlResponse = await fetch('https://api2.onairos.uk/getAPIurlMobile', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            Info: {\n              appId: webpageName,\n              account: userData?.email || userData?.username,\n              confirmations: requestResult.approved.map(id => ({ data: id === 'personality' ? 'Large' : id === 'basic' ? 'Basic' : id })),\n              EncryptedUserPin: userData?.EncryptedUserPin || 'pending_pin_integration',\n              storage: 's3',\n              proofMode: proofMode\n            }\n          })\n        });\n\n        const urlData = await urlResponse.json();\n        console.log(' API URL received:', urlData.apiUrl);\n        console.log(' webpageName sent as appId:', webpageName);\n\n        if (urlData.apiUrl && urlData.token) {\n          // Only show wrapped loading page if app name contains \"wrapped\"\n          const isWrappedApp = webpageName && webpageName.toLowerCase().includes('wrapped');\n          console.log(' Is wrapped app?', isWrappedApp, '(checking:', webpageName, ')');\n          if (isWrappedApp) {\n            setCurrentFlow('wrappedLoading');\n            console.log(' Showing wrapped loading screen for wrapped app');\n          } else {\n            console.log(' Skipping loading screen - not a wrapped app');\n          }\n          \n          // Emit custom event for host app\n          if (typeof window !== 'undefined') {\n            const eventDetail = { apiUrl: urlData.apiUrl, approved: requestResult.approved };\n            window.dispatchEvent(new CustomEvent('onairos-api-call-start', { detail: eventDetail }));\n            console.log(' Emitted onairos-api-call-start event');\n          }\n          \n          // 2. Fetch the actual data\n          // IMPORTANT: This endpoint can take 1-3 minutes as it runs Python LLM scripts\n          // We MUST wait for the actual response before proceeding\n          // Always use POST for consistency and to support body data\n          // traits-only endpoint requires POST\n          const method = 'POST';\n          \n          let fetchUrl = urlData.apiUrl;\n          let fetchBody = {\n             email: userData?.email,\n             includeLlmData: requestResult.approved.includes('rawMemories')\n          };\n\n          // Override for non-wrapped apps (Regular SDK training) to use Training API\n          if (!isWrappedApp) {\n             fetchUrl = 'https://api2.onairos.uk/mobile-training/clean';\n             \n             // Construct training body\n             const connected = [];\n             if (userData?.connectedAccounts) {\n               if (Array.isArray(userData.connectedAccounts)) {\n                 connected.push(...userData.connectedAccounts);\n               } else if (typeof userData.connectedAccounts === 'object') {\n                 connected.push(...Object.keys(userData.connectedAccounts).filter(k => userData.connectedAccounts[k]));\n               }\n             }\n             \n             fetchBody = {\n               Info: {\n                 username: userData?.email || userData?.username,\n                 connectedPlatforms: connected\n               }\n             };\n             \n             console.log(' Switching to Training API for non-wrapped app:', fetchUrl);\n          } else {\n             console.log(' WRAPPED APP DETECTED - Using traits-only endpoint from backend:', fetchUrl);\n             console.log(' This should call the wrapped dashboard generation');\n\n             // Wrapped freshness: ALWAYS request a fresh-per-request variant (even if the same YouTube account is reused).\n             // This avoids \"cached-looking\" dashboards while keeping the core metrics stable.\n             fetchBody = {\n               ...fetchBody,\n               forceFresh: true,\n               cacheBust: Date.now(),\n             };\n             try {\n               const currentEmail = userData?.email;\n               if (currentEmail) localStorage.setItem('onairos_last_wrapped_email', currentEmail);\n             } catch {}\n             console.log(' Wrapped forceFresh enabled (always for wrapped):', { email: userData?.email });\n          }\n          \n          console.log(` Fetching/Training data from ${fetchUrl} (${method})...`);\n          console.log(` Using token: ${urlData.token ? urlData.token.substring(0, 20) + '...' : 'NO TOKEN'}`);\n          try {\n            console.log(' Wrapped fetch request body:', fetchBody);\n          } catch {}\n          console.log(` Waiting for backend response - this may take 1-3 minutes for LLM processing...`);\n          \n          let dataResponse;\n          let apiResponse;\n          let fetchCompleted = false;\n          let fetchError = null;\n          \n          try {\n            // CRITICAL: Wait for the actual fetch response - don't proceed until we get data or a real error\n            // The backend Python script needs time to generate the wrapped dashboard\n            console.log(` Starting fetch request - will wait for complete response...`);\n            \n            // Create abort controller with 10-minute timeout for LLM-heavy endpoints\n            // This prevents the BROWSER from timing out, even if the server might\n            // Note: Gateway/load balancer may timeout earlier (typically 60s), which is expected\n            const controller = new AbortController();\n            const timeoutId = setTimeout(() => controller.abort(), 600000); // 10 minutes\n\n            try {\n              dataResponse = await fetch(fetchUrl, {\n                method: method,\n                headers: {\n                  'Authorization': `Bearer ${urlData.token}`,\n                  'Content-Type': 'application/json'\n                },\n                // Prevent browser/proxy caching for wrapped dashboards\n                cache: 'no-store',\n                // Only send body for POST\n                body: method === 'POST' ? JSON.stringify(fetchBody) : undefined,\n                signal: controller.signal\n              });\n            } finally {\n              clearTimeout(timeoutId);\n            }\n\n            console.log(` Response status: ${dataResponse.status} ${dataResponse.statusText}`);\n            console.log(` Response headers:`, Object.fromEntries(dataResponse.headers.entries()));\n\n            // Check for 504 Gateway Timeout - implies backend is still working\n            if (dataResponse.status === 504) {\n               console.warn(' 504 Gateway Timeout received - Backend is likely still processing');\n               throw new Error('Gateway Timeout (504) - Backend processing continued');\n            }\n\n            // CRITICAL: Check if response is ok before parsing JSON\n            if (!dataResponse.ok) {\n              throw new Error(`HTTP ${dataResponse.status}: ${dataResponse.statusText}`);\n            }\n\n            // CRITICAL: Wait for JSON parsing to complete\n            apiResponse = await dataResponse.json();\n            \n            console.log(' Parsed API response:', {\n              isWrappedApp,\n              hasStatus: !!apiResponse.status,\n              status: apiResponse.status,\n              hasSlides: !!apiResponse.slides,\n              responseKeys: Object.keys(apiResponse)\n            });\n            \n            // Check if dashboard is still being generated (wrapped app only)\n            if (isWrappedApp && apiResponse.status === 'processing') {\n              console.log(' Dashboard is being generated - starting polling...');\n              const basePollInterval = (apiResponse.poll_interval_seconds || 3) * 1000;\n              // Wrapped generation can take longer (LLM + queue). Be patient.\n              const maxPolls = 300; // ~15 minutes at 3s interval\n              let pollCount = 0;\n              \n              while (pollCount < maxPolls) {\n                pollCount++;\n                console.log(` Polling attempt ${pollCount}/${maxPolls}...`);\n                \n                // Wait before next poll\n                // mild backoff to reduce load on long-running generations\n                const pollInterval = Math.min(15000, Math.round(basePollInterval * (pollCount < 30 ? 1 : pollCount < 120 ? 1.5 : 2)));\n                await new Promise(resolve => setTimeout(resolve, pollInterval));\n                \n                try {\n                  const pollResponse = await fetch(fetchUrl, {\n                    method: method,\n                    headers: {\n                      'Authorization': `Bearer ${urlData.token}`,\n                      'Content-Type': 'application/json'\n                    },\n                    cache: 'no-store',\n                    body: method === 'POST' ? JSON.stringify(fetchBody) : undefined\n                  });\n                  \n                  if (pollResponse.ok) {\n                    const pollData = await pollResponse.json();\n                    \n                    // Check if we have the actual dashboard now\n                    if (pollData.slides) {\n                      console.log(' Dashboard ready! Received slides.');\n                      apiResponse = pollData;\n                      break;\n                    } else if (pollData.status !== 'processing') {\n                      console.warn(' Unexpected response during polling:', pollData);\n                      apiResponse = pollData;\n                      break;\n                    }\n                    \n                    console.log(' Still processing...');\n                  } else {\n                    console.warn(` Poll failed with status ${pollResponse.status}`);\n                  }\n                } catch (pollErr) {\n                  console.warn(' Poll request failed:', pollErr.message);\n                }\n              }\n              \n              if (!apiResponse?.slides && pollCount >= maxPolls) {\n                console.warn(' Wrapped polling reached max attempts; treating as still-processing (do not fail the flow)');\n                requestResult.isTimeout = true;\n                // Preserve processing state so UI continues loading and we avoid firing onComplete prematurely.\n                apiResponse = apiResponse || { status: 'processing' };\n              }\n            }\n            \n            // Mark fetch as completed successfully\n            fetchCompleted = true;\n            \n            console.log(' API Response received and parsed successfully');\n            console.log(' Has slides?', !!apiResponse.slides);\n            if (apiResponse.slides) {\n              console.log(' Slides keys:', Object.keys(apiResponse.slides));\n            }\n            \n          } catch (fetchErr) {\n            // Mark that we encountered an error during fetch\n            fetchError = fetchErr;\n            fetchCompleted = false;\n            \n            console.error(' FETCH ERROR:', fetchErr);\n            console.error(' Error name:', fetchErr.name);\n            console.error(' Error message:', fetchErr.message);\n            \n            // Check if it's a timeout error (504 Gateway Timeout)\n            if (fetchErr.message?.includes('504') || fetchErr.message?.includes('Gateway Timeout')) {\n              console.error(' GATEWAY TIMEOUT (504) - Backend is still processing');\n              console.error(' This means the backend Python LLM script is still running');\n              console.error(' DO NOT fall back to mocks yet - backend is generating data');\n              // Don't set apiResponse to null yet - we want to retry or wait\n              apiResponse = null;\n              \n              // Flag this as a timeout specifically so the app knows to wait/retry\n              requestResult.isTimeout = true;\n            }\n            // If it's a CORS error, the backend is returning data but browser blocks it\n            else if (fetchErr.message?.includes('CORS') || fetchErr.message?.includes('Failed to fetch')) {\n              console.error(' CORS BLOCKING RESPONSE - Backend generated data but browser cannot read it');\n              console.error(' This usually means a 504/502 timeout from load balancer stripping headers');\n              console.error(' Backend successfully generated dashboard (see server logs)');\n              \n              // Even though fetch failed, we still have the token and URL\n              // Set apiResponse to null but keep token and apiUrl for retry\n              apiResponse = null;\n              \n              // Treat CORS errors on this endpoint as timeouts/processing\n              // The backend likely finished but the LB cut the connection\n              requestResult.isTimeout = true;\n            } else {\n              // For other errors, still set to null but log the error\n              console.error(' Fetch failed with error:', fetchErr);\n              apiResponse = null;\n            }\n          }\n          \n          // CRITICAL: Log fetch completion status\n          if (fetchCompleted) {\n            console.log(' Fetch completed - data ready');\n          } else if (requestResult.isTimeout) {\n             console.log(' Request timed out - passing timeout flag to app');\n          } else if (fetchError) {\n            console.error(' Fetch failed:', fetchError.message);\n          }\n\n          // Merge into result - include token and apiUrl even if fetch failed\n          finalResult = {\n            ...requestResult,\n            apiResponse: apiResponse, // Raw response (null if CORS blocked)\n            token: urlData.token,     // Token used - ALWAYS include this\n            apiUrl: urlData.apiUrl    // URL used - ALWAYS include this\n          };\n          \n          console.log(' Final result ready:', {\n            hasApiResponse: !!finalResult.apiResponse,\n            hasSlides: !!finalResult.apiResponse?.slides,\n            hasToken: !!finalResult.token\n          });\n          \n          // Add to updated user data - include token even if apiResponse is null\n          updatedUserData.apiResponse = apiResponse;\n          if (urlData.token) {\n            updatedUserData.token = urlData.token;\n            // Also store in localStorage for persistence\n            try {\n              localStorage.setItem('onairos_user_token', urlData.token);\n            } catch (e) {\n              console.warn(' Could not store token in localStorage:', e);\n            }\n          }\n          setUserData(updatedUserData);\n        } else {\n          console.warn(' Failed to get API URL:', urlData);\n        }\n      } catch (fetchError) {\n        console.error(' Error auto-fetching data:', fetchError);\n        \n        // Check if it's a timeout/abort error\n        if (fetchError.name === 'AbortError' || fetchError.message?.includes('timeout')) {\n          console.error(' Request timed out - backend took longer than 2 minutes');\n        }\n        // Check if it's a CORS error\n        else if (fetchError.message?.includes('CORS') || \n                 fetchError.message?.includes('Failed to fetch') ||\n                 fetchError.name === 'TypeError') {\n          console.error(' CORS ERROR DETECTED');\n          console.error(' Backend needs to allow CORS for:', window.location.origin);\n        }\n        \n        // Continue with what we have - don't block the flow\n        // The app can still proceed without apiResponse\n      }\n    }\n\n    // Format response if requested and API response is present\n    let formattedResult = finalResult;\n    if (formatResponse && finalResult?.apiResponse) {\n      try {\n        formattedResult = {\n          ...finalResult,\n          apiResponse: formatOnairosResponse(finalResult.apiResponse, responseFormat)\n        };\n        console.log(' Response formatted with dictionary:', formattedResult.apiResponse?.personalityDict || 'No personality data');\n      } catch (error) {\n        console.warn(' Error formatting response:', error);\n        // Continue with original result if formatting fails\n      }\n    }\n\n    // Ensure token is included from userData if not already in finalResult\n    if (!finalResult.token && updatedUserData.token) {\n      finalResult.token = updatedUserData.token;\n      console.log(' Added token from userData to finalResult');\n    }\n    \n    // Also check localStorage as fallback\n    if (!finalResult.token) {\n      try {\n        const storedToken = localStorage.getItem('onairos_user_token');\n        if (storedToken) {\n          finalResult.token = storedToken;\n          console.log(' Added token from localStorage to finalResult');\n        }\n      } catch (e) {\n        console.warn(' Could not read token from localStorage:', e);\n      }\n    }\n    \n    // Add user data to the result for comprehensive formatting\n    const completeResult = {\n      ...formattedResult,\n      token: finalResult.token || formattedResult.token || updatedUserData.token, // Ensure token is at root level\n      userData: updatedUserData\n    };\n\n    // Enhanced user data formatting for better display\n    let enhancedResult = completeResult;\n    try {\n    // Log formatted user data for better readability\n        enhancedResult = logFormattedUserData(completeResult);\n    } catch (formatError) {\n        console.warn(' Error formatting user data for display:', formatError);\n        // Continue with unformatted result to ensure app doesn't break\n    }\n    \n    // Ensure token is still present after formatting\n    if (!enhancedResult.token && completeResult.token) {\n      enhancedResult.token = completeResult.token;\n    }\n    if (!enhancedResult.token && updatedUserData.token) {\n      enhancedResult.token = updatedUserData.token;\n    }\n\n    // Call onComplete callback if provided\n    // For non-wrapped apps, onComplete was already called from TrainingScreen\n    // So we only call it here for wrapped apps OR if training screen was skipped\n    // webpageName is already in scope from the component props\n    const isWrappedAppForCallback = webpageName && webpageName.toLowerCase().includes('wrapped');\n    \n    if (onComplete && isWrappedAppForCallback) {\n      try {\n        const hasWrappedDashboard =\n          !!enhancedResult?.apiResponse?.slides ||\n          !!enhancedResult?.apiResponse?.dashboard ||\n          !!enhancedResult?.apiResponse?.data?.dashboard;\n        const stillProcessing =\n          enhancedResult?.isTimeout === true ||\n          enhancedResult?.apiResponse?.status === 'processing' ||\n          !hasWrappedDashboard;\n\n        if (stillProcessing) {\n          // IMPORTANT: Do not call onComplete yet; many consuming apps will navigate away/unmount\n          // the SDK, which looks like the loading modal \"closed prematurely\".\n          console.log(' Wrapped dashboard still processing - keeping loading screen open and NOT calling onComplete yet');\n        } else {\n          console.log(' Calling onComplete for wrapped app with final dashboard data');\n        onComplete(enhancedResult);\n        }\n      } catch (error) {\n        console.error(' Error in onComplete callback:', error);\n      }\n    } else if (onComplete && !isWrappedAppForCallback) {\n      console.log(' Skipping onComplete for non-wrapped app (already called from TrainingScreen)');\n    } else {\n      console.log(' No onComplete callback provided');\n    }\n\n    // WRAPPED APPS: Set up listener for app to signal when dashboard is ready\n    // This is event-driven - overlay stays until dashboard signals it's ready\n    // isWrappedApp already declared above\n    \n    if (isWrappedApp) {\n      console.log(' Wrapped app - waiting for dashboard ready signal');\n      console.log(' Setting up onairos-dashboard-ready event listener');\n      \n      // Listen for custom event from the wrapped app indicating dashboard is ready\n      const handleDashboardReady = (event) => {\n        console.log(' Dashboard ready signal received - closing SDK overlay');\n        console.log(' Event details:', event);\n        handleCloseOverlay();\n        window.removeEventListener('onairos-dashboard-ready', handleDashboardReady);\n      };\n      \n      window.addEventListener('onairos-dashboard-ready', handleDashboardReady);\n      console.log(' Event listener attached, waiting for signal...');\n      \n      // Keep overlay open indefinitely until we get the ready signal\n      // No fallback timeout - if the app doesn't signal, the overlay stays\n      // This ensures we never show a flash of the portal page\n    } else {\n      // For non-wrapped apps, just close the modal - training already happened in TrainingScreen\n      console.log(' Non-wrapped app: Training complete, closing overlay');\n      handleCloseOverlay();\n    }\n  };\n\n  const getFlowTitle = () => {\n    switch (currentFlow) {\n      case 'welcome':\n        return ''; // WelcomeScreen handles its own titles\n      case 'email':\n        return ''; // EmailAuth handles its own titles\n      case 'onboarding':\n        return 'Connect Your Data';\n      case 'pin':\n        return 'Secure Your Account';\n      case 'training':\n        return 'Training Your Model';\n      case 'trainingScreen':\n        return 'Training Your Model';\n      case 'dataRequest':\n        return 'Data Request';\n      default:\n        return '';\n    }\n  };\n\n  const getFlowSubtitle = () => {\n    switch (currentFlow) {\n      case 'welcome':\n        return ''; // WelcomeScreen handles its own subtitles\n      case 'email':\n        return ''; // EmailAuth handles its own subtitles\n      case 'onboarding':\n        return 'Choose which accounts to connect for a personalized experience';\n      case 'pin':\n        return 'Create a secure PIN to protect your data';\n      case 'training':\n        return 'Building your personalized insights';\n      case 'trainingScreen':\n        return 'Building your personalized insights';\n      case 'dataRequest':\n        return `Select the data you want to share with ${webpageName}`;\n      default:\n        return '';\n    }\n  };\n\n  const getFlowIcon = () => {\n    switch (currentFlow) {\n      case 'welcome':\n        return ''; // WelcomeScreen handles its own layout\n      case 'email':\n        return ''; // EmailAuth handles its own layout\n      case 'onboarding':\n        return '';\n      case 'pin':\n        return '';\n      case 'training':\n        return '';\n      case 'trainingScreen':\n        return '';\n      case 'dataRequest':\n        return '';\n      default:\n        return '';\n    }\n  };\n\n  const renderContent = () => {\n    const commonProps = {\n      isMobile: isMobileDevice,\n      testMode: testMode\n    };\n\n    switch (currentFlow) {\n      case 'welcome':\n        return (\n          <WelcomeScreen \n            {...commonProps}\n            onContinue={handleWelcomeContinue}\n            onClose={handleCloseOverlay}\n            webpageName={webpageName}\n            appIcon={appIcon}\n          />\n        );\n      case 'email':\n        return (\n          <div className={isMobileDevice ? \"flex-1 min-h-0 flex flex-col\" : \"flex-1 min-h-0 flex flex-col\"}>\n            <EmailAuth \n              {...commonProps}\n              onSuccess={handleEmailAuthSuccess}\n            />\n          </div>\n        );\n      case 'onboarding':\n        return (\n          <UniversalOnboarding \n            {...commonProps}\n            onComplete={handleOnboardingComplete}\n            onBack={() => {\n              if (returnToDataRequestAfterOnboarding) {\n                setReturnToDataRequestAfterOnboarding(false);\n                // Sync connected apps from storage so DataRequest reflects newly connected platforms\n                try {\n                  const saved = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n                  if (saved && Array.isArray(saved.connectedAccounts)) {\n                    setUserData((prev) => {\n                      const merged = { ...(prev || {}), ...saved, connectedAccounts: saved.connectedAccounts };\n                      try { localStorage.setItem('onairosUser', JSON.stringify(merged)); } catch {}\n                      return merged;\n                    });\n                  }\n                } catch {}\n                setCurrentFlow('dataRequest');\n              } else {\n                setCurrentFlow('email');\n              }\n            }}\n            appIcon={appIcon || \"https://onairos.sirv.com/Images/OnairosBlack.png\"}\n            appName={webpageName}\n            username={userData?.email || userData?.username}\n            priorityPlatform={priorityPlatform}\n            rawMemoriesOnly={rawMemoriesOnly}\n            rawMemoriesConfig={rawMemoriesConfig}\n          />\n        );\n      case 'pin':\n        return (\n          <div className={isMobileDevice ? \"flex-1 min-h-0\" : \"\"}>\n            <PinSetup \n              onComplete={handlePinSetupComplete}\n              onBack={() => setCurrentFlow('onboarding')}\n              userEmail={userData?.email}\n            />\n          </div>\n        );\n      case 'training':\n        return (\n          <TrainingComponent \n            onComplete={handleTrainingComplete}\n            userEmail={userData?.email}\n            appName={webpageName}\n            connectedAccounts={userData?.connectedAccounts || []}\n            testMode={testMode}\n          />\n        );\n      case 'trainingScreen':\n        console.log(' Rendering TrainingScreen with userData:', {\n          hasUserData: !!userData,\n          hasToken: !!userData?.token,\n          tokenPreview: userData?.token ? userData.token.substring(0, 20) + '...' : 'NO TOKEN',\n          email: userData?.email,\n          connectedAccounts: userData?.connectedAccounts\n        });\n        return (\n          <TrainingScreen \n            onComplete={handleTrainingScreenComplete}\n            onTrainingStart={() => setTrainingHasStarted(true)}\n            userEmail={userData?.email}\n            connectedAccounts={userData?.connectedAccounts || []}\n            userToken={userData?.token}\n          />\n        );\n      case 'dataRequest':\n        console.log(' Rendering DataRequest:', {\n          connectedAccounts: userData?.connectedAccounts,\n          isArray: Array.isArray(userData?.connectedAccounts),\n          userData: userData\n        });\n        return (\n          <DataRequest \n            onComplete={handleDataRequestComplete}\n            onConnectMoreApps={() => {\n              // Go back to UniversalOnboarding but return here afterwards.\n              // Connected apps are persisted in localStorage by UniversalOnboarding.\n              setReturnToDataRequestAfterOnboarding(true);\n              setCurrentFlow('onboarding');\n            }}\n            userEmail={userData?.email || userData?.userName}\n            requestData={requestData}\n            appName={webpageName}\n            autoFetch={autoFetch}\n            testMode={testMode}\n            appIcon={appIcon}\n            connectedPlatforms={userData?.connectedAccounts || []}\n            rawMemoriesOnly={rawMemoriesOnly}\n            rawMemoriesConfig={rawMemoriesConfig}\n            showTime={time}\n          />\n        );\n      case 'wrappedLoading':\n        return (\n          <div className=\"flex-1 min-h-0\">\n            <WrappedLoadingPage appName={webpageName} />\n          </div>\n        );\n      case 'loading':\n        return <LoadingScreen onComplete={handleLoadingComplete} />;\n      default:\n        return (\n          <div className=\"flex flex-col items-center space-y-4 p-6\">\n            <div className=\"animate-spin h-8 w-8 border-2 border-blue-600 rounded-full border-t-transparent\"></div>\n            <p className=\"text-gray-600\">Loading...</p>\n          </div>\n        );\n    }\n  };\n\n  // Styling and button class based on visual type\n  const buttonClass = \n    `flex items-center justify-center font-bold rounded cursor-pointer ${\n    buttonType === 'pill' ? 'px-4 py-2' : 'w-12 h-12'\n    } bg-transparent OnairosConnect`;\n\n  const buttonStyle = {\n    flexDirection: textLayout === 'below' ? 'column' : 'row',\n    backgroundColor: 'transparent',\n    color: textColor,\n    border: '1px solid transparent',\n  };\n\n  // Icon and text style based on the visualType\n  const logoStyle = {\n    width: '20px',\n    height: '20px',\n    marginRight: visualType === 'full' ? '12px' : '0',\n  };\n\n  const getText = () => {\n    switch (loginType) {\n      case 'signUp':\n        return 'Sign Up with Onairos';\n      case 'signOut':\n        return 'Sign Out of Onairos';\n      default:\n        return 'Sign In with Onairos';\n    }\n  };\n\n  return (\n    <>\n      <button\n        className={buttonClass}\n        onClick={openTerminal}\n        style={buttonStyle}\n      >\n        {(visualType === 'full' || visualType === 'icon') && (\n          <img\n            src={login ? \"https://onairos.sirv.com/Images/OnairosWhite.png\" : \"https://onairos.sirv.com/Images/OnairosBlack.png\"}\n            alt=\"Onairos Logo\"\n            style={logoStyle}\n          />\n        )}\n        {visualType !== 'icon' && (\n          <span className={`${textColor === 'black' ? 'text-black' : 'text-white'} ${visualType === 'icon' ? 'sr-only' : ''} ${textLayout === 'right' ? 'ml-2' : textLayout === 'left' ? 'mr-2' : ''}`}>\n            {getText()}\n          </span>\n        )}\n      </button>\n\n      {/* Modal with New Design */}\n      {showOverlay && (\n        <>\n          {/** Wrapped-only typography hook */}\n          {/** Adds CSS variables --fontHeading/--fontBody via .onairos-wrapped-fonts */}\n          {isMobileDevice ? (\n            // Mobile Browser: Use ModalPageLayout with mobile-optimized props\n            <ModalPageLayout\n              visible={showOverlay}\n              onClose={handleCloseOverlay}\n              showBackButton={currentFlow !== 'welcome' && currentFlow !== 'email' && currentFlow !== 'loading' && currentFlow !== 'wrappedLoading'}\n              onBack={() => {\n                        if (currentFlow === 'onboarding') {\n                          if (returnToDataRequestAfterOnboarding) {\n                            setReturnToDataRequestAfterOnboarding(false);\n                            // Sync connected apps from storage so DataRequest reflects newly connected platforms\n                            try {\n                              const saved = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n                              if (saved && Array.isArray(saved.connectedAccounts)) {\n                                setUserData((prev) => {\n                                  const merged = { ...(prev || {}), ...saved, connectedAccounts: saved.connectedAccounts };\n                                  try { localStorage.setItem('onairosUser', JSON.stringify(merged)); } catch {}\n                                  return merged;\n                                });\n                              }\n                            } catch {}\n                            setCurrentFlow('dataRequest');\n                          } else {\n                            setCurrentFlow('email');\n                          }\n                        }\n                        else if (currentFlow === 'pin') setCurrentFlow('onboarding');\n                        else if (currentFlow === 'dataRequest') setCurrentFlow('onboarding');\n                        else if (currentFlow === 'training') setCurrentFlow('pin');\n                      }}\n              showCloseButton={currentFlow === 'welcome' || currentFlow === 'email'}\n              title=\"\"\n              subtitle=\"\"\n              icon={null}\n              centerContent={true}\n              contentClassName=\"!p-0\"\n              modalClassName={`onairos-modal onairos-modal-mobile ${(webpageName || '').toLowerCase().includes('wrapped') ? 'onairos-wrapped-fonts' : ''}`}\n            >\n              <div className=\"onairos-modal-shell flex-1 min-h-0 flex flex-col\">\n                  {renderContent()}\n                </div>\n            </ModalPageLayout>\n          ) : (\n            // Desktop Layout\n            <ModalPageLayout\n              visible={showOverlay}\n              onClose={handleCloseOverlay}\n              showBackButton={currentFlow === 'training' || currentFlow === 'onboarding' || currentFlow === 'pin' || currentFlow === 'dataRequest'}\n              onBack={() => {\n                if (currentFlow === 'email') setCurrentFlow('welcome');\n                if (currentFlow === 'onboarding') {\n                  if (returnToDataRequestAfterOnboarding) {\n                    setReturnToDataRequestAfterOnboarding(false);\n                    // Sync connected apps from storage so DataRequest reflects newly connected platforms\n                    try {\n                      const saved = JSON.parse(localStorage.getItem('onairosUser') || '{}');\n                      if (saved && Array.isArray(saved.connectedAccounts)) {\n                        setUserData((prev) => {\n                          const merged = { ...(prev || {}), ...saved, connectedAccounts: saved.connectedAccounts };\n                          try { localStorage.setItem('onairosUser', JSON.stringify(merged)); } catch {}\n                          return merged;\n                        });\n                      }\n                    } catch {}\n                    setCurrentFlow('dataRequest');\n                  } else {\n                    setCurrentFlow('email');\n                  }\n                }\n                if (currentFlow === 'pin') setCurrentFlow('onboarding'); \n                if (currentFlow === 'training') setCurrentFlow('pin');\n                if (currentFlow === 'dataRequest') setCurrentFlow('onboarding');\n              }}\n              title=\"\"\n              subtitle=\"\"\n              icon={null}\n              centerContent={true}\n              contentClassName={currentFlow !== 'welcome' ? \"!p-0\" : \"\"}\n              modalClassName={`onairos-modal ${(webpageName || '').toLowerCase().includes('wrapped') ? 'onairos-wrapped-fonts' : ''}`}\n            >\n              <div className=\"onairos-modal-shell\">\n                {renderContent()}\n              </div>\n            </ModalPageLayout>\n          )}\n        </>\n      )}\n    </>\n  );\n}\n\nexport default OnairosButton;"],"names":["WelcomeScreen","_ref","onContinue","onClose","useEffect","script","document","createElement","src","async","head","appendChild","existingScript","querySelector","removeChild","React","className","style","height","alt","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","COLORS","btnGradStart","btnGradEnd","btnLabel","btnBorder","iconCircleGradientStart","iconCircleGradientEnd","background","backgroundSecondary","textPrimary","textSecondary","textMuted","border","borderLight","success","error","warning","info","hover","pressed","focus","IconCircle","size","children","concat","width","borderRadius","fontSize","color","backgroundColor","_ref2","label","iconRight","loading","disabled","testId","textStyle","centered","props","_objectWithoutProperties","_excluded","setPressed","useState","buttonStyle","_objectSpread","position","overflow","minWidth","maxWidth","margin","cursor","opacity","boxShadow","transition","pressedOverlayStyle","top","left","right","bottom","labelStyle","fontFamily","fontWeight","textAlign","_extends","onMouseDown","handleMouseDown","onMouseUp","handleMouseUp","onMouseLeave","handleMouseLeave","display","justifyContent","alignItems","sdkConfig","apiKey","process","env","REACT_APP_ONAIROS_API_KEY","baseUrl","REACT_APP_ONAIROS_BASE_URL","onComplete","appName","appIcon","headerImage","username","initialUsername","rawMemoriesOnly","rawMemoriesConfig","step","setStep","email","setEmail","otp","setOtp","isLoading","setIsLoading","setError","isNewUser","setIsNewUser","resendTimer","setResendTimer","otpRefs","useRef","interval","setInterval","prev","clearInterval","handleEmailSubmit","test","res","fetch","method","headers","body","JSON","stringify","data","json","ok","Error","message","err","type","value","onChange","e","target","placeholder","paddingLeft","paddingRight","onKeyDown","key","autoFocus","PrimaryButton","trim","onPaste","preventDefault","pastedData","clipboardData","getData","slice","replace","_otpRefs$current$next","newOtp","split","forEach","char","index","nextIndex","Math","min","length","current","map","digit","ref","el","inputMode","maxLength","handleOtpChange","_otpRefs$current","handleKeyDown","_otpRefs$current2","code","join","localStorage","setItem","user","id","userId","BOOKMARKLET_HREF","ConnectChatGPTModal","open","onConnected","console","log","userToken","getUserToken","directToken","getItem","userData","parse","token","substring","bookmarkletHref","createPortal","inset","zIndex","pointerEvents","fillRule","clipRule","animation","href","title","draggable","onDragStart","dataTransfer","setData","effectAllowed","warn","alert","suppressHydrationWarning","window","handleGotIt","chatgptIcon","claudeIcon","geminiIcon","grokIcon","sdkType","enableHealthMonitoring","enableAutoRefresh","enableConnectionValidation","fadeSlideInKeyframes","UniversalOnboarding","_window$Capacitor","_window$Capacitor$isN","onBack","testMode","priorityPlatform","isMobile","isMobileProp","lottieRef","lastFrameRef","rafRef","initialLoadDone","connectedAccounts","setConnectedAccounts","isConnecting","setIsConnecting","connectingPlatform","setConnectingPlatform","selected","setSelected","showChatGPTModal","setShowChatGPTModal","isActualMobileDevice","navigator","userAgent","isNativePlatform","Capacitor","call","vh","setVh","innerHeight","onResize","addEventListener","removeEventListener","PERSONA_SIZE","igGradId","useId","Brand","ChatGPT","objectFit","Claude","Gemini","Grok","Instagram","cx","cy","r","offset","stopColor","YouTube","Reddit","LinkedIn","Twitter","allPlatformsDefault","name","connector","icon","directLink","wrappedPlatforms","isWrappedApp","toLowerCase","includes","allPlatforms","canonicalizePlatformName","raw","String","lower","byConnector","find","p","byName","charAt","toUpperCase","Object","keys","connectedArray","entries","filter","v","_ref3","k","Boolean","dispatchEvent","CustomEvent","handleAuthSuccess","platform","detail","plat","sessionStorage","Date","now","toString","currentState","justConnectedTime","parseInt","Array","isArray","accountsObj","reduce","acc","checkOAuthSuccess","sessionSuccess","sessionPlatform","removeItem","handleSwitch","_JSON$parse","_window$Capacitor2","_window$Capacitor2$is","s","isCapacitorNative","isMobileBrowser","effectiveMobile","returnUrl","location","origin","pathname","sessionPayload","bodyPayload","session","candidates","youtube","linkedin","reddit","pinterest","instagram","github","facebook","gmail","oauthUrl","candidateLower","c","Browser","url","windowName","presentationStyle","popup","closed","messageHandler","event","pollInterval","close","localStorageKey","timestampKey","pollCount","timestamp","timestampNum","connectToPlatform","connectedCount","values","totalFrames","personaAnim","progress","max","floor","start","startTs","performance","t","eased","frame","goToAndStop","requestAnimationFrame","cancelAnimationFrame","scrollbarWidth","msOverflowStyle","paddingTop","paddingBottom","marginBottom","marginTop","Lottie","animationData","autoplay","loop","isSelected","isConnected","isConnectingThis","borderColor","totalConnections","PinSetup","userEmail","pin","setPin","pinRequirements","setPinRequirements","uppercase","number","allRequirementsMet","minHeight","WebkitTextFillColor","handleSubmit","pinCreated","toISOString","undefined","Icon","base","DataTypeToggle","dataType","enabled","onToggle","isNative","handle","required","options","onConnectMoreApps","connectedPlatforms","showTime","basic","rawMemories","preferences","personality","freq","setFreq","platformIconFailed","setPlatformIconFailed","platforms","setPlatforms","normalizePlatformName","twitter","x","chatgpt","claude","gemini","grok","toggle","val","selectedCount","refreshPlatforms","newPlatforms","getConnected","u","normalized","mappedRaw","_ref4","_","_ref5","mapped","_ref6","_ref7","handleConnectedAccountsUpdate","availableOptions","opt","hasLLMConnections","llmPlatforms","some","freqToPercent","f","personaImg","onError","currentTarget","rect","getBoundingClientRect","ratio","clientX","WebkitOverflowScrolling","Pinterest","GitHub","Facebook","Gmail","failed","fallbackText","approved","declined","TrainingComponent","_steps$currentStep","_steps$currentStep2","_steps$currentStep3","_steps$currentStep4","_steps$currentStep5","currentStep","setCurrentStep","setProgress","isComplete","setIsComplete","steps","description","duration","stepTimeout","stepDuration","stepProgress","newProgress","setTimeout","completionDelay","trainingComplete","simulatedTraining","clearTimeout","round","trainingPhrases","TrainingScreen","onTrainingStart","currentPhrase","setCurrentPhrase","currentStage","setCurrentStage","socket","progressTimer","didSignalStart","signalTrainingStarted","storedToken","io","auth","transports","reconnection","timeout","on","socketId","emit","percentage","stage","result","_result$trainingResul","_result$trainingResul2","_result$trainingResul3","status","traits","trainingResults","userTraits","hasLlmData","llmData","inferenceResults","disconnect","fallback","reason","runTrainingAndInference","rainAnim","LoadingScreen","dotCount","setDotCount","loadingStates","stateInterval","nextStep","dotInterval","maxHeight","aspectRatio","repeat","WrappedLoadingPage","setAnimationData","messageIndex","setMessageIndex","messages","then","catch","err2","increment","timer","next","messageTimer","PERSONALITY_TYPES","TRAIT_CATEGORIES","formatOnairosResponse","apiResponse","_apiResponse$Inferenc","arguments","includeDictionary","includeArray","formatted","InferenceResult","scores","_apiResponse$Inferenc2","personalityDict","_formatted$InferenceR","traitResult","traitDict","category","formatUserDataForDisplay","_result$userData","_result$userData2","_result$userData3","_result$userData4","_result$userData5","_result$userData6","_result$userData7","userDataSummary","requestInfo","userHash","dataTypesRequested","approvedData","userProfile","userType","onboardingComplete","modelReady","formatConnectedAccounts","aiData","formatAIResponseData","hasApiResponse","hasErrors","apiError","prettyPrint","lines","push","toLocaleString","summary","hasData","dataTypes","createPrettyPrintVersion","accounts","count","names","a","connectedAt","account","_apiResponse$data","_apiResponse$Inferenc3","available","_apiResponse$data2","_apiResponse$data3","_apiResponse$data4","_apiResponse$data5","_apiResponse$Inferenc4","dashboard","slides","apps","personalityData","preferencesData","output","logFormattedUserData","PageLayout","subtitle","showHeader","showCloseButton","showBackButton","contentClassName","centerContent","isSmallScreen","innerWidth","layoutStyle","flexDirection","headerStyle","padding","contentStyle","flex","titleStyle","lineHeight","subtitleStyle","ModalPageLayout","visible","onBackdropClick","backdropStyle","modalStyle","modalClassName","pageLayoutProps","_excluded2","mobileModalHeightPx","setMobileModalHeightPx","h","modalHeight","modalMaxHeight","modalMaxWidth","backdropAlign","backdropPadding","backdropStyles","willChange","hasBackdropStyleOverride","backdropStyleOverride","modalStyles","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","transform","marginLeft","marginRight","flexShrink","hasModalStyleOverride","modalStyleWasApplied","modalStyleOverride","modalStyleKeys","backdropStyleKeys","modalMinHeight","stopPropagation","OnairosButton","requestData","webpageName","inferenceData","autoFetch","proofMode","textLayout","textColor","login","buttonType","loginReturn","loginType","visualType","enableTraining","formatResponse","responseFormat","time","showOverlay","setShowOverlay","currentFlow","setCurrentFlow","trainingHasStarted","setTrainingHasStarted","setUserData","oauthReturnDetected","setOauthReturnDetected","returnToDataRequestAfterOnboarding","setReturnToDataRequestAfterOnboarding","isMobileDevice","setIsMobileDevice","computeMobile","_document$documentEle","_document$body","documentElement","clientWidth","parent","isCapNative","detectedMobile","dataset","onairosPrevOverflow","isDesktop","modal","pageContent","shell","getMetrics","styles","getComputedStyle","paddingInline","classList","from","viewportWidth","handleDeepLink","hasSuccess","hasError","isPopup","opener","params","qIdx","indexOf","URLSearchParams","URL","searchParams","get","postMessage","innerHTML","questionMarkIndex","state","decoded","atob","connectionType","decodeURIComponent","existingUserData","verified","provider","existing","merged","history","replaceState","startsWith","cleanUrl","appListener","_window$Capacitor3","_window$Capacitor3$is","AppPlugin","App","_window$Capacitor4","addListener","Plugins","setupListener","remove","checkWindowUrl","checkExistingSession","_unused","_unused2","savedUser","_unused3","checkOAuthReturn","urlParams","search","oauthSuccess","oauthPlatform","oauthEmail","newUrl","gmailSuccess","gmailTimestamp","gmailEmail","handleCloseOverlay","_unused5","handleWelcomeContinue","handleEmailAuthSuccess","authData","userState","flowType","existingUser","hasAccountInfo","accountInfo","accountStatus","candidate","jwtToken","accessToken","base64","payload","charCodeAt","sub","_unused6","exists","accountExists","hasTrainedModel","hasPersonalityTraits","needsDataConnection","needsTraining","canUseInference","finalDecision","reasoning","usingAccountStatus","existingUserFalse","flowTypeOnboarding","noAccountInfo","newUserData","emailToken","handleOnboardingComplete","onboardingData","updatedUserData","handlePinSetupComplete","pinData","timeoutId","handleLoadingComplete","handleTrainingComplete","trainingResult","trainingCompleted","handleTrainingScreenComplete","handleDataRequestComplete","_requestResult$approv","_requestResult$approv2","_finalResult","requestResult","lastDataRequest","finalResult","urlResponse","Info","appId","confirmations","EncryptedUserPin","storage","urlData","apiUrl","_finalResult$apiRespo","eventDetail","dataResponse","fetchUrl","fetchBody","includeLlmData","forceFresh","cacheBust","currentEmail","_unused7","connected","_unused8","fetchCompleted","fetchError","controller","AbortController","abort","cache","signal","statusText","fromEntries","hasStatus","hasSlides","responseKeys","_apiResponse","basePollInterval","poll_interval_seconds","maxPolls","Promise","resolve","pollResponse","pollData","pollErr","isTimeout","fetchErr","_fetchErr$message","_fetchErr$message2","_fetchErr$message3","_fetchErr$message4","hasToken","_fetchError$message","_fetchError$message2","_fetchError$message3","formattedResult","_formattedResult$apiR","completeResult","enhancedResult","formatError","isWrappedAppForCallback","_enhancedResult","_enhancedResult2","_enhancedResult3","_enhancedResult4","_enhancedResult5","hasWrappedDashboard","handleDashboardReady","renderContent","commonProps","EmailAuth","onSuccess","saved","_unused9","_unused0","hasUserData","tokenPreview","DataRequest","userName","buttonClass","logoStyle","onairosApiKey","_unused4","getText","_unused1","_unused10","_unused11","_unused12"],"ignoreList":[],"sourceRoot":""}