!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("react"));else if("function"==typeof define&&define.amd)define(["React"],e);else{var r="object"==typeof exports?e(require("react")):e(t.React);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,(t=>(()=>{var e,r,n,o,i={317:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});const n={}},586:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(431);e.default=class{BigNum;constructor(){this.BigNum=(t,e)=>new(n.BigNumber.clone({DECIMAL_PLACES:e}))(t)}winstonToAr(t,{formatted:e=!1,decimals:r=12,trim:n=!0}={}){let o=this.stringToBigNum(t,r).shiftedBy(-12);return e?o.toFormat(r):o.toFixed(r)}arToWinston(t,{formatted:e=!1}={}){let r=this.stringToBigNum(t).shiftedBy(12);return e?r.toFormat():r.toFixed(0)}compare(t,e){let r=this.stringToBigNum(t),n=this.stringToBigNum(e);return r.comparedTo(n)}isEqual(t,e){return 0===this.compare(t,e)}isLessThan(t,e){let r=this.stringToBigNum(t),n=this.stringToBigNum(e);return r.isLessThan(n)}isGreaterThan(t,e){let r=this.stringToBigNum(t),n=this.stringToBigNum(e);return r.isGreaterThan(n)}add(t,e){let r=this.stringToBigNum(t);this.stringToBigNum(e);return r.plus(e).toFixed(0)}sub(t,e){let r=this.stringToBigNum(t);this.stringToBigNum(e);return r.minus(e).toFixed(0)}stringToBigNum(t,e=12){return this.BigNum(t,e)}}},759:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(498);r(317);class o{api;network;static HASH_ENDPOINT="block/hash/";static HEIGHT_ENDPOINT="block/height/";constructor(t,e){this.api=t,this.network=e}async get(t){const e=await this.api.get(`${o.HASH_ENDPOINT}${t}`);if(200===e.status)return e.data;throw 404===e.status?new n.default("BLOCK_NOT_FOUND"):new Error(`Error while loading block data: ${e}`)}async getByHeight(t){const e=await this.api.get(`${o.HEIGHT_ENDPOINT}${t}`);if(200===e.status)return e.data;throw 404===e.status?new n.default("BLOCK_NOT_FOUND"):new Error(`Error while loading block data: ${e}`)}async getCurrent(){const{current:t}=await this.network.getInfo();return await this.get(t)}}e.default=o},879:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(498),o=r(244);e.default=class{api;constructor(t){this.api=t}async getTransactionOffset(t){const e=await this.api.get(`tx/${t}/offset`);if(200===e.status)return e.data;throw new Error(`Unable to get transaction offset: ${(0,n.getError)(e)}`)}async getChunk(t){const e=await this.api.get(`chunk/${t}`);if(200===e.status)return e.data;throw new Error(`Unable to get chunk: ${(0,n.getError)(e)}`)}async getChunkData(t){const e=await this.getChunk(t);return o.b64UrlToBuffer(e.chunk)}firstChunkOffset(t){return parseInt(t.offset)-parseInt(t.size)+1}async downloadChunkedData(t){const e=await this.getTransactionOffset(t),r=parseInt(e.size),n=parseInt(e.offset)-r+1,o=new Uint8Array(r);let i=0;for(;i<r;){let t;this.api.config.logging&&console.log(`[chunk] ${i}/${r}`);try{t=await this.getChunkData(n+i)}catch(t){console.error(`[chunk] Failed to fetch chunk at offset ${n+i}`),console.error("[chunk] This could indicate that the chunk wasn't uploaded or hasn't yet seeded properly to a particular gateway/node")}if(!t)throw new Error(`Couldn't complete data download at ${i}/${r}`);o.set(t,i),i+=t.length}return o}}},536:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(586),o=r(874),i=r(363),s=r(248),a=r(935),c=r(927),u=r(825),l=r(244),h=r(243),f=r(879),d=r(759);class p{api;wallets;transactions;network;blocks;ar;silo;chunks;static init;static crypto=new i.default;static utils=l;constructor(t){this.api=new o.default(t),this.wallets=new c.default(this.api,p.crypto),this.chunks=new f.default(this.api),this.transactions=new a.default(this.api,p.crypto,this.chunks),this.silo=new h.default(this.api,this.crypto,this.transactions),this.network=new s.default(this.api),this.blocks=new d.default(this.api,this.network),this.ar=new n.default}get crypto(){return p.crypto}get utils(){return p.utils}getConfig(){return{api:this.api.getConfig(),crypto:null}}async createTransaction(t,e){const r={};if(Object.assign(r,t),!(t.data||t.target&&t.quantity))throw new Error("A new Arweave transaction must have a 'data' value, or 'target' and 'quantity' values.");if(null==t.owner&&e&&"use_wallet"!==e&&(r.owner=e.n),null==t.last_tx&&(r.last_tx=await this.transactions.getTransactionAnchor()),"string"==typeof t.data&&(t.data=l.stringToBuffer(t.data)),t.data instanceof ArrayBuffer&&(t.data=new Uint8Array(t.data)),t.data&&!(t.data instanceof Uint8Array))throw new Error("Expected data to be a string, Uint8Array or ArrayBuffer");if(null==t.reward){const e=t.data?t.data.byteLength:0;r.reward=await this.transactions.getPrice(e,r.target)}r.data_root="",r.data_size=t.data?t.data.byteLength.toString():"0",r.data=t.data||new Uint8Array(0);const n=new u.default(r);return await n.getSignatureData(),n}async createSiloTransaction(t,e,r){const n={};if(Object.assign(n,t),!t.data)throw new Error("Silo transactions must have a 'data' value");if(!r)throw new Error("No Silo URI specified.");if(t.target||t.quantity)throw new Error("Silo transactions can only be used for storing data, sending AR to other wallets isn't supported.");if(null==t.owner){if(!e||!e.n)throw new Error("A new Arweave transaction must either have an 'owner' attribute, or you must provide the jwk parameter.");n.owner=e.n}null==t.last_tx&&(n.last_tx=await this.transactions.getTransactionAnchor());const o=await this.silo.parseUri(r);if("string"==typeof t.data){const e=await this.crypto.encrypt(l.stringToBuffer(t.data),o.getEncryptionKey());n.reward=await this.transactions.getPrice(e.byteLength),n.data=l.bufferTob64Url(e)}if(t.data instanceof Uint8Array){const e=await this.crypto.encrypt(t.data,o.getEncryptionKey());n.reward=await this.transactions.getPrice(e.byteLength),n.data=l.bufferTob64Url(e)}const i=new u.default(n);return i.addTag("Silo-Name",o.getAccessKey()),i.addTag("Silo-Version","0.1.0"),i}arql(t){return this.api.post("/arql",t).then((t=>t.data||[]))}}e.default=p},386:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0});const i=r(536),s=r(118);i.default.init=function(t={}){const e={host:"arweave.net",port:443,protocol:"https"};if("object"!=typeof location||!location.protocol||!location.hostname)return new i.default({...t,...e});const r=location.protocol.replace(":",""),n=location.hostname,o=location.port?parseInt(location.port):"https"==r?443:80,a=(0,s.getDefaultConfig)(r,n),c=t.protocol||a.protocol,u=t.host||a.host,l=t.port||a.port||o;return new i.default({...t,host:u,protocol:c,port:l})},"object"==typeof globalThis?globalThis.Arweave=i.default:"object"==typeof self&&(self.Arweave=i.default),o(r(536),e),e.default=i.default},874:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{METHOD_GET="GET";METHOD_POST="POST";config;constructor(t){this.applyConfig(t)}applyConfig(t){this.config=this.mergeDefaults(t)}getConfig(){return this.config}mergeDefaults(t){const e=t.protocol||"http",r=t.port||("https"===e?443:80);return{host:t.host||"127.0.0.1",protocol:e,port:r,timeout:t.timeout||2e4,logging:t.logging||!1,logger:t.logger||console.log,network:t.network}}async get(t,e){return await this.request(t,{...e,method:this.METHOD_GET})}async post(t,e,r){const n=new Headers(r?.headers||{});return n.get("content-type")?.includes("application/json")||n.append("content-type","application/json"),n.append("accept","application/json, text/plain, */*"),await this.request(t,{...r,method:this.METHOD_POST,body:"string"!=typeof e?JSON.stringify(e):e,headers:n})}async request(t,e){const n=new Headers(e?.headers||{}),o=`${this.config.protocol}://${this.config.host}:${this.config.port}`,i=e?.responseType;delete e?.responseType,t.startsWith("/")&&(t=t.slice(1)),this.config.network&&n.append("x-network",this.config.network),this.config.logging&&this.config.logger(`Requesting: ${o}/${t}`);let s=await fetch(`${o}/${t}`,{...e||{},headers:n});this.config.logging&&this.config.logger(`Response:   ${s.url} - ${s.status}`);const a=s.headers.get("content-type"),c=a?.match(/charset=([^()<>@,;:\"/[\]?.=\s]*)/i)?.[1],u=s,l=async()=>{if(c)try{u.data=new TextDecoder(c).decode(await s.arrayBuffer())}catch(t){u.data=await s.text()}else u.data=await s.text()};if("arraybuffer"===i)u.data=await s.arrayBuffer();else if("text"===i)await l();else if("webstream"===i)u.data=r(s.body);else try{let t=await s.clone().json();"object"!=typeof t?await l():u.data=await s.json(),t=null}catch{await l()}return u}};const r=t=>{const e=t;return void 0===e[Symbol.asyncIterator]?(e[Symbol.asyncIterator]=n(t),e):t},n=function(t){return async function*(){const e=t.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}}}},363:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(244);e.default=class{keyLength=4096;publicExponent=65537;hashAlgorithm="sha256";driver;constructor(){if(!this.detectWebCrypto())throw new Error("SubtleCrypto not available!");this.driver=crypto.subtle}async generateJWK(){let t=await this.driver.generateKey({name:"RSA-PSS",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign"]),e=await this.driver.exportKey("jwk",t.privateKey);return{kty:e.kty,e:e.e,n:e.n,d:e.d,p:e.p,q:e.q,dp:e.dp,dq:e.dq,qi:e.qi}}async sign(t,e,{saltLength:r}={}){let n=await this.driver.sign({name:"RSA-PSS",saltLength:32},await this.jwkToCryptoKey(t),e);return new Uint8Array(n)}async hash(t,e="SHA-256"){let r=await this.driver.digest(e,t);return new Uint8Array(r)}async verify(t,e,r){const n={kty:"RSA",e:"AQAB",n:t},o=await this.jwkToPublicCryptoKey(n),i=await this.driver.digest("SHA-256",e),s=await this.driver.verify({name:"RSA-PSS",saltLength:0},o,r,e),a=await this.driver.verify({name:"RSA-PSS",saltLength:32},o,r,e),c=await this.driver.verify({name:"RSA-PSS",saltLength:Math.ceil((o.algorithm.modulusLength-1)/8)-i.byteLength-2},o,r,e);return s||a||c}async jwkToCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["sign"])}async jwkToPublicCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["verify"])}detectWebCrypto(){if("undefined"==typeof crypto)return!1;const t=crypto?.subtle;if(void 0===t)return!1;return["generateKey","importKey","exportKey","digest","sign"].every((e=>"function"==typeof t[e]))}async encrypt(t,e,r){const o=await this.driver.importKey("raw","string"==typeof e?n.stringToBuffer(e):e,{name:"PBKDF2",length:32},!1,["deriveKey"]),i=await this.driver.deriveKey({name:"PBKDF2",salt:r?n.stringToBuffer(r):n.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),s=new Uint8Array(16);crypto.getRandomValues(s);const a=await this.driver.encrypt({name:"AES-CBC",iv:s},i,t);return n.concatBuffers([s,a])}async decrypt(t,e,r){const o=await this.driver.importKey("raw","string"==typeof e?n.stringToBuffer(e):e,{name:"PBKDF2",length:32},!1,["deriveKey"]),i=await this.driver.deriveKey({name:"PBKDF2",salt:r?n.stringToBuffer(r):n.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),s=t.slice(0,16),a=await this.driver.decrypt({name:"AES-CBC",iv:s},i,t.slice(16));return n.concatBuffers([a])}}},921:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(536);async function o(t){if(Array.isArray(t)){const e=n.default.utils.concatBuffers([n.default.utils.stringToBuffer("list"),n.default.utils.stringToBuffer(t.length.toString())]);return await i(t,await n.default.crypto.hash(e,"SHA-384"))}const e=n.default.utils.concatBuffers([n.default.utils.stringToBuffer("blob"),n.default.utils.stringToBuffer(t.byteLength.toString())]),r=n.default.utils.concatBuffers([await n.default.crypto.hash(e,"SHA-384"),await n.default.crypto.hash(t,"SHA-384")]);return await n.default.crypto.hash(r,"SHA-384")}async function i(t,e){if(t.length<1)return e;const r=n.default.utils.concatBuffers([e,await o(t[0])]),s=await n.default.crypto.hash(r,"SHA-384");return await i(t.slice(1),s)}e.default=o},498:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getError=void 0;class r extends Error{type;response;constructor(t,e={}){e.message?super(e.message):super(),this.type=t,this.response=e.response}getType(){return this.type}}e.default=r,e.getError=function(t){let e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(t){}if(t.data instanceof ArrayBuffer||t.data instanceof Uint8Array)try{e=JSON.parse(e.toString())}catch(t){}return e?e.error||e:t.statusText||"unknown"}},224:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.validatePath=e.arrayCompare=e.bufferToInt=e.intToBuffer=e.arrayFlatten=e.generateProofs=e.buildLayers=e.generateTransactionChunks=e.generateTree=e.computeRootHash=e.generateLeaves=e.chunkData=e.MIN_CHUNK_SIZE=e.MAX_CHUNK_SIZE=void 0;const n=r(536),o=r(244);e.MAX_CHUNK_SIZE=262144,e.MIN_CHUNK_SIZE=32768;const i=32,s=32;async function a(t){let r=[],o=t,i=0;for(;o.byteLength>=e.MAX_CHUNK_SIZE;){let t=e.MAX_CHUNK_SIZE,s=o.byteLength-e.MAX_CHUNK_SIZE;s>0&&s<e.MIN_CHUNK_SIZE&&(t=Math.ceil(o.byteLength/2));const a=o.slice(0,t),c=await n.default.crypto.hash(a);i+=a.byteLength,r.push({dataHash:c,minByteRange:i-a.byteLength,maxByteRange:i}),o=o.slice(t)}return r.push({dataHash:await n.default.crypto.hash(o),minByteRange:i,maxByteRange:i+o.byteLength}),r}async function c(t){return Promise.all(t.map((async({dataHash:t,minByteRange:e,maxByteRange:r})=>({type:"leaf",id:await g(await Promise.all([g(t),g(y(r))])),dataHash:t,minByteRange:e,maxByteRange:r}))))}async function u(t){return await l(await c(await a(t)))}async function l(t,e=0){if(t.length<2){return t[0]}const r=[];for(let e=0;e<t.length;e+=2)r.push(await p(t[e],t[e+1]));return l(r,e+1)}function h(t){const e=f(t);return Array.isArray(e)?d(e):[e]}function f(t,e=new Uint8Array,r=0){if("leaf"==t.type)return{offset:t.maxByteRange-1,proof:(0,o.concatBuffers)([e,t.dataHash,y(t.maxByteRange)])};if("branch"==t.type){const n=(0,o.concatBuffers)([e,t.leftChild.id,t.rightChild.id,y(t.byteRange)]);return[f(t.leftChild,n,r+1),f(t.rightChild,n,r+1)]}throw new Error("Unexpected node type")}function d(t){const e=[];return t.forEach((t=>{Array.isArray(t)?e.push(...d(t)):e.push(t)})),e}async function p(t,e){if(!e)return t;return{type:"branch",id:await g([await g(t.id),await g(e.id),await g(y(t.maxByteRange))]),byteRange:t.maxByteRange,maxByteRange:e.maxByteRange,leftChild:t,rightChild:e}}async function g(t){return Array.isArray(t)&&(t=n.default.utils.concatBuffers(t)),new Uint8Array(await n.default.crypto.hash(t))}function y(t){const e=new Uint8Array(i);for(var r=e.length-1;r>=0;r--){var n=t%256;e[r]=n,t=(t-n)/256}return e}function w(t){let e=0;for(var r=0;r<t.length;r++)e*=256,e+=t[r];return e}e.chunkData=a,e.generateLeaves=c,e.computeRootHash=async function(t){return(await u(t)).id},e.generateTree=u,e.generateTransactionChunks=async function(t){const e=await a(t),r=await c(e),n=await l(r),o=await h(n),i=e.slice(-1)[0];return i.maxByteRange-i.minByteRange==0&&(e.splice(e.length-1,1),o.splice(o.length-1,1)),{data_root:n.id,chunks:e,proofs:o}},e.buildLayers=l,e.generateProofs=h,e.arrayFlatten=d,e.intToBuffer=y,e.bufferToInt=w;e.arrayCompare=(t,e)=>t.every(((t,r)=>e[r]===t)),e.validatePath=async function t(r,n,o,a,c){if(a<=0)return!1;if(n>=a)return t(r,0,a-1,a,c);if(n<0)return t(r,0,0,a,c);if(c.length==s+i){const t=c.slice(0,s),n=c.slice(t.length,t.length+i),u=await g([await g(t),await g(n)]);return!!(0,e.arrayCompare)(r,u)&&{offset:a-1,leftBound:o,rightBound:a,chunkSize:a-o}}const u=c.slice(0,s),l=c.slice(u.length,u.length+s),h=c.slice(u.length+l.length,u.length+l.length+i),f=w(h),d=c.slice(u.length+l.length+h.length),p=await g([await g(u),await g(l),await g(h)]);return!!(0,e.arrayCompare)(r,p)&&(n<f?await t(u,n,o,Math.min(a,f),d):await t(l,n,Math.max(o,f),a,d))},e.debug=async function t(e,r=""){if(e.byteLength<1)return r;const n=e.slice(0,s),o=e.slice(n.length,n.length+s),a=e.slice(n.length+o.length,n.length+o.length+i),c=w(a),u=e.slice(n.length+o.length+a.length),l=await g([await g(n),await g(o),await g(a)]);return t(u,`${r}\n${JSON.stringify(Buffer.from(n))},${JSON.stringify(Buffer.from(o))},${c} => ${JSON.stringify(l)}`)}},246:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransactionUploader=void 0;const n=r(825),o=r(244),i=r(498),s=r(224),a=["invalid_json","chunk_too_big","data_path_too_big","offset_too_big","data_size_too_big","chunk_proof_ratio_not_attractive","invalid_proof"];class c{api;chunkIndex=0;txPosted=!1;transaction;lastRequestTimeEnd=0;totalErrors=0;data;lastResponseStatus=0;lastResponseError="";get isComplete(){return this.txPosted&&this.chunkIndex===this.transaction.chunks.chunks.length}get totalChunks(){return this.transaction.chunks.chunks.length}get uploadedChunks(){return this.chunkIndex}get pctComplete(){return Math.trunc(this.uploadedChunks/this.totalChunks*100)}constructor(t,e){if(this.api=t,!e.id)throw new Error("Transaction is not signed");if(!e.chunks)throw new Error("Transaction chunks not prepared");this.data=e.data,this.transaction=new n.default(Object.assign({},e,{data:new Uint8Array(0)}))}async uploadChunk(t){if(this.isComplete)throw new Error("Upload is already complete");if(""!==this.lastResponseError?this.totalErrors++:this.totalErrors=0,100===this.totalErrors)throw new Error(`Unable to complete upload: ${this.lastResponseStatus}: ${this.lastResponseError}`);let e=""===this.lastResponseError?0:Math.max(this.lastRequestTimeEnd+4e4-Date.now(),4e4);if(e>0&&(e-=e*Math.random()*.3,await new Promise((t=>setTimeout(t,e)))),this.lastResponseError="",!this.txPosted)return void await this.postTransaction();t&&(this.chunkIndex=t);const r=this.transaction.getChunk(t||this.chunkIndex,this.data);if(!await(0,s.validatePath)(this.transaction.chunks.data_root,parseInt(r.offset),0,parseInt(r.data_size),o.b64UrlToBuffer(r.data_path)))throw new Error(`Unable to validate chunk ${this.chunkIndex}`);const n=await this.api.post("chunk",this.transaction.getChunk(this.chunkIndex,this.data)).catch((t=>(console.error(t.message),{status:-1,data:{error:t.message}})));if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=n.status,200==this.lastResponseStatus)this.chunkIndex++;else if(this.lastResponseError=(0,i.getError)(n),a.includes(this.lastResponseError))throw new Error(`Fatal error uploading chunk ${this.chunkIndex}: ${this.lastResponseError}`)}static async fromSerialized(t,e,r){if(!e||"number"!=typeof e.chunkIndex||"object"!=typeof e.transaction)throw new Error("Serialized object does not match expected format.");var o=new n.default(e.transaction);o.chunks||await o.prepareChunks(r);const i=new c(t,o);if(i.chunkIndex=e.chunkIndex,i.lastRequestTimeEnd=e.lastRequestTimeEnd,i.lastResponseError=e.lastResponseError,i.lastResponseStatus=e.lastResponseStatus,i.txPosted=e.txPosted,i.data=r,i.transaction.data_root!==e.transaction.data_root)throw new Error("Data mismatch: Uploader doesn't match provided data.");return i}static async fromTransactionId(t,e){const r=await t.get(`tx/${e}`);if(200!==r.status)throw new Error(`Tx ${e} not found: ${r.status}`);const n=r.data;n.data=new Uint8Array(0);return{txPosted:!0,chunkIndex:0,lastResponseError:"",lastRequestTimeEnd:0,lastResponseStatus:0,transaction:n}}toJSON(){return{chunkIndex:this.chunkIndex,transaction:this.transaction,lastRequestTimeEnd:this.lastRequestTimeEnd,lastResponseStatus:this.lastResponseStatus,lastResponseError:this.lastResponseError,txPosted:this.txPosted}}async postTransaction(){if(this.totalChunks<=1){this.transaction.data=this.data;const t=await this.api.post("tx",this.transaction).catch((t=>(console.error(t),{status:-1,data:{error:t.message}})));if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=t.status,this.transaction.data=new Uint8Array(0),t.status>=200&&t.status<300)return this.txPosted=!0,void(this.chunkIndex=1);throw this.lastResponseError=(0,i.getError)(t),new Error(`Unable to upload transaction: ${t.status}, ${this.lastResponseError}`)}const t=await this.api.post("tx",this.transaction);if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=t.status,!(t.status>=200&&t.status<300))throw this.lastResponseError=(0,i.getError)(t),new Error(`Unable to upload transaction: ${t.status}, ${this.lastResponseError}`);this.txPosted=!0}}e.TransactionUploader=c},825:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;const n=r(244),o=r(921),i=r(224);class s{get(t,e){if(!Object.getOwnPropertyNames(this).includes(t))throw new Error(`Field "${t}" is not a property of the Arweave Transaction class.`);if(this[t]instanceof Uint8Array)return e&&e.decode&&e.string?n.bufferToString(this[t]):e&&e.decode&&!e.string?this[t]:n.bufferTob64Url(this[t]);if(this[t]instanceof Array){if(void 0!==e?.decode||void 0!==e?.string)throw"tags"===t&&console.warn("Did you mean to use 'transaction[\"tags\"]' ?"),new Error("Cannot decode or stringify an array.");return this[t]}return e&&1==e.decode?e&&e.string?n.b64UrlToString(this[t]):n.b64UrlToBuffer(this[t]):this[t]}}class a extends s{name;value;constructor(t,e,r=!1){super(),this.name=t,this.value=e}}e.Tag=a;e.default=class extends s{format=2;id="";last_tx="";owner="";tags=[];target="";quantity="0";data_size="0";data=new Uint8Array;data_root="";reward="0";signature="";chunks;constructor(t={}){super(),Object.assign(this,t),"string"==typeof this.data&&(this.data=n.b64UrlToBuffer(this.data)),t.tags&&(this.tags=t.tags.map((t=>new a(t.name,t.value))))}addTag(t,e){this.tags.push(new a(n.stringToB64Url(t),n.stringToB64Url(e)))}toJSON(){return{format:this.format,id:this.id,last_tx:this.last_tx,owner:this.owner,tags:this.tags,target:this.target,quantity:this.quantity,data:n.bufferTob64Url(this.data),data_size:this.data_size,data_root:this.data_root,data_tree:this.data_tree,reward:this.reward,signature:this.signature}}setOwner(t){this.owner=t}setSignature({id:t,owner:e,reward:r,tags:n,signature:o}){this.id=t,this.owner=e,r&&(this.reward=r),n&&(this.tags=n),this.signature=o}async prepareChunks(t){!this.chunks&&t.byteLength>0&&(this.chunks=await(0,i.generateTransactionChunks)(t),this.data_root=n.bufferTob64Url(this.chunks.data_root)),this.chunks||0!==t.byteLength||(this.chunks={chunks:[],data_root:new Uint8Array,proofs:[]},this.data_root="")}getChunk(t,e){if(!this.chunks)throw new Error("Chunks have not been prepared");const r=this.chunks.proofs[t],o=this.chunks.chunks[t];return{data_root:this.data_root,data_size:this.data_size,data_path:n.bufferTob64Url(r.proof),offset:r.offset.toString(),chunk:n.bufferTob64Url(e.slice(o.minByteRange,o.maxByteRange))}}async getSignatureData(){switch(this.format){case 1:let t=this.tags.reduce(((t,e)=>n.concatBuffers([t,e.get("name",{decode:!0,string:!1}),e.get("value",{decode:!0,string:!1})])),new Uint8Array);return n.concatBuffers([this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),this.get("data",{decode:!0,string:!1}),n.stringToBuffer(this.quantity),n.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),t]);case 2:this.data_root||await this.prepareChunks(this.data);const e=this.tags.map((t=>[t.get("name",{decode:!0,string:!1}),t.get("value",{decode:!0,string:!1})]));return await(0,o.default)([n.stringToBuffer(this.format.toString()),this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),n.stringToBuffer(this.quantity),n.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),e,n.stringToBuffer(this.data_size),this.get("data_root",{decode:!0,string:!1})]);default:throw new Error(`Unexpected transaction format: ${this.format}`)}}}},244:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.b64UrlDecode=e.b64UrlEncode=e.bufferTob64Url=e.bufferTob64=e.b64UrlToBuffer=e.stringToB64Url=e.stringToBuffer=e.bufferToString=e.b64UrlToString=e.concatBuffers=void 0;const n=r(742);function o(t){return new TextDecoder("utf-8",{fatal:!0}).decode(t)}function i(t){return(new TextEncoder).encode(t)}function s(t){return new Uint8Array(n.toByteArray(l(t)))}function a(t){return n.fromByteArray(new Uint8Array(t))}function c(t){return u(a(t))}function u(t){try{return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}catch(t){throw new Error("Failed to encode string",{cause:t})}}function l(t){try{let e;return e=(t=t.replace(/\-/g,"+").replace(/\_/g,"/")).length%4==0?0:4-t.length%4,t.concat("=".repeat(e))}catch(t){throw new Error("Failed to decode string",{cause:t})}}e.concatBuffers=function(t){let e=0;for(let r=0;r<t.length;r++)e+=t[r].byteLength;let r=new Uint8Array(e),n=0;r.set(new Uint8Array(t[0]),n),n+=t[0].byteLength;for(let e=1;e<t.length;e++)r.set(new Uint8Array(t[e]),n),n+=t[e].byteLength;return r},e.b64UrlToString=function(t){return o(s(t))},e.bufferToString=o,e.stringToBuffer=i,e.stringToB64Url=function(t){return c(i(t))},e.b64UrlToBuffer=s,e.bufferTob64=a,e.bufferTob64Url=c,e.b64UrlEncode=u,e.b64UrlDecode=l},118:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultConfig=void 0;e.getDefaultConfig=(t,e)=>{if(((t,e)=>{const r=/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,n=e.split("."),o=n[n.length-1],i=["localhost","[::1]"];return i.includes(e)||"file"==t||i.includes(o)||!!e.match(r)||!!o.match(r)})(t,e))return{protocol:"https",host:"arweave.net",port:443};if(!(t=>{const e="["===t.charAt(0);return!!t.match(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/)||e})(e)){let r=e.split(".");if(r.length>=3){r.shift();return{protocol:t,host:r.join(".")}}}return{protocol:t,host:e}}},248:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{api;constructor(t){this.api=t}getInfo(){return this.api.get("info").then((t=>t.data))}getPeers(){return this.api.get("peers").then((t=>t.data))}}},243:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SiloResource=void 0;const n=r(244);e.default=class{api;crypto;transactions;constructor(t,e,r){this.api=t,this.crypto=e,this.transactions=r}async get(t){if(!t)throw new Error("No Silo URI specified");const e=await this.parseUri(t),r=await this.transactions.search("Silo-Name",e.getAccessKey());if(0==r.length)throw new Error(`No data could be found for the Silo URI: ${t}`);const n=await this.transactions.get(r[0]);if(!n)throw new Error(`No data could be found for the Silo URI: ${t}`);const o=n.get("data",{decode:!0,string:!1});return this.crypto.decrypt(o,e.getEncryptionKey())}async readTransactionData(t,e){if(!e)throw new Error("No Silo URI specified");const r=await this.parseUri(e),n=t.get("data",{decode:!0,string:!1});return this.crypto.decrypt(n,r.getEncryptionKey())}async parseUri(t){const e=t.match(/^([a-z0-9-_]+)\.([0-9]+)/i);if(!e)throw new Error("Invalid Silo name, must be a name in the format of [a-z0-9]+.[0-9]+, e.g. 'bubble.7'");const r=e[1],i=Math.pow(2,parseInt(e[2])),s=await this.hash(n.stringToBuffer(r),i),a=n.bufferTob64(s.slice(0,15)),c=await this.hash(s.slice(16,31),1);return new o(t,a,c)}async hash(t,e){let r=await this.crypto.hash(t);for(let t=0;t<e-1;t++)r=await this.crypto.hash(r);return r}};class o{uri;accessKey;encryptionKey;constructor(t,e,r){this.uri=t,this.accessKey=e,this.encryptionKey=r}getUri(){return this.uri}getAccessKey(){return this.accessKey}getEncryptionKey(){return this.encryptionKey}}e.SiloResource=o},935:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(498),o=r(825),i=r(244),s=r(246);r(317);e.default=class{api;crypto;chunks;constructor(t,e,r){this.api=t,this.crypto=e,this.chunks=r}async getTransactionAnchor(){const t=await this.api.get("tx_anchor");if(!t.data.match(/^[a-z0-9_-]{43,}/i)||!t.ok)throw new Error(`Could not getTransactionAnchor. Received: ${t.data}. Status: ${t.status}, ${t.statusText}`);return t.data}async getPrice(t,e){let r=e?`price/${t}/${e}`:`price/${t}`;const n=await this.api.get(r);if(!/^\d+$/.test(n.data)||!n.ok)throw new Error(`Could not getPrice. Received: ${n.data}. Status: ${n.status}, ${n.statusText}`);return n.data}async get(t){const e=await this.api.get(`tx/${t}`);if(200==e.status){const r=parseInt(e.data.data_size);if(e.data.format>=2&&r>0&&r<=12582912){const r=await this.getData(t);return new o.default({...e.data,data:r})}return new o.default({...e.data,format:e.data.format||1})}if(404==e.status)throw new n.default("TX_NOT_FOUND");if(410==e.status)throw new n.default("TX_FAILED");throw new n.default("TX_INVALID")}fromRaw(t){return new o.default(t)}async search(t,e){return this.api.post("arql",{op:"equals",expr1:t,expr2:e}).then((t=>t.data?t.data:[]))}getStatus(t){return this.api.get(`tx/${t}/status`).then((t=>200==t.status?{status:200,confirmed:t.data}:{status:t.status,confirmed:null}))}async getData(t,e){let r;try{r=await this.chunks.downloadChunkedData(t)}catch(e){console.error(`Error while trying to download chunked data for ${t}`),console.error(e)}if(!r){console.warn(`Falling back to gateway cache for ${t}`);try{const{data:e,ok:n,status:o,statusText:i}=await this.api.get(`/${t}`,{responseType:"arraybuffer"});if(!n)throw new Error("Bad http status code",{cause:{status:o,statusText:i}});r=e}catch(e){console.error(`Error while trying to download contiguous data from gateway cache for ${t}`),console.error(e)}}if(!r)throw new Error(`${t} data was not found!`);return e&&e.decode&&!e.string?r:e&&e.decode&&e.string?i.bufferToString(r):i.bufferTob64Url(r)}async sign(t,e,r){const n="object"==typeof e&&(t=>{let e=!0;return["n","e","d","p","q","dp","dq","qi"].map((r=>!(r in t)&&(e=!1))),e})(e),o="object"==typeof arweaveWallet;if(!n&&!o)throw new Error("No valid JWK or external wallet found to sign transaction.");if(n){t.setOwner(e.n);let n=await t.getSignatureData(),o=await this.crypto.sign(e,n,r),s=await this.crypto.hash(o);t.setSignature({id:i.bufferTob64Url(s),owner:e.n,signature:i.bufferTob64Url(o)})}else{if(!o)throw new Error("An error occurred while signing. Check wallet is valid");{try{(await arweaveWallet.getPermissions()).includes("SIGN_TRANSACTION")||await arweaveWallet.connect(["SIGN_TRANSACTION"])}catch{}const e=await arweaveWallet.sign(t,r);t.setSignature({id:e.id,owner:e.owner,reward:e.reward,tags:e.tags,signature:e.signature})}}}async verify(t){const e=await t.getSignatureData(),r=t.get("signature",{decode:!0,string:!1}),n=i.bufferTob64Url(await this.crypto.hash(r));if(t.id!==n)throw new Error("Invalid transaction signature or ID! The transaction ID doesn't match the expected SHA-256 hash of the signature.");return this.crypto.verify(t.owner,e,r)}async post(t){if("string"==typeof t?t=new o.default(JSON.parse(t)):"function"==typeof t.readInt32BE?t=new o.default(JSON.parse(t.toString())):"object"!=typeof t||t instanceof o.default||(t=new o.default(t)),!(t instanceof o.default))throw new Error("Must be Transaction object");t.chunks||await t.prepareChunks(t.data);const e=await this.getUploader(t,t.data);try{for(;!e.isComplete;)await e.uploadChunk()}catch(t){if(e.lastResponseStatus>0)return{status:e.lastResponseStatus,statusText:e.lastResponseError,data:{error:e.lastResponseError}};throw t}return{status:200,statusText:"OK",data:{}}}async getUploader(t,e){let r;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),t instanceof o.default){if(e||(e=t.data),!(e instanceof Uint8Array))throw new Error("Data format is invalid");t.chunks||await t.prepareChunks(e),r=new s.TransactionUploader(this.api,t),r.data&&0!==r.data.length||(r.data=e)}else{if("string"==typeof t&&(t=await s.TransactionUploader.fromTransactionId(this.api,t)),!(e&&e instanceof Uint8Array))throw new Error("Must provide data when resuming upload");r=await s.TransactionUploader.fromSerialized(this.api,t,e)}return r}async*upload(t,e){const r=await this.getUploader(t,e);for(;!r.isComplete;)await r.uploadChunk(),yield r;return r}}},927:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(244);r(317);e.default=class{api;crypto;constructor(t,e){this.api=t,this.crypto=e}getBalance(t){return this.api.get(`wallet/${t}/balance`).then((t=>t.data))}getLastTransactionID(t){return this.api.get(`wallet/${t}/last_tx`).then((t=>t.data))}generate(){return this.crypto.generateJWK()}async jwkToAddress(t){return t&&"use_wallet"!==t?this.getAddress(t):this.getAddress()}async getAddress(t){if(t&&"use_wallet"!==t)return this.ownerToAddress(t.n);try{await arweaveWallet.connect(["ACCESS_ADDRESS"])}catch{}return arweaveWallet.getActiveAddress()}async ownerToAddress(t){return n.bufferTob64Url(await this.crypto.hash(n.b64UrlToBuffer(t)))}}},742:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=a(t),s=i[0],c=i[1],u=new o(function(t,e,r){return 3*(e+r)/4-r}(0,s,c)),l=0,h=c>0?s-4:s;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[l++]=255&e);1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=16383,a=0,u=n-o;a<u;a+=s)i.push(c(t,a,a+s>u?u:a+s));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=i[s],n[i.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var o,i,s=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},431:function(t,e,r){var n;!function(o){"use strict";var i,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,c=Math.floor,u="[BigNumber Error] ",l=u+"Number primitive has more than 15 significant digits: ",h=1e14,f=14,d=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,y=1e9;function w(t){var e=0|t;return t>0||t===e?e:e-1}function m(t){for(var e,r,n=1,o=t.length,i=t[0]+"";n<o;){for(e=t[n++]+"",r=f-e.length;r--;e="0"+e);i+=e}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function b(t,e){var r,n,o=t.c,i=e.c,s=t.s,a=e.s,c=t.e,u=e.e;if(!s||!a)return null;if(r=o&&!o[0],n=i&&!i[0],r||n)return r?n?0:-a:s;if(s!=a)return s;if(r=s<0,n=c==u,!o||!i)return n?0:!o^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=o.length)<(u=i.length)?c:u,s=0;s<a;s++)if(o[s]!=i[s])return o[s]>i[s]^r?1:-1;return c==u?0:c>u^r?1:-1}function v(t,e,r,n){if(t<e||t>r||t!==c(t))throw Error(u+(n||"Argument")+("number"==typeof t?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function _(t){var e=t.c.length-1;return w(t.e/f)==e&&t.c[e]%2!=0}function E(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function S(t,e,r){var n,o;if(e<0){for(o=r+".";++e;o+=r);t=o+t}else if(++e>(n=t.length)){for(o=r,e-=n;--e;o+=r);t+=o}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}i=function t(e){var r,n,o,i,A,T,k,I,O,R,C=z.prototype={constructor:z,toString:null,valueOf:null},U=new z(1),B=20,P=4,L=-7,x=21,N=-1e7,j=1e7,D=!1,K=1,M=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},F="0123456789abcdefghijklmnopqrstuvwxyz",W=!0;function z(t,e){var r,i,a,u,h,p,g,y,w=this;if(!(w instanceof z))return new z(t,e);if(null==e){if(t&&!0===t._isBigNumber)return w.s=t.s,void(!t.c||t.e>j?w.c=w.e=null:t.e<N?w.c=[w.e=0]:(w.e=t.e,w.c=t.c.slice()));if((p="number"==typeof t)&&0*t==0){if(w.s=1/t<0?(t=-t,-1):1,t===~~t){for(u=0,h=t;h>=10;h/=10,u++);return void(u>j?w.c=w.e=null:(w.e=u,w.c=[t]))}y=String(t)}else{if(!s.test(y=String(t)))return o(w,y,p);w.s=45==y.charCodeAt(0)?(y=y.slice(1),-1):1}(u=y.indexOf("."))>-1&&(y=y.replace(".","")),(h=y.search(/e/i))>0?(u<0&&(u=h),u+=+y.slice(h+1),y=y.substring(0,h)):u<0&&(u=y.length)}else{if(v(e,2,F.length,"Base"),10==e&&W)return X(w=new z(t),B+w.e+1,P);if(y=String(t),p="number"==typeof t){if(0*t!=0)return o(w,y,p,e);if(w.s=1/t<0?(y=y.slice(1),-1):1,z.DEBUG&&y.replace(/^0\.0*|\./,"").length>15)throw Error(l+t)}else w.s=45===y.charCodeAt(0)?(y=y.slice(1),-1):1;for(r=F.slice(0,e),u=h=0,g=y.length;h<g;h++)if(r.indexOf(i=y.charAt(h))<0){if("."==i){if(h>u){u=g;continue}}else if(!a&&(y==y.toUpperCase()&&(y=y.toLowerCase())||y==y.toLowerCase()&&(y=y.toUpperCase()))){a=!0,h=-1,u=0;continue}return o(w,String(t),p,e)}p=!1,(u=(y=n(y,e,10,w.s)).indexOf("."))>-1?y=y.replace(".",""):u=y.length}for(h=0;48===y.charCodeAt(h);h++);for(g=y.length;48===y.charCodeAt(--g););if(y=y.slice(h,++g)){if(g-=h,p&&z.DEBUG&&g>15&&(t>d||t!==c(t)))throw Error(l+w.s*t);if((u=u-h-1)>j)w.c=w.e=null;else if(u<N)w.c=[w.e=0];else{if(w.e=u,w.c=[],h=(u+1)%f,u<0&&(h+=f),h<g){for(h&&w.c.push(+y.slice(0,h)),g-=f;h<g;)w.c.push(+y.slice(h,h+=f));h=f-(y=y.slice(h)).length}else h-=g;for(;h--;y+="0");w.c.push(+y)}}else w.c=[w.e=0]}function Z(t,e,r,n){var o,i,s,a,c;if(null==r?r=P:v(r,0,8),!t.c)return t.toString();if(o=t.c[0],s=t.e,null==e)c=m(t.c),c=1==n||2==n&&(s<=L||s>=x)?E(c,s):S(c,s,"0");else if(i=(t=X(new z(t),e,r)).e,a=(c=m(t.c)).length,1==n||2==n&&(e<=i||i<=L)){for(;a<e;c+="0",a++);c=E(c,i)}else if(e-=s,c=S(c,i,"0"),i+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=i-a)>0)for(i+1==a&&(c+=".");e--;c+="0");return t.s<0&&o?"-"+c:c}function H(t,e){for(var r,n,o=1,i=new z(t[0]);o<t.length;o++)(!(n=new z(t[o])).s||(r=b(i,n))===e||0===r&&i.s===e)&&(i=n);return i}function V(t,e,r){for(var n=1,o=e.length;!e[--o];e.pop());for(o=e[0];o>=10;o/=10,n++);return(r=n+r*f-1)>j?t.c=t.e=null:r<N?t.c=[t.e=0]:(t.e=r,t.c=e),t}function X(t,e,r,n){var o,i,s,u,l,d,g,y=t.c,w=p;if(y){t:{for(o=1,u=y[0];u>=10;u/=10,o++);if((i=e-o)<0)i+=f,s=e,l=y[d=0],g=c(l/w[o-s-1]%10);else if((d=a((i+1)/f))>=y.length){if(!n)break t;for(;y.length<=d;y.push(0));l=g=0,o=1,s=(i%=f)-f+1}else{for(l=u=y[d],o=1;u>=10;u/=10,o++);g=(s=(i%=f)-f+o)<0?0:c(l/w[o-s-1]%10)}if(n=n||e<0||null!=y[d+1]||(s<0?l:l%w[o-s-1]),n=r<4?(g||n)&&(0==r||r==(t.s<0?3:2)):g>5||5==g&&(4==r||n||6==r&&(i>0?s>0?l/w[o-s]:0:y[d-1])%10&1||r==(t.s<0?8:7)),e<1||!y[0])return y.length=0,n?(e-=t.e+1,y[0]=w[(f-e%f)%f],t.e=-e||0):y[0]=t.e=0,t;if(0==i?(y.length=d,u=1,d--):(y.length=d+1,u=w[f-i],y[d]=s>0?c(l/w[o-s]%w[s])*u:0),n)for(;;){if(0==d){for(i=1,s=y[0];s>=10;s/=10,i++);for(s=y[0]+=u,u=1;s>=10;s/=10,u++);i!=u&&(t.e++,y[0]==h&&(y[0]=1));break}if(y[d]+=u,y[d]!=h)break;y[d--]=0,u=1}for(i=y.length;0===y[--i];y.pop());}t.e>j?t.c=t.e=null:t.e<N&&(t.c=[t.e=0])}return t}function J(t){var e,r=t.e;return null===r?t.toString():(e=m(t.c),e=r<=L||r>=x?E(e,r):S(e,r,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(u+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(v(r=t[e],0,y,e),B=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(v(r=t[e],0,8,e),P=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(v(r[0],-y,0,e),v(r[1],0,y,e),L=r[0],x=r[1]):(v(r,-y,y,e),L=-(x=r<0?-r:r))),t.hasOwnProperty(e="RANGE"))if((r=t[e])&&r.pop)v(r[0],-y,-1,e),v(r[1],1,y,e),N=r[0],j=r[1];else{if(v(r,-y,y,e),!r)throw Error(u+e+" cannot be zero: "+r);N=-(j=r<0?-r:r)}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(u+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!r,Error(u+"crypto unavailable");D=r}else D=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(v(r=t[e],0,9,e),K=r),t.hasOwnProperty(e="POW_PRECISION")&&(v(r=t[e],0,y,e),M=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(u+e+" not an object: "+r);$=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(u+e+" invalid: "+r);W="0123456789"==r.slice(0,10),F=r}}return{DECIMAL_PLACES:B,ROUNDING_MODE:P,EXPONENTIAL_AT:[L,x],RANGE:[N,j],CRYPTO:D,MODULO_MODE:K,POW_PRECISION:M,FORMAT:$,ALPHABET:F}},z.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!z.DEBUG)return!0;var e,r,n=t.c,o=t.e,i=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===i||-1===i)&&o>=-y&&o<=y&&o===c(o)){if(0===n[0]){if(0===o&&1===n.length)return!0;break t}if((e=(o+1)%f)<1&&(e+=f),String(n[0]).length==e){for(e=0;e<n.length;e++)if((r=n[e])<0||r>=h||r!==c(r))break t;if(0!==r)return!0}}}else if(null===n&&null===o&&(null===i||1===i||-1===i))return!0;throw Error(u+"Invalid BigNumber: "+t)},z.maximum=z.max=function(){return H(arguments,-1)},z.minimum=z.min=function(){return H(arguments,1)},z.random=(i=9007199254740992,A=Math.random()*i&2097151?function(){return c(Math.random()*i)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,n,o,i,s=0,l=[],h=new z(U);if(null==t?t=B:v(t,0,y),o=a(t/f),D)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(o*=2));s<o;)(i=131072*e[s]+(e[s+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[s]=r[0],e[s+1]=r[1]):(l.push(i%1e14),s+=2);s=o/2}else{if(!crypto.randomBytes)throw D=!1,Error(u+"crypto unavailable");for(e=crypto.randomBytes(o*=7);s<o;)(i=281474976710656*(31&e[s])+1099511627776*e[s+1]+4294967296*e[s+2]+16777216*e[s+3]+(e[s+4]<<16)+(e[s+5]<<8)+e[s+6])>=9e15?crypto.randomBytes(7).copy(e,s):(l.push(i%1e14),s+=7);s=o/7}if(!D)for(;s<o;)(i=A())<9e15&&(l[s++]=i%1e14);for(o=l[--s],t%=f,o&&t&&(i=p[f-t],l[s]=c(o/i)*i);0===l[s];l.pop(),s--);if(s<0)l=[n=0];else{for(n=-1;0===l[0];l.splice(0,1),n-=f);for(s=1,i=l[0];i>=10;i/=10,s++);s<f&&(n-=f-s)}return h.e=n,h.c=l,h}),z.sum=function(){for(var t=1,e=arguments,r=new z(e[0]);t<e.length;)r=r.plus(e[t++]);return r},n=function(){var t="0123456789";function e(t,e,r,n){for(var o,i,s=[0],a=0,c=t.length;a<c;){for(i=s.length;i--;s[i]*=e);for(s[0]+=n.indexOf(t.charAt(a++)),o=0;o<s.length;o++)s[o]>r-1&&(null==s[o+1]&&(s[o+1]=0),s[o+1]+=s[o]/r|0,s[o]%=r)}return s.reverse()}return function(n,o,i,s,a){var c,u,l,h,f,d,p,g,y=n.indexOf("."),w=B,b=P;for(y>=0&&(h=M,M=0,n=n.replace(".",""),d=(g=new z(o)).pow(n.length-y),M=h,g.c=e(S(m(d.c),d.e,"0"),10,i,t),g.e=g.c.length),l=h=(p=e(n,o,i,a?(c=F,t):(c=t,F))).length;0==p[--h];p.pop());if(!p[0])return c.charAt(0);if(y<0?--l:(d.c=p,d.e=l,d.s=s,p=(d=r(d,g,w,b,i)).c,f=d.r,l=d.e),y=p[u=l+w+1],h=i/2,f=f||u<0||null!=p[u+1],f=b<4?(null!=y||f)&&(0==b||b==(d.s<0?3:2)):y>h||y==h&&(4==b||f||6==b&&1&p[u-1]||b==(d.s<0?8:7)),u<1||!p[0])n=f?S(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,f)for(--i;++p[--u]>i;)p[u]=0,u||(++l,p=[1].concat(p));for(h=p.length;!p[--h];);for(y=0,n="";y<=h;n+=c.charAt(p[y++]));n=S(n,l,c.charAt(0))}return n}}(),r=function(){function t(t,e,r){var n,o,i,s,a=0,c=t.length,u=e%g,l=e/g|0;for(t=t.slice();c--;)a=((o=u*(i=t[c]%g)+(n=l*i+(s=t[c]/g|0)*u)%g*g+a)/r|0)+(n/g|0)+l*s,t[c]=o%r;return a&&(t=[a].concat(t)),t}function e(t,e,r,n){var o,i;if(r!=n)i=r>n?1:-1;else for(o=i=0;o<r;o++)if(t[o]!=e[o]){i=t[o]>e[o]?1:-1;break}return i}function r(t,e,r,n){for(var o=0;r--;)t[r]-=o,o=t[r]<e[r]?1:0,t[r]=o*n+t[r]-e[r];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,o,i,s,a){var u,l,d,p,g,y,m,b,v,_,E,S,A,T,k,I,O,R=n.s==o.s?1:-1,C=n.c,U=o.c;if(!(C&&C[0]&&U&&U[0]))return new z(n.s&&o.s&&(C?!U||C[0]!=U[0]:U)?C&&0==C[0]||!U?0*R:R/0:NaN);for(v=(b=new z(R)).c=[],R=i+(l=n.e-o.e)+1,a||(a=h,l=w(n.e/f)-w(o.e/f),R=R/f|0),d=0;U[d]==(C[d]||0);d++);if(U[d]>(C[d]||0)&&l--,R<0)v.push(1),p=!0;else{for(T=C.length,I=U.length,d=0,R+=2,(g=c(a/(U[0]+1)))>1&&(U=t(U,g,a),C=t(C,g,a),I=U.length,T=C.length),A=I,E=(_=C.slice(0,I)).length;E<I;_[E++]=0);O=U.slice(),O=[0].concat(O),k=U[0],U[1]>=a/2&&k++;do{if(g=0,(u=e(U,_,I,E))<0){if(S=_[0],I!=E&&(S=S*a+(_[1]||0)),(g=c(S/k))>1)for(g>=a&&(g=a-1),m=(y=t(U,g,a)).length,E=_.length;1==e(y,_,m,E);)g--,r(y,I<m?O:U,m,a),m=y.length,u=1;else 0==g&&(u=g=1),m=(y=U.slice()).length;if(m<E&&(y=[0].concat(y)),r(_,y,E,a),E=_.length,-1==u)for(;e(U,_,I,E)<1;)g++,r(_,I<E?O:U,E,a),E=_.length}else 0===u&&(g++,_=[0]);v[d++]=g,_[0]?_[E++]=C[A]||0:(_=[C[A]],E=1)}while((A++<T||null!=_[0])&&R--);p=null!=_[0],v[0]||v.splice(0,1)}if(a==h){for(d=1,R=v[0];R>=10;R/=10,d++);X(b,i+(b.e=d+l*f-1)+1,s,p)}else b.e=l,b.r=+p;return b}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,I=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,o=function(t,e,r,n){var o,i=r?e:e.replace(R,"");if(O.test(i))t.s=isNaN(i)?null:i<0?-1:1;else{if(!r&&(i=i.replace(T,(function(t,e,r){return o="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=o?t:e})),n&&(o=n,i=i.replace(k,"$1").replace(I,"0.$1")),e!=i))return new z(i,o);if(z.DEBUG)throw Error(u+"Not a"+(n?" base "+n:"")+" number: "+e);t.s=null}t.c=t.e=null},C.absoluteValue=C.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},C.comparedTo=function(t,e){return b(this,new z(t,e))},C.decimalPlaces=C.dp=function(t,e){var r,n,o,i=this;if(null!=t)return v(t,0,y),null==e?e=P:v(e,0,8),X(new z(i),t+i.e+1,e);if(!(r=i.c))return null;if(n=((o=r.length-1)-w(this.e/f))*f,o=r[o])for(;o%10==0;o/=10,n--);return n<0&&(n=0),n},C.dividedBy=C.div=function(t,e){return r(this,new z(t,e),B,P)},C.dividedToIntegerBy=C.idiv=function(t,e){return r(this,new z(t,e),0,1)},C.exponentiatedBy=C.pow=function(t,e){var r,n,o,i,s,l,h,d,p=this;if((t=new z(t)).c&&!t.isInteger())throw Error(u+"Exponent not an integer: "+J(t));if(null!=e&&(e=new z(e)),s=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return d=new z(Math.pow(+J(p),s?t.s*(2-_(t)):+J(t))),e?d.mod(e):d;if(l=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(n=!l&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||s&&p.c[1]>=24e7:p.c[0]<8e13||s&&p.c[0]<=9999975e7)))return i=p.s<0&&_(t)?-0:0,p.e>-1&&(i=1/i),new z(l?1/i:i);M&&(i=a(M/f+2))}for(s?(r=new z(.5),l&&(t.s=1),h=_(t)):h=(o=Math.abs(+J(t)))%2,d=new z(U);;){if(h){if(!(d=d.times(p)).c)break;i?d.c.length>i&&(d.c.length=i):n&&(d=d.mod(e))}if(o){if(0===(o=c(o/2)))break;h=o%2}else if(X(t=t.times(r),t.e+1,1),t.e>14)h=_(t);else{if(0===(o=+J(t)))break;h=o%2}p=p.times(p),i?p.c&&p.c.length>i&&(p.c.length=i):n&&(p=p.mod(e))}return n?d:(l&&(d=U.div(d)),e?d.mod(e):i?X(d,M,P,undefined):d)},C.integerValue=function(t){var e=new z(this);return null==t?t=P:v(t,0,8),X(e,e.e+1,t)},C.isEqualTo=C.eq=function(t,e){return 0===b(this,new z(t,e))},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(t,e){return b(this,new z(t,e))>0},C.isGreaterThanOrEqualTo=C.gte=function(t,e){return 1===(e=b(this,new z(t,e)))||0===e},C.isInteger=function(){return!!this.c&&w(this.e/f)>this.c.length-2},C.isLessThan=C.lt=function(t,e){return b(this,new z(t,e))<0},C.isLessThanOrEqualTo=C.lte=function(t,e){return-1===(e=b(this,new z(t,e)))||0===e},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&0==this.c[0]},C.minus=function(t,e){var r,n,o,i,s=this,a=s.s;if(e=(t=new z(t,e)).s,!a||!e)return new z(NaN);if(a!=e)return t.s=-e,s.plus(t);var c=s.e/f,u=t.e/f,l=s.c,d=t.c;if(!c||!u){if(!l||!d)return l?(t.s=-e,t):new z(d?s:NaN);if(!l[0]||!d[0])return d[0]?(t.s=-e,t):new z(l[0]?s:3==P?-0:0)}if(c=w(c),u=w(u),l=l.slice(),a=c-u){for((i=a<0)?(a=-a,o=l):(u=c,o=d),o.reverse(),e=a;e--;o.push(0));o.reverse()}else for(n=(i=(a=l.length)<(e=d.length))?a:e,a=e=0;e<n;e++)if(l[e]!=d[e]){i=l[e]<d[e];break}if(i&&(o=l,l=d,d=o,t.s=-t.s),(e=(n=d.length)-(r=l.length))>0)for(;e--;l[r++]=0);for(e=h-1;n>a;){if(l[--n]<d[n]){for(r=n;r&&!l[--r];l[r]=e);--l[r],l[n]+=h}l[n]-=d[n]}for(;0==l[0];l.splice(0,1),--u);return l[0]?V(t,l,u):(t.s=3==P?-1:1,t.c=[t.e=0],t)},C.modulo=C.mod=function(t,e){var n,o,i=this;return t=new z(t,e),!i.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||i.c&&!i.c[0]?new z(i):(9==K?(o=t.s,t.s=1,n=r(i,t,0,3),t.s=o,n.s*=o):n=r(i,t,0,K),(t=i.minus(n.times(t))).c[0]||1!=K||(t.s=i.s),t)},C.multipliedBy=C.times=function(t,e){var r,n,o,i,s,a,c,u,l,d,p,y,m,b,v,_=this,E=_.c,S=(t=new z(t,e)).c;if(!(E&&S&&E[0]&&S[0]))return!_.s||!t.s||E&&!E[0]&&!S||S&&!S[0]&&!E?t.c=t.e=t.s=null:(t.s*=_.s,E&&S?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=w(_.e/f)+w(t.e/f),t.s*=_.s,(c=E.length)<(d=S.length)&&(m=E,E=S,S=m,o=c,c=d,d=o),o=c+d,m=[];o--;m.push(0));for(b=h,v=g,o=d;--o>=0;){for(r=0,p=S[o]%v,y=S[o]/v|0,i=o+(s=c);i>o;)r=((u=p*(u=E[--s]%v)+(a=y*u+(l=E[s]/v|0)*p)%v*v+m[i]+r)/b|0)+(a/v|0)+y*l,m[i--]=u%b;m[i]=r}return r?++n:m.splice(0,1),V(t,m,n)},C.negated=function(){var t=new z(this);return t.s=-t.s||null,t},C.plus=function(t,e){var r,n=this,o=n.s;if(e=(t=new z(t,e)).s,!o||!e)return new z(NaN);if(o!=e)return t.s=-e,n.minus(t);var i=n.e/f,s=t.e/f,a=n.c,c=t.c;if(!i||!s){if(!a||!c)return new z(o/0);if(!a[0]||!c[0])return c[0]?t:new z(a[0]?n:0*o)}if(i=w(i),s=w(s),a=a.slice(),o=i-s){for(o>0?(s=i,r=c):(o=-o,r=a),r.reverse();o--;r.push(0));r.reverse()}for((o=a.length)-(e=c.length)<0&&(r=c,c=a,a=r,e=o),o=0;e;)o=(a[--e]=a[e]+c[e]+o)/h|0,a[e]=h===a[e]?0:a[e]%h;return o&&(a=[o].concat(a),++s),V(t,a,s)},C.precision=C.sd=function(t,e){var r,n,o,i=this;if(null!=t&&t!==!!t)return v(t,1,y),null==e?e=P:v(e,0,8),X(new z(i),t,e);if(!(r=i.c))return null;if(n=(o=r.length-1)*f+1,o=r[o]){for(;o%10==0;o/=10,n--);for(o=r[0];o>=10;o/=10,n++);}return t&&i.e+1>n&&(n=i.e+1),n},C.shiftedBy=function(t){return v(t,-9007199254740991,d),this.times("1e"+t)},C.squareRoot=C.sqrt=function(){var t,e,n,o,i,s=this,a=s.c,c=s.s,u=s.e,l=B+4,h=new z("0.5");if(1!==c||!a||!a[0])return new z(!c||c<0&&(!a||a[0])?NaN:a?s:1/0);if(0==(c=Math.sqrt(+J(s)))||c==1/0?(((e=m(a)).length+u)%2==0&&(e+="0"),c=Math.sqrt(+e),u=w((u+1)/2)-(u<0||u%2),n=new z(e=c==1/0?"5e"+u:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+u)):n=new z(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(i=n,n=h.times(i.plus(r(s,i,l,1))),m(i.c).slice(0,c)===(e=m(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(e=e.slice(c-3,c+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(X(n,n.e+B+2,1),t=!n.times(n).eq(s));break}if(!o&&(X(i,i.e+B+2,0),i.times(i).eq(s))){n=i;break}l+=4,c+=4,o=1}return X(n,n.e+B+1,P,t)},C.toExponential=function(t,e){return null!=t&&(v(t,0,y),t++),Z(this,t,e,1)},C.toFixed=function(t,e){return null!=t&&(v(t,0,y),t=t+this.e+1),Z(this,t,e)},C.toFormat=function(t,e,r){var n,o=this;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=$;else if("object"!=typeof r)throw Error(u+"Argument not an object: "+r);if(n=o.toFixed(t,e),o.c){var i,s=n.split("."),a=+r.groupSize,c=+r.secondaryGroupSize,l=r.groupSeparator||"",h=s[0],f=s[1],d=o.s<0,p=d?h.slice(1):h,g=p.length;if(c&&(i=a,a=c,c=i,g-=i),a>0&&g>0){for(i=g%a||a,h=p.substr(0,i);i<g;i+=a)h+=l+p.substr(i,a);c>0&&(h+=l+p.slice(i)),d&&(h="-"+h)}n=f?h+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):h}return(r.prefix||"")+n+(r.suffix||"")},C.toFraction=function(t){var e,n,o,i,s,a,c,l,h,d,g,y,w=this,b=w.c;if(null!=t&&(!(c=new z(t)).isInteger()&&(c.c||1!==c.s)||c.lt(U)))throw Error(u+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+J(c));if(!b)return new z(w);for(e=new z(U),h=n=new z(U),o=l=new z(U),y=m(b),s=e.e=y.length-w.e-1,e.c[0]=p[(a=s%f)<0?f+a:a],t=!t||c.comparedTo(e)>0?s>0?e:h:c,a=j,j=1/0,c=new z(y),l.c[0]=0;d=r(c,e,0,1),1!=(i=n.plus(d.times(o))).comparedTo(t);)n=o,o=i,h=l.plus(d.times(i=h)),l=i,e=c.minus(d.times(i=e)),c=i;return i=r(t.minus(n),o,0,1),l=l.plus(i.times(h)),n=n.plus(i.times(o)),l.s=h.s=w.s,g=r(h,o,s*=2,P).minus(w).abs().comparedTo(r(l,n,s,P).minus(w).abs())<1?[h,o]:[l,n],j=a,g},C.toNumber=function(){return+J(this)},C.toPrecision=function(t,e){return null!=t&&v(t,1,y),Z(this,t,e,2)},C.toString=function(t){var e,r=this,o=r.s,i=r.e;return null===i?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(null==t?e=i<=L||i>=x?E(m(r.c),i):S(m(r.c),i,"0"):10===t&&W?e=S(m((r=X(new z(r),B+i+1,P)).c),r.e,"0"):(v(t,2,F.length,"Base"),e=n(S(m(r.c),i,"0"),10,t,o,!0)),o<0&&r.c[0]&&(e="-"+e)),e},C.valueOf=C.toJSON=function(){return J(this)},C._isBigNumber=!0,null!=e&&z.set(e),z}(),i.default=i.BigNumber=i,void 0===(n=function(){return i}.call(e,r,e,t))||(t.exports=n)}()},764:(t,e,r)=>{"use strict";const n=r(742),o=r(645),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.lW=c,e.h2=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|g(t,e);let n=a(r);const o=n.write(t,e);o!==r&&(n=n.slice(0,o));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(J(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(J(t,ArrayBuffer)||t&&J(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(J(t,SharedArrayBuffer)||t&&J(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);const o=function(t){if(c.isBuffer(t)){const e=0|p(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||q(t.length)?a(0):f(t);if("Buffer"===t.type&&Array.isArray(t.data))return f(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return l(t),a(t<0?0:0|p(t))}function f(t){const e=t.length<0?0:0|p(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function p(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function g(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||J(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(t).length;default:if(o)return n?-1:H(t).length;e=(""+e).toLowerCase(),o=!0}}function y(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,r);case"utf8":case"utf-8":return k(this,e,r);case"ascii":return O(this,e,r);case"latin1":case"binary":return R(this,e,r);case"base64":return T(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function w(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),q(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:b(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):b(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,o){let i,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let n=-1;for(i=r;i<a;i++)if(u(t,i)===u(e,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===c)return n*s}else-1!==n&&(i-=i-n),n=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){let r=!0;for(let n=0;n<c;n++)if(u(t,i+n)!==u(e,n)){r=!1;break}if(r)return i}return-1}function v(t,e,r,n){r=Number(r)||0;const o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;const i=e.length;let s;for(n>i/2&&(n=i/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(q(n))return s;t[r+s]=n}return s}function _(t,e,r,n){return X(H(e,t.length-r),t,r,n)}function E(t,e,r,n){return X(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function S(t,e,r,n){return X(V(e),t,r,n)}function A(t,e,r,n){return X(function(t,e){let r,n,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function T(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function k(t,e,r){r=Math.min(t.length,r);const n=[];let o=e;for(;o<r;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(i=e);break;case 2:r=t[o+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(i=c));break;case 3:r=t[o+1],n=t[o+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=t[o+1],n=t[o+2],a=t[o+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),o+=s}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=I));return r}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return l(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=c.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(J(e,Uint8Array))o+e.length>n.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(n,o)):Uint8Array.prototype.set.call(n,e,o);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)w(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?k(this,0,t):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const r=e.h2;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},i&&(c.prototype[i]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,o){if(J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;let i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0);const a=Math.min(i,s),u=this.slice(n,o),l=t.slice(e,r);for(let t=0;t<a;++t)if(u[t]!==l[t]){i=u[t],s=l[t];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return _(this,t,e,r);case"ascii":case"latin1":case"binary":return E(this,t,e,r);case"base64":return S(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function O(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function R(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function C(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let o="";for(let n=e;n<r;++n)o+=G[t[n]];return o}function U(t,e,r){const n=t.slice(e,r);let o="";for(let t=0;t<n.length-1;t+=2)o+=String.fromCharCode(n[t]+256*n[t+1]);return o}function B(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,r,n,o,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function L(t,e,r,n,o){F(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function x(t,e,r,n,o){F(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r+7]=i,i>>=8,t[r+6]=i,i>>=8,t[r+5]=i,i>>=8,t[r+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function N(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(t,e,r,n,i){return e=+e,r>>>=0,i||N(t,0,r,4),o.write(t,e,r,n,23,4),r+4}function D(t,e,r,n,i){return e=+e,r>>>=0,i||N(t,0,r,8),o.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);let n=this[t+--e],o=1;for(;e>0&&(o*=256);)n+=this[t+--e]*o;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=Y((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))})),c.prototype.readBigUInt64BE=Y((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(o)})),c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);let n=e,o=1,i=this[t+--n];for(;n>0&&(o*=256);)i+=this[t+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||B(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||B(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=Y((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=Y((function(t){W(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||B(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||B(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||B(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||B(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){P(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){P(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=Y((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Y((function(t,e=0){return x(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}let o=0,i=1,s=0;for(this[e]=255&t;++o<r&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}let o=r-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=Y((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Y((function(t,e=0){return x(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,r){return j(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return j(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return D(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return D(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{const i=c.isBuffer(t)?t:c.from(t,n),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=i[o%s]}return this};const K={};function M(t,e,r){K[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function $(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function F(t,e,r,n,o,i){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new K.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,r){W(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||z(e,t.length-(r+1))}(n,o,i)}function W(t,e){if("number"!=typeof t)throw new K.ERR_INVALID_ARG_TYPE(e,"number",t)}function z(t,e,r){if(Math.floor(t)!==t)throw W(t,r),new K.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new K.ERR_BUFFER_OUT_OF_BOUNDS;throw new K.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=$(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=$(o)),o+="n"),n+=` It must be ${e}. Received ${o}`,n}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function H(t,e){let r;e=e||1/0;const n=t.length;let o=null;const i=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function V(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(Z,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function X(t,e,r,n){let o;for(o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function J(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function q(t){return t!=t}const G=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let o=0;o<16;++o)e[n+o]=t[r]+t[o]}return e}();function Y(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}},470:t=>{"use strict";var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===r.call(t)},s=function(t){if(!t||"[object Object]"!==r.call(t))return!1;var n,o=e.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!o&&!i)return!1;for(n in t);return void 0===n||e.call(t,n)},a=function(t,e){n&&"__proto__"===e.name?n(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},c=function(t,r){if("__proto__"===r){if(!e.call(t,r))return;if(o)return o(t,r).value}return t[r]};t.exports=function t(){var e,r,n,o,u,l,h=arguments[0],f=1,d=arguments.length,p=!1;for("boolean"==typeof h&&(p=h,h=arguments[1]||{},f=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});f<d;++f)if(null!=(e=arguments[f]))for(r in e)n=c(h,r),h!==(o=c(e,r))&&(p&&o&&(s(o)||(u=i(o)))?(u?(u=!1,l=n&&i(n)?n:[]):l=n&&s(n)?n:{},a(h,{name:r,newValue:t(p,l,o)})):void 0!==o&&a(h,{name:r,newValue:o}));return h}},645:(t,e)=>{e.read=function(t,e,r,n,o){var i,s,a=8*o-n-1,c=(1<<a)-1,u=c>>1,l=-7,h=r?o-1:0,f=r?-1:1,d=t[e+h];for(h+=f,i=d&(1<<-l)-1,d>>=-l,l+=a;l>0;i=256*i+t[e+h],h+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),i-=u}return(d?-1:1)*s*Math.pow(2,i-n)},e.write=function(t,e,r,n,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,h=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[r+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[r+d]=255&s,d+=p,s/=256,u-=8);t[r+d-p]|=128*g}},639:e=>{"use strict";e.exports=t}},s={};function a(t){var e=s[t];if(void 0!==e)return e.exports;var r=s[t]={exports:{}};return i[t].call(r.exports,r,r.exports,a),r.exports}a.m=i,a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},r=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,a.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var o=Object.create(null);a.r(o);var i={};e=e||[null,r({}),r([]),r(r)];for(var s=2&n&&t;"object"==typeof s&&!~e.indexOf(s);s=r(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,a.d(o,i),o},a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.f={},a.e=t=>Promise.all(Object.keys(a.f).reduce(((e,r)=>(a.f[r](t,e),e)),[])),a.u=t=>t+".onairos.bundle.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n={},o="onairos:",a.l=(t,e,r,i)=>{if(n[t])n[t].push(e);else{var s,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==o+r){s=h;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",o+r),s.src=t),n[t]=[e];var f=(e,r)=>{s.onerror=s.onload=null,clearTimeout(d);var o=n[t];if(delete n[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(r))),e)return e(r)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}},a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&!t;)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t})(),(()=>{var t={179:0};a.f.j=(e,r)=>{var n=a.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=t[e]=[r,o]));r.push(n[2]=o);var i=a.p+a.u(e),s=new Error;a.l(i,(r=>{if(a.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,n[1](s)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,o,i=r[0],s=r[1],c=r[2],u=0;if(i.some((e=>0!==t[e]))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(c)c(a)}for(e&&e(r);u<i.length;u++)o=i[u],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=this.webpackChunkonairos=this.webpackChunkonairos||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var c={};return(()=>{"use strict";a.r(c),a.d(c,{Onairos:()=>gh,default:()=>yh});var t={};a.r(t),a.d(t,{hasBrowserEnv:()=>ee,hasStandardBrowserEnv:()=>re,hasStandardBrowserWebWorkerEnv:()=>oe});var e=a(639),r=a.n(e),n=a(764);function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}"function"==typeof SuppressedError&&SuppressedError;var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{};function s(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function u(t,e){return t(e={exports:{}},e.exports),e.exports}var l=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){var t=this;this.locked=new Map,this.addToLocked=function(e,r){var n=t.locked.get(e);void 0===n?void 0===r?t.locked.set(e,[]):t.locked.set(e,[r]):void 0!==r&&(n.unshift(r),t.locked.set(e,n))},this.isLocked=function(e){return t.locked.has(e)},this.lock=function(e){return new Promise((function(r,n){t.isLocked(e)?t.addToLocked(e,r):(t.addToLocked(e),r())}))},this.unlock=function(e){var r=t.locked.get(e);if(void 0!==r&&0!==r.length){var n=r.pop();t.locked.set(e,r),void 0!==n&&setTimeout(n,0)}else t.locked.delete(e)}}return t.getInstance=function(){return void 0===t.instance&&(t.instance=new t),t.instance},t}();e.default=function(){return r.getInstance()}}));s(l);var h=s(u((function(t,e){var r=i&&i.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r((function(e){e(t.value)})).then(s,a)}c((n=n.apply(t,e||[])).next())}))},n=i&&i.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},o=i;Object.defineProperty(e,"__esModule",{value:!0});var s="browser-tabs-lock-key",a={key:function(t){return r(o,void 0,void 0,(function(){return n(this,(function(t){throw new Error("Unsupported")}))}))},getItem:function(t){return r(o,void 0,void 0,(function(){return n(this,(function(t){throw new Error("Unsupported")}))}))},clear:function(){return r(o,void 0,void 0,(function(){return n(this,(function(t){return[2,window.localStorage.clear()]}))}))},removeItem:function(t){return r(o,void 0,void 0,(function(){return n(this,(function(t){throw new Error("Unsupported")}))}))},setItem:function(t,e){return r(o,void 0,void 0,(function(){return n(this,(function(t){throw new Error("Unsupported")}))}))},keySync:function(t){return window.localStorage.key(t)},getItemSync:function(t){return window.localStorage.getItem(t)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(t){return window.localStorage.removeItem(t)},setItemSync:function(t,e){return window.localStorage.setItem(t,e)}};function c(t){return new Promise((function(e){return setTimeout(e,t)}))}function u(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",n=0;n<t;n++)r+=e[Math.floor(61*Math.random())];return r}var h=function(){function t(e){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+u(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=e,void 0===t.waiters&&(t.waiters=[])}return t.prototype.acquireLock=function(e,o){return void 0===o&&(o=5e3),r(this,void 0,void 0,(function(){var r,i,l,h,f,d,p;return n(this,(function(n){switch(n.label){case 0:r=Date.now()+u(4),i=Date.now()+o,l=s+"-"+e,h=void 0===this.storageHandler?a:this.storageHandler,n.label=1;case 1:return Date.now()<i?[4,c(30)]:[3,8];case 2:return n.sent(),null!==h.getItemSync(l)?[3,5]:(f=this.id+"-"+e+"-"+r,[4,c(Math.floor(25*Math.random()))]);case 3:return n.sent(),h.setItemSync(l,JSON.stringify({id:this.id,iat:r,timeoutKey:f,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,c(30)];case 4:return n.sent(),null!==(d=h.getItemSync(l))&&(p=JSON.parse(d)).id===this.id&&p.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(l,r),[2,!0]):[3,7];case 5:return t.lockCorrector(void 0===this.storageHandler?a:this.storageHandler),[4,this.waitForSomethingToChange(i)];case 6:n.sent(),n.label=7;case 7:return r=Date.now()+u(4),[3,1];case 8:return[2,!1]}}))}))},t.prototype.refreshLockWhileAcquired=function(t,e){return r(this,void 0,void 0,(function(){var o=this;return n(this,(function(i){return setTimeout((function(){return r(o,void 0,void 0,(function(){var r,o,i;return n(this,(function(n){switch(n.label){case 0:return[4,l.default().lock(e)];case 1:return n.sent(),this.acquiredIatSet.has(e)?(r=void 0===this.storageHandler?a:this.storageHandler,null===(o=r.getItemSync(t))?(l.default().unlock(e),[2]):((i=JSON.parse(o)).timeRefreshed=Date.now(),r.setItemSync(t,JSON.stringify(i)),l.default().unlock(e),this.refreshLockWhileAcquired(t,e),[2])):(l.default().unlock(e),[2])}}))}))}),1e3),[2]}))}))},t.prototype.waitForSomethingToChange=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){var n=!1,o=Date.now(),i=!1;function s(){if(i||(window.removeEventListener("storage",s),t.removeFromWaiting(s),clearTimeout(a),i=!0),!n){n=!0;var e=50-(Date.now()-o);e>0?setTimeout(r,e):r(null)}}window.addEventListener("storage",s),t.addToWaiting(s);var a=setTimeout(s,Math.max(0,e-Date.now()))}))];case 1:return r.sent(),[2]}}))}))},t.addToWaiting=function(e){this.removeFromWaiting(e),void 0!==t.waiters&&t.waiters.push(e)},t.removeFromWaiting=function(e){void 0!==t.waiters&&(t.waiters=t.waiters.filter((function(t){return t!==e})))},t.notifyWaiters=function(){void 0!==t.waiters&&t.waiters.slice().forEach((function(t){return t()}))},t.prototype.releaseLock=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.releaseLock__private__(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.releaseLock__private__=function(e){return r(this,void 0,void 0,(function(){var r,o,i,c;return n(this,(function(n){switch(n.label){case 0:return r=void 0===this.storageHandler?a:this.storageHandler,o=s+"-"+e,null===(i=r.getItemSync(o))?[2]:(c=JSON.parse(i)).id!==this.id?[3,2]:[4,l.default().lock(c.iat)];case 1:n.sent(),this.acquiredIatSet.delete(c.iat),r.removeItemSync(o),l.default().unlock(c.iat),t.notifyWaiters(),n.label=2;case 2:return[2]}}))}))},t.lockCorrector=function(e){for(var r=Date.now()-5e3,n=e,o=[],i=0;;){var a=n.keySync(i);if(null===a)break;o.push(a),i++}for(var c=!1,u=0;u<o.length;u++){var l=o[u];if(l.includes(s)){var h=n.getItemSync(l);if(null!==h){var f=JSON.parse(h);(void 0===f.timeRefreshed&&f.timeAcquired<r||void 0!==f.timeRefreshed&&f.timeRefreshed<r)&&(n.removeItemSync(l),c=!0)}}}c&&t.notifyWaiters()},t.waiters=void 0,t}();e.default=h})));const f={timeoutInSeconds:60},d={name:"auth0-spa-js",version:"2.1.3"},p=()=>Date.now();class g extends Error{constructor(t,e){super(e),this.error=t,this.error_description=e,Object.setPrototypeOf(this,g.prototype)}static fromPayload({error:t,error_description:e}){return new g(t,e)}}class y extends g{constructor(t,e,r,n=null){super(t,e),this.state=r,this.appState=n,Object.setPrototypeOf(this,y.prototype)}}class w extends g{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,w.prototype)}}class m extends w{constructor(t){super(),this.popup=t,Object.setPrototypeOf(this,m.prototype)}}class b extends g{constructor(t){super("cancelled","Popup closed"),this.popup=t,Object.setPrototypeOf(this,b.prototype)}}class v extends g{constructor(t,e,r){super(t,e),this.mfa_token=r,Object.setPrototypeOf(this,v.prototype)}}class _ extends g{constructor(t,e){super("missing_refresh_token",`Missing Refresh Token (audience: '${E(t,["default"])}', scope: '${E(e)}')`),this.audience=t,this.scope=e,Object.setPrototypeOf(this,_.prototype)}}function E(t,e=[]){return t&&!e.includes(t)?t:""}const S=()=>window.crypto,A=()=>{const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let e="";return Array.from(S().getRandomValues(new Uint8Array(43))).forEach((r=>e+=t[r%66])),e},T=t=>btoa(t),k=t=>{var{clientId:e}=t,r=o(t,["clientId"]);return new URLSearchParams((t=>Object.keys(t).filter((e=>void 0!==t[e])).reduce(((e,r)=>Object.assign(Object.assign({},e),{[r]:t[r]})),{}))(Object.assign({client_id:e},r))).toString()},I=t=>(t=>decodeURIComponent(atob(t).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))(t.replace(/_/g,"/").replace(/-/g,"+")),O=async(t,e)=>{const r=await fetch(t,e);return{ok:r.ok,json:await r.json()}},R=async(t,e,r,n,o,i,s=1e4)=>o?(async(t,e,r,n,o,i,s)=>{return a={auth:{audience:e,scope:r},timeout:o,fetchUrl:t,fetchOptions:n,useFormData:s},c=i,new Promise((function(t,e){const r=new MessageChannel;r.port1.onmessage=function(n){n.data.error?e(new Error(n.data.error)):t(n.data),r.port1.close()},c.postMessage(a,[r.port2])}));var a,c})(t,e,r,n,s,o,i):(async(t,e,r)=>{const n=new AbortController;let o;return e.signal=n.signal,Promise.race([O(t,e),new Promise(((t,e)=>{o=setTimeout((()=>{n.abort(),e(new Error("Timeout when executing 'fetch'"))}),r)}))]).finally((()=>{clearTimeout(o)}))})(t,n,s);async function C(t,e){var{baseUrl:r,timeout:n,audience:i,scope:s,auth0Client:a,useFormData:c}=t,u=o(t,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const l=c?k(u):JSON.stringify(u);return await async function(t,e,r,n,i,s,a){let c,u=null;for(let o=0;o<3;o++)try{c=await R(t,r,n,i,s,a,e),u=null;break}catch(t){u=t}if(u)throw u;const l=c.json,{error:h,error_description:f}=l,d=o(l,["error","error_description"]),{ok:p}=c;if(!p){const e=f||`HTTP error. Unable to fetch ${t}`;if("mfa_required"===h)throw new v(h,e,d.mfa_token);if("missing_refresh_token"===h)throw new _(r,n);throw new g(h||"request_error",e)}return d}(`${r}/oauth/token`,n,i||"default",s,{method:"POST",body:l,headers:{"Content-Type":c?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(a||d))}},e,c)}const U=(...t)=>{return(e=t.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(e))).join(" ");var e};class B{constructor(t,e="@@auth0spajs@@",r){this.prefix=e,this.suffix=r,this.clientId=t.clientId,this.scope=t.scope,this.audience=t.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(t){const[e,r,n,o]=t.split("::");return new B({clientId:r,scope:o,audience:n},e)}static fromCacheEntry(t){const{scope:e,audience:r,client_id:n}=t;return new B({scope:e,audience:r,clientId:n})}}class P{set(t,e){localStorage.setItem(t,JSON.stringify(e))}get(t){const e=window.localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(t){return}}remove(t){localStorage.removeItem(t)}allKeys(){return Object.keys(window.localStorage).filter((t=>t.startsWith("@@auth0spajs@@")))}}class L{constructor(){this.enclosedCache=function(){let t={};return{set(e,r){t[e]=r},get(e){const r=t[e];if(r)return r},remove(e){delete t[e]},allKeys:()=>Object.keys(t)}}()}}class x{constructor(t,e,r){this.cache=t,this.keyManifest=e,this.nowProvider=r||p}async setIdToken(t,e,r){var n;const o=this.getIdTokenCacheKey(t);await this.cache.set(o,{id_token:e,decodedToken:r}),await(null===(n=this.keyManifest)||void 0===n?void 0:n.add(o))}async getIdToken(t){const e=await this.cache.get(this.getIdTokenCacheKey(t.clientId));if(!e&&t.scope&&t.audience){const e=await this.get(t);if(!e)return;if(!e.id_token||!e.decodedToken)return;return{id_token:e.id_token,decodedToken:e.decodedToken}}if(e)return{id_token:e.id_token,decodedToken:e.decodedToken}}async get(t,e=0){var r;let n=await this.cache.get(t.toKey());if(!n){const e=await this.getCacheKeys();if(!e)return;const r=this.matchExistingCacheKey(t,e);r&&(n=await this.cache.get(r))}if(!n)return;const o=await this.nowProvider(),i=Math.floor(o/1e3);return n.expiresAt-e<i?n.body.refresh_token?(n.body={refresh_token:n.body.refresh_token},await this.cache.set(t.toKey(),n),n.body):(await this.cache.remove(t.toKey()),void await(null===(r=this.keyManifest)||void 0===r?void 0:r.remove(t.toKey()))):n.body}async set(t){var e;const r=new B({clientId:t.client_id,scope:t.scope,audience:t.audience}),n=await this.wrapCacheEntry(t);await this.cache.set(r.toKey(),n),await(null===(e=this.keyManifest)||void 0===e?void 0:e.add(r.toKey()))}async clear(t){var e;const r=await this.getCacheKeys();r&&(await r.filter((e=>!t||e.includes(t))).reduce((async(t,e)=>{await t,await this.cache.remove(e)}),Promise.resolve()),await(null===(e=this.keyManifest)||void 0===e?void 0:e.clear()))}async wrapCacheEntry(t){const e=await this.nowProvider();return{body:t,expiresAt:Math.floor(e/1e3)+t.expires_in}}async getCacheKeys(){var t;return this.keyManifest?null===(t=await this.keyManifest.get())||void 0===t?void 0:t.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(t){return new B({clientId:t},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(t,e){return e.filter((e=>{var r;const n=B.fromKey(e),o=new Set(n.scope&&n.scope.split(" ")),i=(null===(r=t.scope)||void 0===r?void 0:r.split(" "))||[],s=n.scope&&i.reduce(((t,e)=>t&&o.has(e)),!0);return"@@auth0spajs@@"===n.prefix&&n.clientId===t.clientId&&n.audience===t.audience&&s}))[0]}}class N{constructor(t,e,r){this.storage=t,this.clientId=e,this.cookieDomain=r,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(t){this.storage.save(this.storageKey,t,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}}const j=t=>"number"==typeof t,D=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"];var K=u((function(t,e){var r=i&&i.__assign||function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){if(!e)return"";var r="; "+t;return!0===e?r:r+"="+e}function o(t,e,r){return encodeURIComponent(t).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(e).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(t){if("number"==typeof t.expires){var e=new Date;e.setMilliseconds(e.getMilliseconds()+864e5*t.expires),t.expires=e}return n("Expires",t.expires?t.expires.toUTCString():"")+n("Domain",t.domain)+n("Path",t.path)+n("Secure",t.secure)+n("SameSite",t.sameSite)}(r)}function s(t){for(var e={},r=t?t.split("; "):[],n=/(%[\dA-F]{2})+/gi,o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{e[i[0].replace(n,decodeURIComponent)]=s.replace(n,decodeURIComponent)}catch(t){}}return e}function a(){return s(document.cookie)}function c(t,e,n){document.cookie=o(t,e,r({path:"/"},n))}e.__esModule=!0,e.encode=o,e.parse=s,e.getAll=a,e.get=function(t){return a()[t]},e.set=c,e.remove=function(t,e){c(t,"",r(r({},e),{expires:-1}))}}));s(K),K.encode,K.parse,K.getAll;var M=K.get,$=K.set,F=K.remove;const W={get(t){const e=M(t);if(void 0!==e)return JSON.parse(e)},save(t,e,r){let n={};"https:"===window.location.protocol&&(n={secure:!0,sameSite:"none"}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),$(t,JSON.stringify(e),n)},remove(t,e){let r={};(null==e?void 0:e.cookieDomain)&&(r.domain=e.cookieDomain),F(t,r)}},z={get:t=>W.get(t)||W.get(`_legacy_${t}`),save(t,e,r){let n={};"https:"===window.location.protocol&&(n={secure:!0}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),$(`_legacy_${t}`,JSON.stringify(e),n),W.save(t,e,r)},remove(t,e){let r={};(null==e?void 0:e.cookieDomain)&&(r.domain=e.cookieDomain),F(t,r),W.remove(t,e),W.remove(`_legacy_${t}`,e)}},Z={get(t){if("undefined"==typeof sessionStorage)return;const e=sessionStorage.getItem(t);return null!=e?JSON.parse(e):void 0},save(t,e){sessionStorage.setItem(t,JSON.stringify(e))},remove(t){sessionStorage.removeItem(t)}};var H,V=("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",null,!1,function(t){return H=H||function(t,e,r){var n=void 0===e?null:e,o=function(t,e){var r=atob(t);if(e){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(t,void 0!==r&&r),i=o.indexOf("\n",10)+1,s=o.substring(i)+(n?"//# sourceMappingURL="+n:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",null,false),new Worker(H,t)});const X={};class J{constructor(t,e){this.cache=t,this.clientId=e,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(t){var e;const r=new Set((null===(e=await this.cache.get(this.manifestKey))||void 0===e?void 0:e.keys)||[]);r.add(t),await this.cache.set(this.manifestKey,{keys:[...r]})}async remove(t){const e=await this.cache.get(this.manifestKey);if(e){const r=new Set(e.keys);return r.delete(t),r.size>0?await this.cache.set(this.manifestKey,{keys:[...r]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(t){return`@@auth0spajs@@::${t}`}}const q={memory:()=>(new L).enclosedCache,localstorage:()=>new P},G=t=>q[t],Y=t=>{const{openUrl:e,onRedirect:r}=t,n=o(t,["openUrl","onRedirect"]);return Object.assign(Object.assign({},n),{openUrl:!1===e||e?e:r})},Q=new h;class tt{constructor(t){let e,r;if(this.userCache=(new L).enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await Q.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),t),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),t.authorizationParams)}),"undefined"!=typeof window&&(()=>{if(!S())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===S().subtle)throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")})(),t.cache&&t.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),t.cache)r=t.cache;else{if(e=t.cacheLocation||"memory",!G(e))throw new Error(`Invalid cache location "${e}"`);r=G(e)()}this.httpTimeoutMs=t.httpTimeoutInSeconds?1e3*t.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===t.legacySameSiteCookie?W:z,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(t=>`auth0.${this.options.clientId}.is.authenticated`)(),this.sessionCheckExpiryDays=t.sessionCheckExpiryDays||1;const n=t.useCookiesForTransactions?this.cookieStorage:Z;var o;this.scope=U("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new N(n,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||p,this.cacheManager=new x(r,r.allKeys?void 0:new J(r,this.options.clientId),this.nowProvider),this.domainUrl=(o=this.options.domain,/^https?:\/\//.test(o)?o:`https://${o}`),this.tokenIssuer=((t,e)=>t?t.startsWith("https://")?t:`https://${t}/`:`${e}/`)(this.options.issuer,this.domainUrl),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===e&&(this.options.workerUrl?this.worker=new Worker(this.options.workerUrl):this.worker=new V)}_url(t){const e=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||d)));return`${this.domainUrl}${t}&auth0Client=${e}`}_authorizeUrl(t){return this._url(`/authorize?${k(t)}`)}async _verifyIdToken(t,e,r){const n=await this.nowProvider();return(t=>{if(!t.id_token)throw new Error("ID token is required but missing");const e=(t=>{const e=t.split("."),[r,n,o]=e;if(3!==e.length||!r||!n||!o)throw new Error("ID token could not be decoded");const i=JSON.parse(I(n)),s={__raw:t},a={};return Object.keys(i).forEach((t=>{s[t]=i[t],D.includes(t)||(a[t]=i[t])})),{encoded:{header:r,payload:n,signature:o},header:JSON.parse(I(r)),claims:s,user:a}})(t.id_token);if(!e.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(e.claims.iss!==t.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${t.iss}", found "${e.claims.iss}"`);if(!e.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==e.header.alg)throw new Error(`Signature algorithm of "${e.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!e.claims.aud||"string"!=typeof e.claims.aud&&!Array.isArray(e.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(e.claims.aud)){if(!e.claims.aud.includes(t.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but was not one of "${e.claims.aud.join(", ")}"`);if(e.claims.aud.length>1){if(!e.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(e.claims.azp!==t.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${t.aud}", found "${e.claims.azp}"`)}}else if(e.claims.aud!==t.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but found "${e.claims.aud}"`);if(t.nonce){if(!e.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(e.claims.nonce!==t.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${t.nonce}", found "${e.claims.nonce}"`)}if(t.max_age&&!j(e.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(null==e.claims.exp||!j(e.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!j(e.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const r=t.leeway||60,n=new Date(t.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(e.claims.exp+r),n>o)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${n}) is after expiration time (${o})`);if(null!=e.claims.nbf&&j(e.claims.nbf)){const t=new Date(0);if(t.setUTCSeconds(e.claims.nbf-r),n<t)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${n}) is before ${t}`)}if(null!=e.claims.auth_time&&j(e.claims.auth_time)){const o=new Date(0);if(o.setUTCSeconds(parseInt(e.claims.auth_time)+t.max_age+r),n>o)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${n}) is after last auth at ${o}`)}if(t.organization){const r=t.organization.trim();if(r.startsWith("org_")){const t=r;if(!e.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(t!==e.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${t}", found "${e.claims.org_id}"`)}else{const t=r.toLowerCase();if(!e.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(t!==e.claims.org_name)throw new Error(`Organization Name (org_name) claim mismatch in the ID token; expected "${t}", found "${e.claims.org_name}"`)}}return e})({iss:this.tokenIssuer,aud:this.options.clientId,id_token:t,nonce:e,organization:r,leeway:this.options.leeway,max_age:(o=this.options.authorizationParams.max_age,"string"!=typeof o?o:parseInt(o,10)||void 0),now:n});var o}_processOrgHint(t){t?this.cookieStorage.save(this.orgHintCookieName,t,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(t,e,r){const n=T(A()),o=T(A()),i=A(),s=(t=>{const e=new Uint8Array(t);return(t=>{const e={"+":"-","/":"_","=":""};return t.replace(/[+/=]/g,(t=>e[t]))})(window.btoa(String.fromCharCode(...Array.from(e))))})(await(async t=>{const e=S().subtle.digest({name:"SHA-256"},(new TextEncoder).encode(t));return await e})(i)),a=((t,e,r,n,o,i,s,a)=>Object.assign(Object.assign(Object.assign({client_id:t.clientId},t.authorizationParams),r),{scope:U(e,r.scope),response_type:"code",response_mode:a||"query",state:n,nonce:o,redirect_uri:s||t.authorizationParams.redirect_uri,code_challenge:i,code_challenge_method:"S256"}))(this.options,this.scope,t,n,o,s,t.redirect_uri||this.options.authorizationParams.redirect_uri||r,null==e?void 0:e.response_mode),c=this._authorizeUrl(a);return{nonce:o,code_verifier:i,scope:a.scope,audience:a.audience||"default",redirect_uri:a.redirect_uri,state:n,url:c}}async loginWithPopup(t,e){var r;if(t=t||{},!(e=e||{}).popup&&(e.popup=(t=>{const e=window.screenX+(window.innerWidth-400)/2,r=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup",`left=${e},top=${r},width=400,height=600,resizable,scrollbars=yes,status=1`)})(),!e.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const n=await this._prepareAuthorizeUrl(t.authorizationParams||{},{response_mode:"web_message"},window.location.origin);e.popup.location.href=n.url;const o=await(t=>new Promise(((e,r)=>{let n;const o=setInterval((()=>{t.popup&&t.popup.closed&&(clearInterval(o),clearTimeout(i),window.removeEventListener("message",n,!1),r(new b(t.popup)))}),1e3),i=setTimeout((()=>{clearInterval(o),r(new m(t.popup)),window.removeEventListener("message",n,!1)}),1e3*(t.timeoutInSeconds||60));n=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(i),clearInterval(o),window.removeEventListener("message",n,!1),t.popup.close(),s.data.response.error)return r(g.fromPayload(s.data.response));e(s.data.response)}},window.addEventListener("message",n)})))(Object.assign(Object.assign({},e),{timeoutInSeconds:e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(n.state!==o.state)throw new g("state_mismatch","Invalid state");const i=(null===(r=t.authorizationParams)||void 0===r?void 0:r.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:n.audience,scope:n.scope,code_verifier:n.code_verifier,grant_type:"authorization_code",code:o.code,redirect_uri:n.redirect_uri},{nonceIn:n.nonce,organization:i})}async getUser(){var t;const e=await this._getIdTokenFromCache();return null===(t=null==e?void 0:e.decodedToken)||void 0===t?void 0:t.user}async getIdTokenClaims(){var t;const e=await this._getIdTokenFromCache();return null===(t=null==e?void 0:e.decodedToken)||void 0===t?void 0:t.claims}async loginWithRedirect(t={}){var e;const r=Y(t),{openUrl:n,fragment:i,appState:s}=r,a=o(r,["openUrl","fragment","appState"]),c=(null===(e=a.authorizationParams)||void 0===e?void 0:e.organization)||this.options.authorizationParams.organization,u=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:l}=u,h=o(u,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},h),{appState:s}),c&&{organization:c}));const f=i?`${l}#${i}`:l;n?await n(f):window.location.assign(f)}async handleRedirectCallback(t=window.location.href){const e=t.split("?").slice(1);if(0===e.length)throw new Error("There are no query params available for parsing.");const{state:r,code:n,error:o,error_description:i}=(t=>{t.indexOf("#")>-1&&(t=t.substring(0,t.indexOf("#")));const e=new URLSearchParams(t);return{state:e.get("state"),code:e.get("code")||void 0,error:e.get("error")||void 0,error_description:e.get("error_description")||void 0}})(e.join("")),s=this.transactionManager.get();if(!s)throw new g("missing_transaction","Invalid state");if(this.transactionManager.remove(),o)throw new y(o,i||o,r,s.appState);if(!s.code_verifier||s.state&&s.state!==r)throw new g("state_mismatch","Invalid state");const a=s.organization,c=s.nonce,u=s.redirect_uri;return await this._requestToken(Object.assign({audience:s.audience,scope:s.scope,code_verifier:s.code_verifier,grant_type:"authorization_code",code:n},u?{redirect_uri:u}:{}),{nonceIn:c,organization:a}),{appState:s.appState}}async checkSession(t){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(t)}catch(t){}}async getTokenSilently(t={}){var e;const r=Object.assign(Object.assign({cacheMode:"on"},t),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),t.authorizationParams),{scope:U(this.scope,null===(e=t.authorizationParams)||void 0===e?void 0:e.scope)})}),n=await((t,e)=>{let r=X[e];return r||(r=t().finally((()=>{delete X[e],r=null})),X[e]=r),r})((()=>this._getTokenSilently(r)),`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`);return t.detailedResponse?n:null==n?void 0:n.access_token}async _getTokenSilently(t){const{cacheMode:e}=t,r=o(t,["cacheMode"]);if("off"!==e){const t=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(t)return t}if("cache-only"!==e){if(!await(async(t,e=3)=>{for(let r=0;r<e;r++)if(await t())return!0;return!1})((()=>Q.acquireLock("auth0.lock.getTokenSilently",5e3)),10))throw new w;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),"off"!==e){const t=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(t)return t}const t=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(r):await this._getTokenFromIFrame(r),{id_token:n,access_token:o,oauthTokenScope:i,expires_in:s}=t;return Object.assign(Object.assign({id_token:n,access_token:o},i?{scope:i}:null),{expires_in:s})}finally{await Q.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(t={},e={}){var r;const n=Object.assign(Object.assign({},t),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),t.authorizationParams),{scope:U(this.scope,null===(r=t.authorizationParams)||void 0===r?void 0:r.scope)})});return e=Object.assign(Object.assign({},f),e),await this.loginWithPopup(n,e),(await this.cacheManager.get(new B({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(t){null!==t.clientId?t.clientId=t.clientId||this.options.clientId:delete t.clientId;const e=t.logoutParams||{},{federated:r}=e,n=o(e,["federated"]),i=r?"&federated":"";return this._url(`/v2/logout?${k(Object.assign({clientId:t.clientId},n))}`)+i}async logout(t={}){const e=Y(t),{openUrl:r}=e,n=o(e,["openUrl"]);null===t.clientId?await this.cacheManager.clear():await this.cacheManager.clear(t.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const i=this._buildLogoutUrl(n);r?await r(i):!1!==r&&window.location.assign(i)}async _getTokenFromIFrame(t){const e=Object.assign(Object.assign({},t.authorizationParams),{prompt:"none"}),r=this.cookieStorage.get(this.orgHintCookieName);r&&!e.organization&&(e.organization=r);const{url:n,state:o,nonce:i,code_verifier:s,redirect_uri:a,scope:c,audience:u}=await this._prepareAuthorizeUrl(e,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new g("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const r=t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,l=await((t,e,r=60)=>new Promise(((n,o)=>{const i=window.document.createElement("iframe");i.setAttribute("width","0"),i.setAttribute("height","0"),i.style.display="none";const s=()=>{window.document.body.contains(i)&&(window.document.body.removeChild(i),window.removeEventListener("message",a,!1))};let a;const c=setTimeout((()=>{o(new w),s()}),1e3*r);a=function(t){if(t.origin!=e)return;if(!t.data||"authorization_response"!==t.data.type)return;const r=t.source;r&&r.close(),t.data.response.error?o(g.fromPayload(t.data.response)):n(t.data.response),clearTimeout(c),window.removeEventListener("message",a,!1),setTimeout(s,2e3)},window.addEventListener("message",a,!1),window.document.body.appendChild(i),i.setAttribute("src",t)})))(n,this.domainUrl,r);if(o!==l.state)throw new g("state_mismatch","Invalid state");const h=await this._requestToken(Object.assign(Object.assign({},t.authorizationParams),{code_verifier:s,code:l.code,grant_type:"authorization_code",redirect_uri:a,timeout:t.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:i,organization:e.organization});return Object.assign(Object.assign({},h),{scope:c,oauthTokenScope:h.scope,audience:u})}catch(t){throw"login_required"===t.error&&this.logout({openUrl:!1}),t}}async _getTokenUsingRefreshToken(t){const e=await this.cacheManager.get(new B({scope:t.authorizationParams.scope,audience:t.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(e&&e.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(t);throw new _(t.authorizationParams.audience||"default",t.authorizationParams.scope)}const r=t.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,n="number"==typeof t.timeoutInSeconds?1e3*t.timeoutInSeconds:null;try{const o=await this._requestToken(Object.assign(Object.assign(Object.assign({},t.authorizationParams),{grant_type:"refresh_token",refresh_token:e&&e.refresh_token,redirect_uri:r}),n&&{timeout:n}));return Object.assign(Object.assign({},o),{scope:t.authorizationParams.scope,oauthTokenScope:o.scope,audience:t.authorizationParams.audience||"default"})}catch(e){if((e.message.indexOf("Missing Refresh Token")>-1||e.message&&e.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(t);throw e}}async _saveEntryInCache(t){const{id_token:e,decodedToken:r}=t,n=o(t,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:e,decodedToken:r}),await this.cacheManager.setIdToken(this.options.clientId,t.id_token,t.decodedToken),await this.cacheManager.set(n)}async _getIdTokenFromCache(){const t=this.options.authorizationParams.audience||"default",e=await this.cacheManager.getIdToken(new B({clientId:this.options.clientId,audience:t,scope:this.scope})),r=this.userCache.get("@@user@@");return e&&e.id_token===(null==r?void 0:r.id_token)?r:(this.userCache.set("@@user@@",e),e)}async _getEntryFromCache({scope:t,audience:e,clientId:r}){const n=await this.cacheManager.get(new B({scope:t,audience:e,clientId:r}),60);if(n&&n.access_token){const{access_token:t,oauthTokenScope:e,expires_in:r}=n,o=await this._getIdTokenFromCache();return o&&Object.assign(Object.assign({id_token:o.id_token,access_token:t},e?{scope:e}:null),{expires_in:r})}}async _requestToken(t,e){const{nonceIn:r,organization:n}=e||{},o=await C(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},t),this.worker),i=await this._verifyIdToken(o.id_token,r,n);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},o),{decodedToken:i,scope:t.scope,audience:t.audience||"default"}),o.scope?{oauthTokenScope:o.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgHint(n||i.claims.org_id),Object.assign(Object.assign({},o),{decodedToken:i})}}var et=a(470);function rt(t,e){return function(){return t.apply(e,arguments)}}const{toString:nt}=Object.prototype,{getPrototypeOf:ot}=Object,it=(st=Object.create(null),t=>{const e=nt.call(t);return st[e]||(st[e]=e.slice(8,-1).toLowerCase())});var st;const at=t=>(t=t.toLowerCase(),e=>it(e)===t),ct=t=>e=>typeof e===t,{isArray:ut}=Array,lt=ct("undefined");const ht=at("ArrayBuffer");const ft=ct("string"),dt=ct("function"),pt=ct("number"),gt=t=>null!==t&&"object"==typeof t,yt=t=>{if("object"!==it(t))return!1;const e=ot(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)},wt=at("Date"),mt=at("File"),bt=at("Blob"),vt=at("FileList"),_t=at("URLSearchParams");function Et(t,e,{allOwnKeys:r=!1}={}){if(null==t)return;let n,o;if("object"!=typeof t&&(t=[t]),ut(t))for(n=0,o=t.length;n<o;n++)e.call(null,t[n],n,t);else{const o=r?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let s;for(n=0;n<i;n++)s=o[n],e.call(null,t[s],s,t)}}function St(t,e){e=e.toLowerCase();const r=Object.keys(t);let n,o=r.length;for(;o-- >0;)if(n=r[o],e===n.toLowerCase())return n;return null}const At="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Tt=t=>!lt(t)&&t!==At;const kt=(It="undefined"!=typeof Uint8Array&&ot(Uint8Array),t=>It&&t instanceof It);var It;const Ot=at("HTMLFormElement"),Rt=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),Ct=at("RegExp"),Ut=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Et(r,((r,o)=>{let i;!1!==(i=e(r,o,t))&&(n[o]=i||r)})),Object.defineProperties(t,n)},Bt="abcdefghijklmnopqrstuvwxyz",Pt="0123456789",Lt={DIGIT:Pt,ALPHA:Bt,ALPHA_DIGIT:Bt+Bt.toUpperCase()+Pt};const xt=at("AsyncFunction"),Nt={isArray:ut,isArrayBuffer:ht,isBuffer:function(t){return null!==t&&!lt(t)&&null!==t.constructor&&!lt(t.constructor)&&dt(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||dt(t.append)&&("formdata"===(e=it(t))||"object"===e&&dt(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&ht(t.buffer),e},isString:ft,isNumber:pt,isBoolean:t=>!0===t||!1===t,isObject:gt,isPlainObject:yt,isUndefined:lt,isDate:wt,isFile:mt,isBlob:bt,isRegExp:Ct,isFunction:dt,isStream:t=>gt(t)&&dt(t.pipe),isURLSearchParams:_t,isTypedArray:kt,isFileList:vt,forEach:Et,merge:function t(){const{caseless:e}=Tt(this)&&this||{},r={},n=(n,o)=>{const i=e&&St(r,o)||o;yt(r[i])&&yt(n)?r[i]=t(r[i],n):yt(n)?r[i]=t({},n):ut(n)?r[i]=n.slice():r[i]=n};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&Et(arguments[t],n);return r},extend:(t,e,r,{allOwnKeys:n}={})=>(Et(e,((e,n)=>{r&&dt(e)?t[n]=rt(e,r):t[n]=e}),{allOwnKeys:n}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},toFlatObject:(t,e,r,n)=>{let o,i,s;const a={};if(e=e||{},null==t)return e;do{for(o=Object.getOwnPropertyNames(t),i=o.length;i-- >0;)s=o[i],n&&!n(s,t,e)||a[s]||(e[s]=t[s],a[s]=!0);t=!1!==r&&ot(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},kindOf:it,kindOfTest:at,endsWith:(t,e,r)=>{t=String(t),(void 0===r||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return-1!==n&&n===r},toArray:t=>{if(!t)return null;if(ut(t))return t;let e=t.length;if(!pt(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},forEachEntry:(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let n;for(;(n=r.next())&&!n.done;){const r=n.value;e.call(t,r[0],r[1])}},matchAll:(t,e)=>{let r;const n=[];for(;null!==(r=t.exec(e));)n.push(r);return n},isHTMLForm:Ot,hasOwnProperty:Rt,hasOwnProp:Rt,reduceDescriptors:Ut,freezeMethods:t=>{Ut(t,((e,r)=>{if(dt(t)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=t[r];dt(n)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(t,e)=>{const r={},n=t=>{t.forEach((t=>{r[t]=!0}))};return ut(t)?n(t):n(String(t).split(e)),r},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,r){return e.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:St,global:At,isContextDefined:Tt,ALPHABET:Lt,generateString:(t=16,e=Lt.ALPHA_DIGIT)=>{let r="";const{length:n}=e;for(;t--;)r+=e[Math.random()*n|0];return r},isSpecCompliantForm:function(t){return!!(t&&dt(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),r=(t,n)=>{if(gt(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[n]=t;const o=ut(t)?[]:{};return Et(t,((t,e)=>{const i=r(t,n+1);!lt(i)&&(o[e]=i)})),e[n]=void 0,o}}return t};return r(t,0)},isAsyncFn:xt,isThenable:t=>t&&(gt(t)||dt(t))&&dt(t.then)&&dt(t.catch)};function jt(t,e,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o)}Nt.inherits(jt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Nt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Dt=jt.prototype,Kt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{Kt[t]={value:t}})),Object.defineProperties(jt,Kt),Object.defineProperty(Dt,"isAxiosError",{value:!0}),jt.from=(t,e,r,n,o,i)=>{const s=Object.create(Dt);return Nt.toFlatObject(t,s,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),jt.call(s,t.message,e,r,n,o),s.cause=t,s.name=t.name,i&&Object.assign(s,i),s};const Mt=jt;function $t(t){return Nt.isPlainObject(t)||Nt.isArray(t)}function Ft(t){return Nt.endsWith(t,"[]")?t.slice(0,-2):t}function Wt(t,e,r){return t?t.concat(e).map((function(t,e){return t=Ft(t),!r&&e?"["+t+"]":t})).join(r?".":""):e}const zt=Nt.toFlatObject(Nt,{},null,(function(t){return/^is[A-Z]/.test(t)}));const Zt=function(t,e,r){if(!Nt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const n=(r=Nt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!Nt.isUndefined(e[t])}))).metaTokens,o=r.visitor||u,i=r.dots,s=r.indexes,a=(r.Blob||"undefined"!=typeof Blob&&Blob)&&Nt.isSpecCompliantForm(e);if(!Nt.isFunction(o))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(Nt.isDate(t))return t.toISOString();if(!a&&Nt.isBlob(t))throw new Mt("Blob is not supported. Use a Buffer instead.");return Nt.isArrayBuffer(t)||Nt.isTypedArray(t)?a&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function u(t,r,o){let a=t;if(t&&!o&&"object"==typeof t)if(Nt.endsWith(r,"{}"))r=n?r:r.slice(0,-2),t=JSON.stringify(t);else if(Nt.isArray(t)&&function(t){return Nt.isArray(t)&&!t.some($t)}(t)||(Nt.isFileList(t)||Nt.endsWith(r,"[]"))&&(a=Nt.toArray(t)))return r=Ft(r),a.forEach((function(t,n){!Nt.isUndefined(t)&&null!==t&&e.append(!0===s?Wt([r],n,i):null===s?r:r+"[]",c(t))})),!1;return!!$t(t)||(e.append(Wt(o,r,i),c(t)),!1)}const l=[],h=Object.assign(zt,{defaultVisitor:u,convertValue:c,isVisitable:$t});if(!Nt.isObject(t))throw new TypeError("data must be an object");return function t(r,n){if(!Nt.isUndefined(r)){if(-1!==l.indexOf(r))throw Error("Circular reference detected in "+n.join("."));l.push(r),Nt.forEach(r,(function(r,i){!0===(!(Nt.isUndefined(r)||null===r)&&o.call(e,r,Nt.isString(i)?i.trim():i,n,h))&&t(r,n?n.concat(i):[i])})),l.pop()}}(t),e};function Ht(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function Vt(t,e){this._pairs=[],t&&Zt(t,this,e)}const Xt=Vt.prototype;Xt.append=function(t,e){this._pairs.push([t,e])},Xt.toString=function(t){const e=t?function(e){return t.call(this,e,Ht)}:Ht;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const Jt=Vt;function qt(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gt(t,e,r){if(!e)return t;const n=r&&r.encode||qt,o=r&&r.serialize;let i;if(i=o?o(e,r):Nt.isURLSearchParams(e)?e.toString():new Jt(e,r).toString(n),i){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}const Yt=class{constructor(){this.handlers=[]}use(t,e,r){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Nt.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},Qt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},te={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Jt,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ee="undefined"!=typeof window&&"undefined"!=typeof document,re=(ne="undefined"!=typeof navigator&&navigator.product,ee&&["ReactNative","NativeScript","NS"].indexOf(ne)<0);var ne;const oe="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ie={...t,...te};const se=function(t){function e(t,r,n,o){let i=t[o++];if("__proto__"===i)return!0;const s=Number.isFinite(+i),a=o>=t.length;if(i=!i&&Nt.isArray(n)?n.length:i,a)return Nt.hasOwnProp(n,i)?n[i]=[n[i],r]:n[i]=r,!s;n[i]&&Nt.isObject(n[i])||(n[i]=[]);return e(t,r,n[i],o)&&Nt.isArray(n[i])&&(n[i]=function(t){const e={},r=Object.keys(t);let n;const o=r.length;let i;for(n=0;n<o;n++)i=r[n],e[i]=t[i];return e}(n[i])),!s}if(Nt.isFormData(t)&&Nt.isFunction(t.entries)){const r={};return Nt.forEachEntry(t,((t,n)=>{e(function(t){return Nt.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),n,r,0)})),r}return null};const ae={transitional:Qt,adapter:["xhr","http"],transformRequest:[function(t,e){const r=e.getContentType()||"",n=r.indexOf("application/json")>-1,o=Nt.isObject(t);o&&Nt.isHTMLForm(t)&&(t=new FormData(t));if(Nt.isFormData(t))return n&&n?JSON.stringify(se(t)):t;if(Nt.isArrayBuffer(t)||Nt.isBuffer(t)||Nt.isStream(t)||Nt.isFile(t)||Nt.isBlob(t))return t;if(Nt.isArrayBufferView(t))return t.buffer;if(Nt.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Zt(t,new ie.classes.URLSearchParams,Object.assign({visitor:function(t,e,r,n){return ie.isNode&&Nt.isBuffer(t)?(this.append(e,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((i=Nt.isFileList(t))||r.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Zt(i?{"files[]":t}:t,e&&new e,this.formSerializer)}}return o||n?(e.setContentType("application/json",!1),function(t,e,r){if(Nt.isString(t))try{return(e||JSON.parse)(t),Nt.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(r||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||ae.transitional,r=e&&e.forcedJSONParsing,n="json"===this.responseType;if(t&&Nt.isString(t)&&(r&&!this.responseType||n)){const r=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(t){if(r){if("SyntaxError"===t.name)throw Mt.from(t,Mt.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ie.classes.FormData,Blob:ie.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Nt.forEach(["delete","get","head","post","put","patch"],(t=>{ae.headers[t]={}}));const ce=ae,ue=Nt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),le=Symbol("internals");function he(t){return t&&String(t).trim().toLowerCase()}function fe(t){return!1===t||null==t?t:Nt.isArray(t)?t.map(fe):String(t)}function de(t,e,r,n,o){return Nt.isFunction(n)?n.call(this,e,r):(o&&(e=r),Nt.isString(e)?Nt.isString(n)?-1!==e.indexOf(n):Nt.isRegExp(n)?n.test(e):void 0:void 0)}class pe{constructor(t){t&&this.set(t)}set(t,e,r){const n=this;function o(t,e,r){const o=he(e);if(!o)throw new Error("header name must be a non-empty string");const i=Nt.findKey(n,o);(!i||void 0===n[i]||!0===r||void 0===r&&!1!==n[i])&&(n[i||e]=fe(t))}const i=(t,e)=>Nt.forEach(t,((t,r)=>o(t,r,e)));return Nt.isPlainObject(t)||t instanceof this.constructor?i(t,e):Nt.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim())?i((t=>{const e={};let r,n,o;return t&&t.split("\n").forEach((function(t){o=t.indexOf(":"),r=t.substring(0,o).trim().toLowerCase(),n=t.substring(o+1).trim(),!r||e[r]&&ue[r]||("set-cookie"===r?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)})),e})(t),e):null!=t&&o(e,t,r),this}get(t,e){if(t=he(t)){const r=Nt.findKey(this,t);if(r){const t=this[r];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}(t);if(Nt.isFunction(e))return e.call(this,t,r);if(Nt.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=he(t)){const r=Nt.findKey(this,t);return!(!r||void 0===this[r]||e&&!de(0,this[r],r,e))}return!1}delete(t,e){const r=this;let n=!1;function o(t){if(t=he(t)){const o=Nt.findKey(r,t);!o||e&&!de(0,r[o],o,e)||(delete r[o],n=!0)}}return Nt.isArray(t)?t.forEach(o):o(t),n}clear(t){const e=Object.keys(this);let r=e.length,n=!1;for(;r--;){const o=e[r];t&&!de(0,this[o],o,t,!0)||(delete this[o],n=!0)}return n}normalize(t){const e=this,r={};return Nt.forEach(this,((n,o)=>{const i=Nt.findKey(r,o);if(i)return e[i]=fe(n),void delete e[o];const s=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,r)=>e.toUpperCase()+r))}(o):String(o).trim();s!==o&&delete e[o],e[s]=fe(n),r[s]=!0})),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return Nt.forEach(this,((r,n)=>{null!=r&&!1!==r&&(e[n]=t&&Nt.isArray(r)?r.join(", "):r)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([t,e])=>t+": "+e)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const r=new this(t);return e.forEach((t=>r.set(t))),r}static accessor(t){const e=(this[le]=this[le]={accessors:{}}).accessors,r=this.prototype;function n(t){const n=he(t);e[n]||(!function(t,e){const r=Nt.toCamelCase(" "+e);["get","set","has"].forEach((n=>{Object.defineProperty(t,n+r,{value:function(t,r,o){return this[n].call(this,e,t,r,o)},configurable:!0})}))}(r,t),e[n]=!0)}return Nt.isArray(t)?t.forEach(n):n(t),this}}pe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Nt.reduceDescriptors(pe.prototype,(({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[r]=t}}})),Nt.freezeMethods(pe);const ge=pe;function ye(t,e){const r=this||ce,n=e||r,o=ge.from(n.headers);let i=n.data;return Nt.forEach(t,(function(t){i=t.call(r,i,o.normalize(),e?e.status:void 0)})),o.normalize(),i}function we(t){return!(!t||!t.__CANCEL__)}function me(t,e,r){Mt.call(this,null==t?"canceled":t,Mt.ERR_CANCELED,e,r),this.name="CanceledError"}Nt.inherits(me,Mt,{__CANCEL__:!0});const be=me;const ve=ie.hasStandardBrowserEnv?{write(t,e,r,n,o,i){const s=[t+"="+encodeURIComponent(e)];Nt.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Nt.isString(n)&&s.push("path="+n),Nt.isString(o)&&s.push("domain="+o),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function _e(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Ee=ie.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let r;function n(r){let n=r;return t&&(e.setAttribute("href",n),n=e.href),e.setAttribute("href",n),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return r=n(window.location.href),function(t){const e=Nt.isString(t)?n(t):t;return e.protocol===r.protocol&&e.host===r.host}}():function(){return!0};const Se=function(t,e){t=t||10;const r=new Array(t),n=new Array(t);let o,i=0,s=0;return e=void 0!==e?e:1e3,function(a){const c=Date.now(),u=n[s];o||(o=c),r[i]=a,n[i]=c;let l=s,h=0;for(;l!==i;)h+=r[l++],l%=t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),c-o<e)return;const f=u&&c-u;return f?Math.round(1e3*h/f):void 0}};function Ae(t,e){let r=0;const n=Se(50,250);return o=>{const i=o.loaded,s=o.lengthComputable?o.total:void 0,a=i-r,c=n(a);r=i;const u={loaded:i,total:s,progress:s?i/s:void 0,bytes:a,rate:c||void 0,estimated:c&&s&&i<=s?(s-i)/c:void 0,event:o};u[e?"download":"upload"]=!0,t(u)}}const Te={http:null,xhr:"undefined"!=typeof XMLHttpRequest&&function(t){return new Promise((function(e,r){let n=t.data;const o=ge.from(t.headers).normalize();let i,s,{responseType:a,withXSRFToken:c}=t;function u(){t.cancelToken&&t.cancelToken.unsubscribe(i),t.signal&&t.signal.removeEventListener("abort",i)}if(Nt.isFormData(n))if(ie.hasStandardBrowserEnv||ie.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if(!1!==(s=o.getContentType())){const[t,...e]=s?s.split(";").map((t=>t.trim())).filter(Boolean):[];o.setContentType([t||"multipart/form-data",...e].join("; "))}let l=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",r=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";o.set("Authorization","Basic "+btoa(e+":"+r))}const h=_e(t.baseURL,t.url);function f(){if(!l)return;const n=ge.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(t,e,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?e(new Mt("Request failed with status code "+r.status,[Mt.ERR_BAD_REQUEST,Mt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):t(r)}((function(t){e(t),u()}),(function(t){r(t),u()}),{data:a&&"text"!==a&&"json"!==a?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:n,config:t,request:l}),l=null}if(l.open(t.method.toUpperCase(),Gt(h,t.params,t.paramsSerializer),!0),l.timeout=t.timeout,"onloadend"in l?l.onloadend=f:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(f)},l.onabort=function(){l&&(r(new Mt("Request aborted",Mt.ECONNABORTED,t,l)),l=null)},l.onerror=function(){r(new Mt("Network Error",Mt.ERR_NETWORK,t,l)),l=null},l.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const n=t.transitional||Qt;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(new Mt(e,n.clarifyTimeoutError?Mt.ETIMEDOUT:Mt.ECONNABORTED,t,l)),l=null},ie.hasStandardBrowserEnv&&(c&&Nt.isFunction(c)&&(c=c(t)),c||!1!==c&&Ee(h))){const e=t.xsrfHeaderName&&t.xsrfCookieName&&ve.read(t.xsrfCookieName);e&&o.set(t.xsrfHeaderName,e)}void 0===n&&o.setContentType(null),"setRequestHeader"in l&&Nt.forEach(o.toJSON(),(function(t,e){l.setRequestHeader(e,t)})),Nt.isUndefined(t.withCredentials)||(l.withCredentials=!!t.withCredentials),a&&"json"!==a&&(l.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&l.addEventListener("progress",Ae(t.onDownloadProgress,!0)),"function"==typeof t.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Ae(t.onUploadProgress)),(t.cancelToken||t.signal)&&(i=e=>{l&&(r(!e||e.type?new be(null,t,l):e),l.abort(),l=null)},t.cancelToken&&t.cancelToken.subscribe(i),t.signal&&(t.signal.aborted?i():t.signal.addEventListener("abort",i)));const d=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(h);d&&-1===ie.protocols.indexOf(d)?r(new Mt("Unsupported protocol "+d+":",Mt.ERR_BAD_REQUEST,t)):l.send(n||null)}))}};Nt.forEach(Te,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}}));const ke=t=>`- ${t}`,Ie=t=>Nt.isFunction(t)||null===t||!1===t,Oe=t=>{t=Nt.isArray(t)?t:[t];const{length:e}=t;let r,n;const o={};for(let i=0;i<e;i++){let e;if(r=t[i],n=r,!Ie(r)&&(n=Te[(e=String(r)).toLowerCase()],void 0===n))throw new Mt(`Unknown adapter '${e}'`);if(n)break;o[e||"#"+i]=n}if(!n){const t=Object.entries(o).map((([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build")));let r=e?t.length>1?"since :\n"+t.map(ke).join("\n"):" "+ke(t[0]):"as no adapter specified";throw new Mt("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return n};function Re(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new be(null,t)}function Ce(t){Re(t),t.headers=ge.from(t.headers),t.data=ye.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return Oe(t.adapter||ce.adapter)(t).then((function(e){return Re(t),e.data=ye.call(t,t.transformResponse,e),e.headers=ge.from(e.headers),e}),(function(e){return we(e)||(Re(t),e&&e.response&&(e.response.data=ye.call(t,t.transformResponse,e.response),e.response.headers=ge.from(e.response.headers))),Promise.reject(e)}))}const Ue=t=>t instanceof ge?t.toJSON():t;function Be(t,e){e=e||{};const r={};function n(t,e,r){return Nt.isPlainObject(t)&&Nt.isPlainObject(e)?Nt.merge.call({caseless:r},t,e):Nt.isPlainObject(e)?Nt.merge({},e):Nt.isArray(e)?e.slice():e}function o(t,e,r){return Nt.isUndefined(e)?Nt.isUndefined(t)?void 0:n(void 0,t,r):n(t,e,r)}function i(t,e){if(!Nt.isUndefined(e))return n(void 0,e)}function s(t,e){return Nt.isUndefined(e)?Nt.isUndefined(t)?void 0:n(void 0,t):n(void 0,e)}function a(r,o,i){return i in e?n(r,o):i in t?n(void 0,r):void 0}const c={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(t,e)=>o(Ue(t),Ue(e),!0)};return Nt.forEach(Object.keys(Object.assign({},t,e)),(function(n){const i=c[n]||o,s=i(t[n],e[n],n);Nt.isUndefined(s)&&i!==a||(r[n]=s)})),r}const Pe="1.6.5",Le={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{Le[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}}));const xe={};Le.transitional=function(t,e,r){function n(t,e){return"[Axios v1.6.5] Transitional option '"+t+"'"+e+(r?". "+r:"")}return(r,o,i)=>{if(!1===t)throw new Mt(n(o," has been removed"+(e?" in "+e:"")),Mt.ERR_DEPRECATED);return e&&!xe[o]&&(xe[o]=!0,console.warn(n(o," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(r,o,i)}};const Ne={assertOptions:function(t,e,r){if("object"!=typeof t)throw new Mt("options must be an object",Mt.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let o=n.length;for(;o-- >0;){const i=n[o],s=e[i];if(s){const e=t[i],r=void 0===e||s(e,i,t);if(!0!==r)throw new Mt("option "+i+" must be "+r,Mt.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new Mt("Unknown option "+i,Mt.ERR_BAD_OPTION)}},validators:Le},je=Ne.validators;class De{constructor(t){this.defaults=t,this.interceptors={request:new Yt,response:new Yt}}request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=Be(this.defaults,e);const{transitional:r,paramsSerializer:n,headers:o}=e;void 0!==r&&Ne.assertOptions(r,{silentJSONParsing:je.transitional(je.boolean),forcedJSONParsing:je.transitional(je.boolean),clarifyTimeoutError:je.transitional(je.boolean)},!1),null!=n&&(Nt.isFunction(n)?e.paramsSerializer={serialize:n}:Ne.assertOptions(n,{encode:je.function,serialize:je.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=o&&Nt.merge(o.common,o[e.method]);o&&Nt.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete o[t]})),e.headers=ge.concat(i,o);const s=[];let a=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,s.unshift(t.fulfilled,t.rejected))}));const c=[];let u;this.interceptors.response.forEach((function(t){c.push(t.fulfilled,t.rejected)}));let l,h=0;if(!a){const t=[Ce.bind(this),void 0];for(t.unshift.apply(t,s),t.push.apply(t,c),l=t.length,u=Promise.resolve(e);h<l;)u=u.then(t[h++],t[h++]);return u}l=s.length;let f=e;for(h=0;h<l;){const t=s[h++],e=s[h++];try{f=t(f)}catch(t){e.call(this,t);break}}try{u=Ce.call(this,f)}catch(t){return Promise.reject(t)}for(h=0,l=c.length;h<l;)u=u.then(c[h++],c[h++]);return u}getUri(t){return Gt(_e((t=Be(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}Nt.forEach(["delete","get","head","options"],(function(t){De.prototype[t]=function(e,r){return this.request(Be(r||{},{method:t,url:e,data:(r||{}).data}))}})),Nt.forEach(["post","put","patch"],(function(t){function e(e){return function(r,n,o){return this.request(Be(o||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}De.prototype[t]=e(),De.prototype[t+"Form"]=e(!0)}));const Ke=De;class Me{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const r=this;this.promise.then((t=>{if(!r._listeners)return;let e=r._listeners.length;for(;e-- >0;)r._listeners[e](t);r._listeners=null})),this.promise.then=t=>{let e;const n=new Promise((t=>{r.subscribe(t),e=t})).then(t);return n.cancel=function(){r.unsubscribe(e)},n},t((function(t,n,o){r.reason||(r.reason=new be(t,n,o),e(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;const e=new Me((function(e){t=e}));return{token:e,cancel:t}}}const $e=Me;const Fe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fe).forEach((([t,e])=>{Fe[e]=t}));const We=Fe;const ze=function t(e){const r=new Ke(e),n=rt(Ke.prototype.request,r);return Nt.extend(n,Ke.prototype,r,{allOwnKeys:!0}),Nt.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return t(Be(e,r))},n}(ce);ze.Axios=Ke,ze.CanceledError=be,ze.CancelToken=$e,ze.isCancel=we,ze.VERSION=Pe,ze.toFormData=Zt,ze.AxiosError=Mt,ze.Cancel=ze.CanceledError,ze.all=function(t){return Promise.all(t)},ze.spread=function(t){return function(e){return t.apply(null,e)}},ze.isAxiosError=function(t){return Nt.isObject(t)&&!0===t.isAxiosError},ze.mergeConfig=Be,ze.AxiosHeaders=ge,ze.formToJSON=t=>se(Nt.isHTMLForm(t)?new FormData(t):t),ze.getAdapter=Oe,ze.HttpStatusCode=We,ze.default=ze;const Ze=ze;var He=a(742),Ve=Object.create,Xe=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,qe=Object.getOwnPropertyNames,Ge=Object.getPrototypeOf,Ye=Object.prototype.hasOwnProperty,Qe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),tr=(t,e,r)=>(r=null!=t?Ve(Ge(t)):{},((t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let o of qe(e))!Ye.call(t,o)&&o!==r&&Xe(t,o,{get:()=>e[o],enumerable:!(n=Je(e,o))||n.enumerable});return t})(!e&&t&&t.__esModule?r:Xe(r,"default",{value:t,enumerable:!0}),t)),er=Qe((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){var e=t.length,r=e%4;if(!r)return t;var n=e,o=4-r,i=e+o,s=Buffer.alloc(i);for(s.write(t);o--;)s.write("=",n++);return s.toString()}})),rr=Qe((t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=er();function r(t,e){return void 0===e&&(e="utf8"),Buffer.isBuffer(t)?o(t.toString("base64")):o(Buffer.from(t,e).toString("base64"))}function n(t){return t=t.toString(),e.default(t).replace(/\-/g,"+").replace(/_/g,"/")}function o(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var i=r;i.encode=r,i.decode=function(t,e){return void 0===e&&(e="utf8"),Buffer.from(n(t),"base64").toString(e)},i.toBase64=n,i.fromBase64=o,i.toBuffer=function(t){return Buffer.from(n(t),"base64")},t.default=i})),nr=Qe(((t,e)=>{e.exports=rr().default,e.exports.default=e.exports})),or=Qe((t=>{t.byteLength=function(t){var e=s(t),r=e[0],n=e[1];return 3*(r+n)/4-n},t.toByteArray=function(t){var e,r,i=s(t),a=i[0],c=i[1],u=new o(function(t,e,r){return 3*(e+r)/4-r}(0,a,c)),l=0,h=c>0?a-4:a;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[l++]=255&e),1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u},t.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=16383,a=0,u=n-o;a<u;a+=s)i.push(c(t,a,a+s>u?u:a+s));return 1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};var e,r=[],n=[],o=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(e=0,64;e<64;++e)r[e]=i[e],n[i.charCodeAt(e)]=e;function s(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function a(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function c(t,e,r){for(var n,o=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),o.push(a(n));return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63})),ir=Qe((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.b64UrlDecode=t.b64UrlEncode=t.bufferTob64Url=t.bufferTob64=t.b64UrlToBuffer=t.stringToB64Url=t.stringToBuffer=t.bufferToString=t.b64UrlToString=t.concatBuffers=void 0;var e=or();function r(t){return new TextDecoder("utf-8",{fatal:!0}).decode(t)}function n(t){return(new TextEncoder).encode(t)}function o(t){return new Uint8Array(e.toByteArray(c(t)))}function i(t){return e.fromByteArray(new Uint8Array(t))}function s(t){return a(i(t))}function a(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function c(t){let e;return e=(t=t.replace(/\-/g,"+").replace(/\_/g,"/")).length%4==0?0:4-t.length%4,t.concat("=".repeat(e))}t.concatBuffers=function(t){let e=0;for(let r=0;r<t.length;r++)e+=t[r].byteLength;let r=new Uint8Array(e),n=0;r.set(new Uint8Array(t[0]),n),n+=t[0].byteLength;for(let e=1;e<t.length;e++)r.set(new Uint8Array(t[e]),n),n+=t[e].byteLength;return r},t.b64UrlToString=function(t){return r(o(t))},t.bufferToString=r,t.stringToBuffer=n,t.stringToB64Url=function(t){return s(n(t))},t.b64UrlToBuffer=o,t.bufferTob64=i,t.bufferTob64Url=s,t.b64UrlEncode=a,t.b64UrlDecode=c})),sr=Qe((t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=ir();t.default=class{keyLength=4096;publicExponent=65537;hashAlgorithm="sha256";driver;constructor(){if(!this.detectWebCrypto())throw new Error("SubtleCrypto not available!");this.driver=crypto.subtle}async generateJWK(){let t=await this.driver.generateKey({name:"RSA-PSS",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign"]),e=await this.driver.exportKey("jwk",t.privateKey);return{kty:e.kty,e:e.e,n:e.n,d:e.d,p:e.p,q:e.q,dp:e.dp,dq:e.dq,qi:e.qi}}async sign(t,e,{saltLength:r}={}){let n=await this.driver.sign({name:"RSA-PSS",saltLength:32},await this.jwkToCryptoKey(t),e);return new Uint8Array(n)}async hash(t,e="SHA-256"){let r=await this.driver.digest(e,t);return new Uint8Array(r)}async verify(t,e,r){let n={kty:"RSA",e:"AQAB",n:t},o=await this.jwkToPublicCryptoKey(n),i=await this.driver.digest("SHA-256",e),s=await this.driver.verify({name:"RSA-PSS",saltLength:0},o,r,e),a=await this.driver.verify({name:"RSA-PSS",saltLength:32},o,r,e),c=await this.driver.verify({name:"RSA-PSS",saltLength:Math.ceil((o.algorithm.modulusLength-1)/8)-i.byteLength-2},o,r,e);return s||a||c}async jwkToCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["sign"])}async jwkToPublicCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["verify"])}detectWebCrypto(){if(typeof crypto>"u")return!1;let t=crypto?.subtle;return void 0!==t&&["generateKey","importKey","exportKey","digest","sign"].every((e=>"function"==typeof t[e]))}async encrypt(t,r,n){let o=await this.driver.importKey("raw","string"==typeof r?e.stringToBuffer(r):r,{name:"PBKDF2",length:32},!1,["deriveKey"]),i=await this.driver.deriveKey({name:"PBKDF2",salt:n?e.stringToBuffer(n):e.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),s=new Uint8Array(16);crypto.getRandomValues(s);let a=await this.driver.encrypt({name:"AES-CBC",iv:s},i,t);return e.concatBuffers([s,a])}async decrypt(t,r,n){let o=await this.driver.importKey("raw","string"==typeof r?e.stringToBuffer(r):r,{name:"PBKDF2",length:32},!1,["deriveKey"]),i=await this.driver.deriveKey({name:"PBKDF2",salt:n?e.stringToBuffer(n):e.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),s=t.slice(0,16),a=await this.driver.decrypt({name:"AES-CBC",iv:s},i,t.slice(16));return e.concatBuffers([a])}}})),ar=Qe((t=>{t.read=function(t,e,r,n,o){var i,s,a=8*o-n-1,c=(1<<a)-1,u=c>>1,l=-7,h=r?o-1:0,f=r?-1:1,d=t[e+h];for(h+=f,i=d&(1<<-l)-1,d>>=-l,l+=a;l>0;i=256*i+t[e+h],h+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),i-=u}return(d?-1:1)*s*Math.pow(2,i-n)},t.write=function(t,e,r,n,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,h=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[r+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[r+d]=255&s,d+=p,s/=256,u-=8);t[r+d-p]|=128*g}})),cr=Qe((t=>{var e=or(),r=ar(),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){return+t!=t&&(t=0),s.alloc(+t)},t.INSPECT_MAX_BYTES=50;var o=2147483647;function i(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,r)}function a(t,e,r){if("string"==typeof t)return function(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=0|d(t,e),n=i(r),o=n.write(t,e);return o!==r&&(n=n.slice(0,o)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(V(t,Uint8Array)){let e=new Uint8Array(t);return h(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(V(t,ArrayBuffer)||t&&V(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(V(t,SharedArrayBuffer)||t&&V(t.buffer,SharedArrayBuffer)))return h(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return s.from(n,e,r);let o=function(t){if(s.isBuffer(t)){let e=0|f(t.length),r=i(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||X(t.length)?i(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(o)return o;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),i(t<0?0:0|f(t))}function l(t){let e=t.length<0?0:0|f(t.length),r=i(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function h(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,s.prototype),n}function f(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function d(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||V(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Z(t).length;default:if(o)return n?-1:z(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,r);case"utf8":case"utf-8":return A(this,e,r);case"ascii":return k(this,e,r);case"latin1":case"binary":return I(this,e,r);case"base64":return S(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function y(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),X(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:w(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,n,o){let i,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let n=-1;for(i=r;i<a;i++)if(u(t,i)===u(e,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===c)return n*s}else-1!==n&&(i-=i-n),n=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){let r=!0;for(let n=0;n<c;n++)if(u(t,i+n)!==u(e,n)){r=!1;break}if(r)return i}return-1}function m(t,e,r,n){r=Number(r)||0;let o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;let i,s=e.length;for(n>s/2&&(n=s/2),i=0;i<n;++i){let n=parseInt(e.substr(2*i,2),16);if(X(n))return i;t[r+i]=n}return i}function b(t,e,r,n){return H(z(e,t.length-r),t,r,n)}function v(t,e,r,n){return H(function(t){let e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function _(t,e,r,n){return H(Z(e),t,r,n)}function E(t,e,r,n){return H(function(t,e){let r,n,o,i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function S(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function A(t,e,r){r=Math.min(t.length,r);let n=[],o=e;for(;o<r;){let e=t[o],i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(i=e);break;case 2:r=t[o+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(i=c));break;case 3:r=t[o+1],n=t[o+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=t[o+1],n=t[o+2],a=t[o+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),o+=s}return function(t){let e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=T));return r}(n)}t.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=function(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch{return!1}}(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return a(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return function(t,e,r){return c(t),t<=0?i(t):void 0!==e?"string"==typeof r?i(t).fill(e,r):i(t).fill(e):i(t)}(t,e,r)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(V(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),V(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;let n=s.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){let e=t[r];if(V(e,Uint8Array))o+e.length>n.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(n,o)):Uint8Array.prototype.set.call(n,e,o);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){let t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){let t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){let t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){let t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(t,e,r,n,o){if(V(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;let i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),c=Math.min(i,a),u=this.slice(n,o),l=t.slice(e,r);for(let t=0;t<c;++t)if(u[t]!==l[t]){i=u[t],a=l[t];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return y(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return y(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}let o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return _(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function k(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function I(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function O(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let o="";for(let n=e;n<r;++n)o+=J[t[n]];return o}function R(t,e,r){let n=t.slice(e,r),o="";for(let t=0;t<n.length-1;t+=2)o+=String.fromCharCode(n[t]+256*n[t+1]);return o}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function U(t,e,r,n,o,i){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function B(t,e,r,n,o){M(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function P(t,e,r,n,o){M(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r+7]=i,i>>=8,t[r+6]=i,i>>=8,t[r+5]=i,i>>=8,t[r+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function L(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function x(t,e,n,o,i){return e=+e,n>>>=0,i||L(t,0,n,4),r.write(t,e,n,o,23,4),n+4}function N(t,e,n,o,i){return e=+e,n>>>=0,i||L(t,0,n,8),r.write(t,e,n,o,52,8),n+8}s.prototype.slice=function(t,e){let r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);let n=this.subarray(t,e);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t+--e],o=1;for(;e>0&&(o*=256);)n+=this[t+--e]*o;return n},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=q((function(t){$(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&F(t,this.length-8);let n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))})),s.prototype.readBigUInt64BE=q((function(t){$(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&F(t,this.length-8);let n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(o)})),s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=e,o=1,i=this[t+--n];for(;n>0&&(o*=256);)i+=this[t+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);let r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);let r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=q((function(t){$(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&F(t,this.length-8);let n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=q((function(t){$(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&F(t,this.length-8);let n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){U(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){U(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=q((function(t,e=0){return B(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=q((function(t,e=0){return P(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){let n=Math.pow(2,8*r-1);U(this,t,e,r,n-1,-n)}let o=0,i=1,s=0;for(this[e]=255&t;++o<r&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){let n=Math.pow(2,8*r-1);U(this,t,e,r,n-1,-n)}let o=r-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||U(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=q((function(t,e=0){return B(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=q((function(t,e=0){return P(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,r){return x(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return x(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return N(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return N(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),!n&&0!==n&&(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r||0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);let o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){let e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{let i=s.isBuffer(t)?t:s.from(t,n),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=i[o%a]}return this};var j={};function D(t,e,r){j[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function K(t){let e="",r=t.length,n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function M(t,e,r,n,o,i){if(t>r||t<e){let n,o="bigint"==typeof e?"n":"";throw n=i>3?0===e||e===BigInt(0)?`>= 0${o} and < 2${o} ** ${8*(i+1)}${o}`:`>= -(2${o} ** ${8*(i+1)-1}${o}) and < 2 ** ${8*(i+1)-1}${o}`:`>= ${e}${o} and <= ${r}${o}`,new j.ERR_OUT_OF_RANGE("value",n,t)}!function(t,e,r){$(e,"offset"),(void 0===t[e]||void 0===t[e+r])&&F(e,t.length-(r+1))}(n,o,i)}function $(t,e){if("number"!=typeof t)throw new j.ERR_INVALID_ARG_TYPE(e,"number",t)}function F(t,e,r){throw Math.floor(t)!==t?($(t,r),new j.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new j.ERR_BUFFER_OUT_OF_BOUNDS:new j.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=K(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=K(o)),o+="n"),n+=` It must be ${e}. Received ${o}`,n}),RangeError);var W=/[^+/0-9A-Za-z-_]/g;function z(t,e){e=e||1/0;let r,n=t.length,o=null,i=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Z(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,r,n){let o;for(o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function V(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function X(t){return t!=t}var J=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=16*r;for(let o=0;o<16;++o)e[n+o]=t[r]+t[o]}return e}();function q(t){return typeof BigInt>"u"?G:t}function G(){throw new Error("BigInt not supported")}})),ur=Qe(((t,e)=>{typeof window<"u"?(window.global=window,global.fetch=window.fetch,e.exports={Buffer:cr().Buffer,Crypto:window.crypto}):e.exports={Buffer:cr().Buffer,Crypto:crypto}})),lr={};((t,e)=>{for(var r in e)Xe(t,r,{get:e[r],enumerable:!0})})(lr,{AVSCTap:()=>Or,ArweaveSigner:()=>Sr,DataItem:()=>Dr,MAX_TAG_BYTES:()=>Nr,MIN_BINARY_SIZE:()=>jr,SIG_CONFIG:()=>Er,SignatureConfig:()=>wr,Signer:()=>hr,createData:()=>Mr,deserializeTags:()=>Ur,indexToType:()=>Ar,serializeTags:()=>Rr,tagsExceedLimit:()=>Cr});var hr=class{signer;publicKey;signatureType;signatureLength;ownerLength;pem;static verify(t,e,r,n){throw new Error("You must implement verify method on child")}},fr=tr(nr(),1),dr=tr(ir(),1);async function pr(t){if(Array.isArray(t)){let e=(0,dr.concatBuffers)([(0,dr.stringToBuffer)("list"),(0,dr.stringToBuffer)(t.length.toString())]);return await gr(t,await _r().hash(e,"SHA-384"))}let e=t,r=(0,dr.concatBuffers)([(0,dr.stringToBuffer)("blob"),(0,dr.stringToBuffer)(e.byteLength.toString())]),n=(0,dr.concatBuffers)([await _r().hash(r,"SHA-384"),await _r().hash(e,"SHA-384")]);return await _r().hash(n,"SHA-384")}async function gr(t,e){if(t.length<1)return e;let r=(0,dr.concatBuffers)([e,await pr(t[0])]),n=await _r().hash(r,"SHA-384");return await gr(t.slice(1),n)}var yr,wr,mr=tr(sr(),1),br=mr.default.default?mr.default.default:mr.default,vr=class extends br{getPublicKey(t){throw new Error("Unimplemented")}};function _r(){return yr??=new vr}!function(t){t[t.ARWEAVE=1]="ARWEAVE",t[t.ED25519=2]="ED25519",t[t.ETHEREUM=3]="ETHEREUM",t[t.SOLANA=4]="SOLANA",t[t.INJECTEDAPTOS=5]="INJECTEDAPTOS",t[t.MULTIAPTOS=6]="MULTIAPTOS",t[t.TYPEDETHEREUM=7]="TYPEDETHEREUM"}(wr||(wr={}));var Er={[wr.ARWEAVE]:{sigLength:512,pubLength:512,sigName:"arweave"},[wr.ED25519]:{sigLength:64,pubLength:32,sigName:"ed25519"},[wr.ETHEREUM]:{sigLength:65,pubLength:65,sigName:"ethereum"},[wr.SOLANA]:{sigLength:64,pubLength:32,sigName:"solana"},[wr.INJECTEDAPTOS]:{sigLength:64,pubLength:32,sigName:"injectedAptos"},[wr.MULTIAPTOS]:{sigLength:2052,pubLength:1025,sigName:"multiAptos"},[wr.TYPEDETHEREUM]:{sigLength:65,pubLength:42,sigName:"typedEthereum"}},Sr=class{signatureType=1;ownerLength=Er[1].pubLength;signatureLength=Er[1].sigLength;jwk;pk;constructor(t){this.pk=t.n,this.jwk=t}get publicKey(){return fr.default.toBuffer(this.pk)}sign(t){return _r().sign(this.jwk,t)}static async verify(t,e,r){return await _r().verify(t,e,r)}},Ar={1:Sr},Tr=tr(nr(),1);async function kr(t){return pr([(0,dr.stringToBuffer)("dataitem"),(0,dr.stringToBuffer)("1"),(0,dr.stringToBuffer)(t.signatureType.toString()),t.rawOwner,t.rawTarget,t.rawAnchor,t.rawTags,t.rawData])}async function Ir(t,e){let{signature:r,id:n}=await async function(t,e){let r=await kr(t),n=await e.sign(r),o=await _r().hash(n);return{signature:Buffer.from(n),id:Buffer.from(o)}}(t,e);return t.getRaw().set(r,2),n}var Or=class{buf;pos;constructor(t=Buffer.alloc(Nr),e=0){this.buf=t,this.pos=e}writeTags(t){if(!Array.isArray(t))throw new Error("input must be array");let e,r=t.length;if(r)for(this.writeLong(r),e=0;e<r;e++){let r=t[e];if(void 0===r?.name||void 0===r?.value)throw new Error(`Invalid tag format for ${r}, expected {name:string, value: string}`);this.writeString(r.name),this.writeString(r.value)}this.writeLong(0)}toBuffer(){let t=Buffer.alloc(this.pos);if(this.pos>this.buf.length)throw new Error(`Too many tag bytes (${this.pos} > ${this.buf.length})`);return this.buf.copy(t,0,0,this.pos),t}tagsExceedLimit(){return this.pos>this.buf.length}writeLong(t){let e,r,n=this.buf;if(t>=-1073741824&&t<1073741824){r=t>=0?t<<1:~t<<1|1;do{n[this.pos]=127&r,r>>=7}while(r&&(n[this.pos++]|=128))}else{e=t>=0?2*t:2*-t-1;do{n[this.pos]=127&e,e/=128}while(e>=1&&(n[this.pos++]|=128))}this.pos++,this.buf=n}writeString(t){let e=Buffer.byteLength(t),r=this.buf;this.writeLong(e);let n=this.pos;if(this.pos+=e,!(this.pos>r.length)){if(e>64)this.buf.write(t,this.pos-e,e,"utf8");else{let o,i,s,a;for(o=0,i=e;o<i;o++)s=t.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=63&s|128):55296==(64512&s)&&56320==(64512&(a=t.charCodeAt(o+1)))?(s=65536+((1023&s)<<10)+(1023&a),o++,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=63&s|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=63&s|128)}this.buf=r}}readLong(){let t,e,r,n,o=0,i=0,s=this.buf;do{t=s[this.pos++],e=128&t,o|=(127&t)<<i,i+=7}while(e&&i<28);if(e){r=o,n=268435456;do{t=s[this.pos++],r+=(127&t)*n,n*=128}while(128&t);return(r%2?-(r+1):r)/2}return o>>1^-(1&o)}skipLong(){let t=this.buf;for(;128&t[this.pos++];);}readTags(){let t,e=[];for(;t=this.readLong();)for(t<0&&(t=-t,this.skipLong());t--;){let t=this.readString(),r=this.readString();e.push({name:t,value:r})}return e}readString(){let t=this.readLong(),e=this.pos,r=this.buf;if(this.pos+=t,!(this.pos>r.length))return this.buf.slice(e,e+t).toString()}};function Rr(t){let e=new Or;return e.writeTags(t),e.toBuffer()}function Cr(t){let e=new Or;return e.writeTags(t),e.tagsExceedLimit()}function Ur(t){return new Or(t).readTags()}function Br(t){let e=0;for(let r=t.length-1;r>=0;r--)e=256*e+t[r];return e}function Pr(t){let e=[0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++){let n=255&t;e[r]=n,t=(t-n)/256}return Uint8Array.from(e)}var Lr=tr(ur(),1),xr=tr(cr(),1),Nr=4096,jr=80,Dr=class{binary;_id;constructor(t){this.binary=t}static isDataItem(t){return void 0!==t.binary}get signatureType(){let t=Br(this.binary.subarray(0,2));if(void 0!==wr?.[t])return t;throw new Error("Unknown signature type: "+t)}async isValid(){return Dr.verify(this.binary)}get id(){return(async()=>Tr.default.encode(await this.rawId))()}set id(t){this._id=Tr.default.toBuffer(t)}get rawId(){return(async()=>xr.Buffer.from(await Lr.Crypto.subtle.digest("SHA-256",this.rawSignature)))()}set rawId(t){this._id=t}get rawSignature(){return this.binary.subarray(2,2+this.signatureLength)}get signature(){return Tr.default.encode(this.rawSignature)}set rawOwner(t){if(t.byteLength!=this.ownerLength)throw new Error(`Expected raw owner (pubkey) to be ${this.ownerLength} bytes, got ${t.byteLength} bytes.`);this.binary.set(t,2+this.signatureLength)}get rawOwner(){return this.binary.subarray(2+this.signatureLength,2+this.signatureLength+this.ownerLength)}get signatureLength(){return Er[this.signatureType].sigLength}get owner(){return Tr.default.encode(this.rawOwner)}get ownerLength(){return Er[this.signatureType].pubLength}get rawTarget(){let t=this.getTargetStart();return 1==this.binary[t]?this.binary.subarray(t+1,t+33):xr.Buffer.alloc(0)}get target(){return Tr.default.encode(this.rawTarget)}get rawAnchor(){let t=this.getAnchorStart();return 1==this.binary[t]?this.binary.subarray(t+1,t+33):xr.Buffer.alloc(0)}get anchor(){return this.rawAnchor.toString()}get rawTags(){let t=this.getTagsStart(),e=Br(this.binary.subarray(t+8,t+16));return this.binary.subarray(t+16,t+16+e)}get tags(){let t=this.getTagsStart();if(0==Br(this.binary.subarray(t,t+8)))return[];let e=Br(this.binary.subarray(t+8,t+16));return Ur(xr.Buffer.from(this.binary.subarray(t+16,t+16+e)))}get tagsB64Url(){return this.tags.map((t=>({name:Tr.default.encode(t.name),value:Tr.default.encode(t.value)})))}getStartOfData(){let t=this.getTagsStart();return t+16+Br(this.binary.subarray(t+8,t+16))}get rawData(){let t=this.getTagsStart(),e=t+16+Br(this.binary.subarray(t+8,t+16));return this.binary.subarray(e,this.binary.length)}get data(){return Tr.default.encode(this.rawData)}getRaw(){return this.binary}async sign(t){return this._id=await Ir(this,t),this.rawId}async setSignature(t){this.binary.set(t,2),this._id=xr.Buffer.from(await _r().hash(t))}isSigned(){return(this._id?.length??0)>0}toJSON(){return{signature:this.signature,owner:this.owner,target:this.target,tags:this.tags.map((t=>({name:Tr.default.encode(t.name),value:Tr.default.encode(t.value)}))),data:this.data}}static async verify(t){if(t.byteLength<jr)return!1;let e=new Dr(t),r=e.signatureType,n=e.getTagsStart(),o=Br(t.subarray(n,n+8)),i=Br(t.subarray(n+8,n+16));if(i>Nr)return!1;if(o>0)try{if(Ur(xr.Buffer.from(t.subarray(n+16,n+16+i))).length!==o)return!1}catch{return!1}let s=Ar[r],a=await kr(e);return await s.verify(e.rawOwner,a,e.rawSignature)}async getSignatureData(){return kr(this)}getTagsStart(){let t=this.getTargetStart(),e=t+(1==this.binary[t]?33:1);return e+=1==this.binary[e]?33:1,e}getTargetStart(){return 2+this.signatureLength+this.ownerLength}getAnchorStart(){let t=this.getTargetStart()+1;return t+=1==this.binary[this.getTargetStart()]?32:0,t}},Kr=tr(nr(),1);function Mr(t,e,r){let n=e.publicKey,o=r?.target?Kr.default.toBuffer(r.target):null,i=1+(o?.byteLength??0),s=r?.anchor?Buffer.from(r.anchor):null,a=1+(s?.byteLength??0),c=(r?.tags?.length??0)>0?Rr(r.tags):null,u=16+(c?c.byteLength:0),l=Buffer.from(t),h=l.byteLength,f=2+e.signatureLength+e.ownerLength+i+a+u+h,d=Buffer.alloc(f);if(d.set(function(t){if(t>29)throw new Error("Short too long");let e=[0,0];for(let r=0;r<e.length;r++){let n=255&t;e[r]=n,t=(t-n)/256}return Uint8Array.from(e)}(e.signatureType),0),d.set(new Uint8Array(e.signatureLength).fill(0),2),n.byteLength!==e.ownerLength)throw new Error(`Owner must be ${e.ownerLength} bytes, but was incorrectly ${n.byteLength}`);d.set(n,2+e.signatureLength);let p=2+e.signatureLength+e.ownerLength;if(d[p]=o?1:0,o){if(32!==o.byteLength)throw new Error(`Target must be 32 bytes but was incorrectly ${o.byteLength}`);d.set(o,p+1)}let g=p+i,y=g+1;if(d[g]=s?1:0,s){if(y+=s.byteLength,32!==s.byteLength)throw new Error("Anchor must be 32 bytes");d.set(s,g+1)}d.set(Pr(r?.tags?.length??0),y);let w=Pr(c?.byteLength??0);d.set(w,y+8),c&&d.set(c,y+16);let m=y+u;return d.set(l,m),new Dr(d)}var $r={...lr};globalThis.arbundles??=$r;const{Axios:Fr,AxiosError:Wr,CanceledError:zr,isCancel:Zr,CancelToken:Hr,VERSION:Vr,all:Xr,Cancel:Jr,isAxiosError:qr,spread:Gr,toFormData:Yr,AxiosHeaders:Qr,HttpStatusCode:tn,formToJSON:en,getAdapter:rn,mergeConfig:nn}=Ze;var on=a(386),sn={debug:!1,inject:!1,auth0Domain:"auth.othent.io",auth0ClientId:"uXkRmJoIa0NfzYgYEDAgj6Rss4wR1tIc",auth0Strategy:"refresh-tokens",auth0Cache:"memory",auth0RefreshTokenExpirationMs:1296e6,auth0LogInMethod:"popup",auth0RedirectURI:null,auth0ReturnToURI:null,serverBaseURL:"https://kms-server.othent.io",autoConnect:"lazy",cookieKey:null,localStorageKey:null,throwErrors:!0,tags:[]},an={...sn,appName:"",appVersion:"",persistCookie:!1,persistLocalStorage:!1,auth0Cache:"memory"},cn={host:"arweave.net",protocol:"https",port:443},un="othentUserDetails",ln="Othent KMS",hn="2.0.0-beta.10",fn=[{name:"Client",value:ln},{name:"Client-Version",value:hn}],dn=class{constructor(t){this.listeners=new Set,this.initializedListeners=new Set,this.lastEmittedUpdateId="",this.lastEmittedParams=null,this.options={diffParams:!1,replyOnListen:!1},this.options={...this.options,...t}}getUpdateId(t){const{getUpdateIdTransform:e}=this.options,r=e?e(t):t;return JSON.stringify(r,((t,e)=>e&&"oject"===e&&!Array.isArray(e)?Object.entries(e).sort(((t,e)=>t[0].localeCompare(e[0]))):e))}get hasListeners(){return this.listeners.size>0}add(t){this.listeners.add(t),this.options.replyOnListen&&this.lastEmittedParams&&this.emit(...this.lastEmittedParams)}delete(t){this.listeners.add(t)}emit(...t){const{initializedListeners:e,lastEmittedUpdateId:r}=this,n=this.getUpdateId(t),o=r===n;return this.lastEmittedUpdateId=n,this.lastEmittedParams=t,this.listeners.forEach((r=>{if(!o||!e.has(r)){e.add(r);try{r(...t)}catch(t){}}})),o}};function pn(t,e){return et(!0,{},e,t)}var gn={secure:!0,domain:!0,ttlHours:360},yn=class t{constructor(e=gn){this.secureParam=null,this.domainParam=null,this.ttlMs=1296e6;const{secureParam:r,domainParam:n,ttlMs:o}=this.parseCookieOptions(pn(e,gn));return this.secureParam=r,this.domainParam=n,this.ttlMs=o,new Proxy(this,{get:(t,e)=>e in t||"string"!=typeof e?t[e]:t.getItem(e),ownKeys:e=>document.cookie.split(t.COOKIE_SEPARATOR).map((e=>e.split(t.COOKIE_VALUE_SEPARATOR)[0])),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0})})}parseCookieOptions({secure:t,domain:e,ttlHours:r}={}){return{secureParam:t?"secure":void 0===t?this.secureParam:null,domainParam:e?`domain=${!0===e?location.host:e}`:void 0===e?this.domainParam:null,ttlMs:r?36e5*r:void 0===r?this.ttlMs:0}}getCookieParams(t){const{secureParam:e,domainParam:r,ttlMs:n}=this.parseCookieOptions(t),o=[`expires=${new Date(Date.now()+n).toUTCString()}`,e,r,"path=/"].filter(Boolean).join("; ");return o?` ${o};`:""}get length(){return document.cookie?document.cookie.split(t.COOKIE_SEPARATOR).length:0}key(e){return(document.cookie.split(t.COOKIE_SEPARATOR)[e]||"").split(t.COOKIE_VALUE_SEPARATOR)[0]||null}getItem(e){const r=document.cookie.split(t.COOKIE_SEPARATOR).find((r=>r.split(t.COOKIE_VALUE_SEPARATOR)[0]===e));return r&&r.split(t.COOKIE_VALUE_SEPARATOR)[1]||null}setItem(t,e,r){const n=`${t}=${"string"==typeof e?e:JSON.stringify(e)};${this.getCookieParams(r)}`;return document.cookie=n,n}removeItem(t,e){return this.setItem(t,"",{...e,ttlHours:-1})}clear(){document.cookie.split(t.COOKIE_SEPARATOR).forEach((e=>{this.removeItem(e.split(t.COOKIE_VALUE_SEPARATOR)[0])}))}};yn.COOKIE_SEPARATOR=/\s*;\s*/,yn.COOKIE_VALUE_SEPARATOR=/\s*=\s*/;var wn=yn,mn=null;var bn=class t{constructor({debug:t,domain:e,clientId:r,strategy:n,cache:o,refreshTokenExpirationMs:i,loginMethod:s,redirectURI:a,returnToURI:c,appInfo:u,initialUserDetails:l,cookieKey:h,localStorageKey:f}){this.debug=!1,this.auth0ClientPromise=Promise.resolve(null),this.authEventListenerHandler=new dn({diffParams:!0,replyOnListen:!0}),this.userDetails=null,this.userDetailsExpirationTimeoutID=0,this.cookieKey=null,this.localStorageKey=null,this.refreshTokenExpirationMs=+sn.auth0RefreshTokenExpirationMs,this.appInfo={name:"",version:""},this.isReady=!1,this.isAuthenticated=!1,this.debug=t,this.loginMethod=s,this.redirectURI=a,this.returnToURI=c,this.auth0ClientPromise=async function(t){const e=new tt(t);return await e.checkSession(),e}({domain:e,clientId:r,useRefreshTokens:"refresh-tokens"===n,cacheLocation:"string"==typeof o?o:void 0,cache:"object"==typeof o?o:void 0,authorizationParams:{redirect_uri:this.redirectURI}}).then((t=>(this.isReady=!0,t))),this.cookieKey=h,this.localStorageKey=f,this.refreshTokenExpirationMs=i,this.appInfo=u,this.restoreUserDetails(l||null),this.handleStorage=this.handleStorage.bind(this)}static isIdTokenValidUser(t){return!!(t&&t.sub&&t.owner&&t.walletAddress&&"KMS"===t.authSystem)}static async getUserDetails(e){const{email:r="",walletAddress:n}=e,o=e.sub||"",i=o.split("|")[0];let s=await async function(t){try{const e=(await Ze.get("https://api.mem.tech/api/state/Tih8T1uESATJNzdwBIY3rpe25kWTzjw8uNiMRYe9I5M",{timeout:2e3})).data.balances.find((e=>e.address===t)),r=e&&(e.primary_domain||e.ownedDomains[0].domain)||null;return r?`${r}.ar`:null}catch(e){return console.warn(`Error resolving ANS domain for ${t} =\n`,e),null}}(n);if(!s){s=`${t.PROVIDER_LABELS[i]||"Unknown Provider"} (${r})`}return{sub:o,name:e.name||"",givenName:e.given_name||"",middleName:e.middle_name||"",familyName:e.family_name||"",nickname:e.nickname||"",preferredUsername:e.preferred_username||"",profile:e.profile||"",picture:e.picture||"",website:e.website||"",locale:e.locale||"",updatedAt:e.updated_at||"",email:r,emailVerified:!!e.email_verified,owner:e.owner,walletAddress:e.walletAddress,walletAddressLabel:s,authSystem:e.authSystem,authProvider:i}}getAuthEventListenerHandler(){return this.authEventListenerHandler}setAppInfo(t){this.appInfo=t}initStorageSyncing(){this.localStorageKey&&window.addEventListener("storage",this.handleStorage)}stopStorageSyncing(){window.removeEventListener("storage",this.handleStorage)}handleStorage(t){t.key===this.localStorageKey&&(t.newValue?this.restoreUserDetails():this.logOut())}persistUserDetails(t){const{cookieKey:e,localStorageKey:r}=this;if(e){const r=function(){if(!mn){const t=!1;mn=new wn({secure:!t&&void 0,domain:!t&&void 0})}return mn}();t?r.setItem(e,JSON.stringify(t)):null!==r.getItem(e)&&r.removeItem(e)}if(r)if(t){const e=new Date,n=JSON.stringify({userDetails:t,createdAt:e.toUTCString(),expiredBy:new Date(e.getTime()+this.refreshTokenExpirationMs).toUTCString()});localStorage.setItem(r,n)}else this.clearStoredUserDetails()}setUserDetails(t,e=!0){window.clearTimeout(this.userDetailsExpirationTimeoutID),t&&(this.userDetailsExpirationTimeoutID=window.setTimeout(this.logOut,this.refreshTokenExpirationMs));return this.authEventListenerHandler.emit(t,e?!!t:this.isAuthenticated)||(this.userDetails=t),e&&(this.isAuthenticated=!!t,this.persistUserDetails(t)),t}restoreUserDetails(t){let e=t||null;if(!e&&this.localStorageKey)try{const t=JSON.parse(localStorage.getItem(this.localStorageKey)||"null");if(t){const r=new Date(t.expiredBy).getTime();!isNaN(r)&&r>Date.now()?e=t.userDetails:this.clearStoredUserDetails()}}catch(t){}this.setUserDetails(e,!1)}clearStoredUserDetails(){Object.keys(localStorage).forEach((t=>{t.startsWith("othent")&&localStorage.removeItem(t)}))}async updateUserDetails(e){const r=e&&t.isIdTokenValidUser(e)?await t.getUserDetails(e):null;return this.setUserDetails(r)}getAuthorizationParams(t={}){const{authorizationParams:e,data:r}=t.hasOwnProperty("keyName")?{authorizationParams:null,data:t}:{authorizationParams:t,data:null},n={othentFunction:"KMS",othentSDKVersion:ln,othentAPIVersion:hn,appName:this.appInfo.name,appVersion:this.appInfo.version};return r&&(n.data=r),{...e,transaction_input:JSON.stringify(n,((t,e)=>{let r=[];if(e instanceof Buffer||e instanceof DataView||ArrayBuffer.isView(e))r=Array.from(new Uint8Array(e.buffer));else{if(!(e instanceof ArrayBuffer))return e;r=Array.from(new Uint8Array(e))}return"data"===t?Object.fromEntries(Object.entries(r)):{type:"Buffer",data:r}}))}}async getTokenSilently(t){const e=await this.auth0ClientPromise;if(!e)throw new Error("Missing Auth0 Client");const r=this.getAuthorizationParams(t);if(this.debug)try{console.log("getTokenSilently() =",{...r,transaction_input:JSON.parse(r.transaction_input)})}catch(t){console.error("Error logging/parsing `authorizationParams`:",t)}try{const t=await e.getTokenSilently({detailedResponse:!0,authorizationParams:r,cacheMode:"off"}),n=await e.getUser();if(!n)throw new Error("Could not get the user's details");const o=await this.updateUserDetails(n);return{...t,idToken:n,userDetails:o}}catch(t){throw t}}async logIn(){const t=await this.auth0ClientPromise;if(!t)throw new Error("Missing Auth0 Client");this.debug&&console.log("logIn()");if(await t.isAuthenticated())throw new Error("Already logged in");const e=this.getAuthorizationParams({redirect_uri:this.redirectURI});if("popup"!==this.loginMethod)throw t.loginWithRedirect({authorizationParams:e}),new Error("Redirecting...");return await t.loginWithPopup({authorizationParams:e},{}),this.getTokenSilently()}async handleRedirectCallback(t){this.debug&&console.log(`handleRedirectCallback(${t})`);const e=await this.auth0ClientPromise;if(!e)throw new Error("Missing Auth0 Client");await e.handleRedirectCallback(t);const r=await e.getUser();if(!r)throw new Error("Could not get the user's details");return this.updateUserDetails(r)}async logOut(){this.setUserDetails(null);const t=await this.auth0ClientPromise;if(!t)throw new Error("Missing Auth0 Client");return t.logout({logoutParams:{returnTo:this.returnToURI}}).catch((t=>{console.warn(t instanceof Error?t.message:t),"undefined"!=typeof location&&location.reload()}))}async encodeToken(t){return(await this.getTokenSilently(t)).id_token}getCachedUserDetails(){return this.userDetails}getCachedUserPublicKey(){var t;return(null==(t=this.userDetails)?void 0:t.owner)||null}getCachedUserSub(){var t;return(null==(t=this.userDetails)?void 0:t.sub)||null}getCachedUserAddress(){var t;return(null==(t=this.userDetails)?void 0:t.walletAddress)||null}getCachedUserAddressLabel(){var t;return(null==(t=this.userDetails)?void 0:t.walletAddressLabel)||null}getCachedUserEmail(){var t;return(null==(t=this.userDetails)?void 0:t.email)||null}};bn.PROVIDER_LABELS={apple:"Apple",auth0:"E-Mail","google-oauth2":"Google","<LinkedIn>":"LinkedIn","<X>":"X","<Meta>":"Meta","<Twitch>":"Twitch",github:"GitHub"};var vn=bn;function _n(t){return"string"==typeof t?En(t):t}function En(t){return(new TextEncoder).encode(t)}function Sn(t){return e=function(t){return He.fromByteArray(new Uint8Array(t))}(t),e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");var e}async function An(t,e="SHA-256"){let r=await crypto.subtle.digest(e,t);return new Uint8Array(r)}var Tn=(t=>(t.Unexpected="Unexpected",t.Validation="Validation",t.UserCreation="UserCreation",t.Encryption="Encryption",t.Decryption="Decryption",t.Signing="Signing",t.PublicKey="PublicKey",t))(Tn||{}),kn=class extends Error{constructor(t,e,r,n=!1){super(),this.name=t,this.message=e||"",n?this.stack=`${t} (from server): ${e}\n`:Error.captureStackTrace(this),this.id=t,this.developerMessage=e,r instanceof Error?this.cause=r:"string"!=typeof r&&"number"!=typeof r||(this.cause=new Error(`${r}`))}};function In(t){var e;if(qr(t)){const r=null==(e=t.response)?void 0:e.data;if(!function(t){return"object"==typeof t&&!0===t.error&&!!t.id&&!!Tn[t.id]}(r))return t;const{id:n,developerMessage:o,cause:i}=r;let s;return i&&(s=new Error(i.message),s.name=i.name,s.stack=i.stack),new kn(n,o||"",s,!0)}return t instanceof Error?t:new Error("Unknown error")}async function On(t,e,r,n){var o;const i=await e.encodeToken({ciphertext:r,keyName:n});let s=null;try{s=null!=(o=(await t.post("/decrypt",{encodedData:i})).data.data)?o:null}catch(t){throw In(t)}if(null===s)throw new Error("Error decrypting on server.");return"string"==typeof s?s:(a=new Uint8Array(s.data),(new TextDecoder).decode(a));var a}var Rn=class{constructor(t,e){this.api=Ze.create({baseURL:t}),this.auth0=e}async createUser(t){return async function(t,e){let r=!1;try{r=(await t.post("/create-user",{encodedData:e})).data.data}catch(t){throw In(t)}if(!r)throw new Error("Error creating user on server.");return!0}(this.api,t)}async decrypt(t,e){return On(this.api,this.auth0,t,e)}async encrypt(t,e){return async function(t,e,r,n){var o;const i=await e.encodeToken({plaintext:r,keyName:n});let s=null;try{s=null!=(o=(await t.post("/encrypt",{encodedData:i})).data.data)?o:null}catch(t){throw In(t)}if(null===s)throw new Error("Error encrypting on server.");return"string"==typeof s?En(s):new Uint8Array(s.data)}(this.api,this.auth0,t,e)}async sign(t,e){return async function(t,e,r,n){const o=await e.encodeToken({data:r,keyName:n});let i=null;try{i=(await t.post("/sign",{encodedData:o})).data.data}catch(t){throw In(t)}if(null===i)throw new Error("Error signing data on server.");return"string"==typeof i?En(i):new Uint8Array(i.data)}(this.api,this.auth0,t,e)}getSignerSignFn(t){return async e=>await this.sign(e,t)}};function Cn(t,e="utf8"){return n.lW.isBuffer(t)?Bn(t.toString("base64")):Bn(n.lW.from(t,e).toString("base64"))}function Un(t){return function(t){let e=t.length,r=e%4;if(!r)return t;let o=e,i=4-r,s=e+i,a=n.lW.alloc(s);for(a.write(t);i--;)a.write("=",o++);return a.toString()}(t=t.toString()).replace(/\-/g,"+").replace(/_/g,"/")}function Bn(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Pn(t){return n.lW.from(Un(t),"base64")}var Ln=Cn;function xn(t){return on.default.init(t)}Ln.encode=Cn,Ln.decode=function(t,e="utf8"){return n.lW.from(Un(t),"base64").toString(e)},Ln.toBase64=Un,Ln.fromBase64=Bn,Ln.toBuffer=Pn;var Nn=class t{constructor(t=an){this.errorEventListenerHandler=new dn,this.tokens=new Set,this.walletName=ln,this.walletVersion=hn,this.config=sn,this.appInfo={name:"",version:""},this.gatewayConfig=cn;let{appName:e,appVersion:r,persistCookie:n,persistLocalStorage:o,auth0Cache:i=sn.auth0Cache,auth0RedirectURI:s,auth0ReturnToURI:a,gatewayConfig:c,initialUserDetails:u,...l}=t;const h="undefined"==typeof location?null:location.origin;this.config={...pn(l,sn),cookieKey:"string"==typeof n?n:n?un:null,localStorageKey:"string"==typeof o?o:o?un:null,auth0Cache:"object"==typeof i?"custom":i,auth0RedirectURI:s||h,auth0ReturnToURI:a||h};const{config:f}=this,{cookieKey:d,localStorageKey:p}=f;if("string"==typeof d&&!d.startsWith("othent"))throw new Error('`persistCookie` / `cookieKey` must start with "othent".');if("string"==typeof p&&!p.startsWith("othent"))throw new Error('`persistLocalStorage` / `localStorageKey` must start with "othent".');if(!f.auth0RedirectURI)throw new Error("`auth0RedirectURI` is required.");if(!f.auth0ReturnToURI)throw new Error("`auth0ReturnToURI` is required.");this.appInfo={name:e,version:r},this.gatewayConfig=c||cn;let g=null;if("undefined"!=typeof window)g=window.crypto;else{if("undefined"==typeof global)throw new Error("A Crypto module is needed for Othent to work. If your environment doesn't natively provide one, you should polyfill it.");g=global.crypto}if(this.crypto=g,"eager"===f.autoConnect&&"popup"===f.auth0LogInMethod&&"refresh-tokens"===f.auth0Strategy&&"memory"===i)throw new Error('The browser cannot open the authentication modal automatically before an user interaction. Use `autoConnect = "lazy"` or change any of these other options: `auth0LogInMethod`, `auth0Strategy` or `auth0Cache`.');if(this.auth0=new vn({debug:f.debug,domain:f.auth0Domain,clientId:f.auth0ClientId,strategy:f.auth0Strategy,cache:i,refreshTokenExpirationMs:f.auth0RefreshTokenExpirationMs,redirectURI:f.auth0RedirectURI,returnToURI:f.auth0ReturnToURI,loginMethod:f.auth0LogInMethod,appInfo:this.appInfo,initialUserDetails:u,cookieKey:f.cookieKey,localStorageKey:f.localStorageKey}),"eager"===this.config.autoConnect){let t="undefined"==typeof location;if(!t){const e=new URL(location.href),{searchParams:r}=e;r.has("code")||r.has("state")||(t=!0)}t&&this.connect()}if(f.inject&&(window.arweaveWallet=this),!f.throwErrors){["connect","disconnect","getActiveAddress","getActivePublicKey","getAllAddresses","getWalletNames","getUserDetails","getSyncActiveAddress","getSyncActivePublicKey","getSyncAllAddresses","getSyncWalletNames","getSyncUserDetails","sign","dispatch","encrypt","decrypt","signature","signDataItem","signMessage","verifyMessage","privateHash","getArweaveConfig","getPermissions"].forEach((t=>{let e=this[t];"function"==typeof e&&(e=e.bind(this),this[t]=(...t)=>{try{let n=e(...t);return!(r=n)||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof r.then||(n=n.catch((t=>(this.onError(t),null)))),n}catch(t){this.onError(t)}var r;return null})}))}this.api=new Rn(this.config.serverBaseURL,this.auth0)}startTabSynching(){return this.config.localStorageKey||console.warn("Calling `Othent.startTabSynching()` is a NOOP unless the `persistLocalStorage` option is used."),this.auth0.initStorageSyncing(),()=>{this.auth0.stopStorageSyncing()}}async completeConnectionAfterRedirect(t){"redirect"!==this.config.auth0LogInMethod&&console.warn('Calling `Othent.completeConnectionAfterRedirect()` is a NOOP unless the `auth0LogInMethod` options is `"redirect"`.');const e=t||("undefined"==typeof location?"":location.href),r=new URL(e.replace(/.+\.auth0:\/\//,"https://")),{searchParams:n}=r;if(!n.has("code")||!n.has("state")||!e)return null;let o=null;try{o=await this.auth0.handleRedirectCallback(e)}finally{"undefined"!=typeof location&&"undefined"!=typeof history&&(n.delete("code"),n.delete("state"),history.replaceState(null,"",r))}return o}get isReady(){return this.auth0.isReady}onError(t){t instanceof Error?this.errorEventListenerHandler.hasListeners?this.errorEventListenerHandler.emit(t):console.warn("Unhandled unthrown error:\n",t,'\nWhen using `throwErrors = false`, you must add at least one error event listener with `othent.addEventListener("error", () => { ... })`'):console.warn("Unknown error type",t)}addEventListener(t,e){let r=null;if("auth"===t)r=this.auth0.getAuthEventListenerHandler();else if("error"===t){if(this.config.throwErrors)throw new Error("You can only listen for `error` events if `throwErrors = false`.");r=this.errorEventListenerHandler}if(!r)throw new Error("Unknown event type");return r.add(e),()=>{r.delete(e)}}removeEventListener(t,e){let r=null;if("auth"===t?r=this.auth0.getAuthEventListenerHandler():"error"===t&&(r=this.errorEventListenerHandler),!r)throw new Error("Unknown event type");r.delete(e)}get isAuthenticated(){return this.auth0.isAuthenticated}requireAuth(){return this.requireUserDataOrThrow().then((()=>{}))}async requireUserDataOrThrow(){"off"===this.config.autoConnect||this.auth0.isAuthenticated||await this.connect(void 0,void 0,this.gatewayConfig);const{sub:t,owner:e}=this.auth0.getCachedUserDetails()||{};if(!t||!e)throw new Error("Missing cached user.");return{sub:t,publicKey:e}}async connect(e,r,n){if(e&&e.toSorted().join("-")!==t.ALL_PERMISSIONS.join("-"))throw new Error("Othent implicitly has access to all available permissions. You should pass `permissions = undefined` or include all of them.");r&&(this.appInfo=r,this.auth0.setAppInfo(r)),this.gatewayConfig=n||cn;let o="",i=null;try{const t=await this.auth0.getTokenSilently();o=t.id_token,i=t.userDetails}catch(t){if(!(t instanceof Error))throw t;if("Login required"!==t.message&&!(t instanceof _))throw t;console.warn(t.message)}if(!o)try{const t=await this.auth0.logIn();o=t.id_token,i=t.userDetails}catch(t){if(!(t instanceof Error))throw t;if("Redirecting..."===t.message&&await new Promise((()=>{})),t.message.startsWith("Unable to open a popup")||t instanceof b||t instanceof m)return t instanceof m&&t.popup.close(),console.warn(t.message),null;throw t}if(o&&!i){await this.api.createUser(o);const t=await this.auth0.getTokenSilently();o=t.id_token,i=t.userDetails}if(o&&i)return i;throw this.auth0.logOut(),new Error("Unexpected authentication error")}async disconnect(){return this.auth0.logOut()}getActiveAddress(){return Promise.resolve(this.getSyncActiveAddress())}getActivePublicKey(){return Promise.resolve(this.getSyncActivePublicKey())}getAllAddresses(){return Promise.resolve(this.getSyncAllAddresses())}getWalletNames(){return Promise.resolve(this.getSyncWalletNames())}getUserDetails(){return Promise.resolve(this.getSyncUserDetails())}getSyncActiveAddress(){return this.auth0.getCachedUserAddress()||""}getSyncActivePublicKey(){return this.auth0.getCachedUserPublicKey()||""}getSyncAllAddresses(){const t=this.auth0.getCachedUserAddress();return t?[t]:[]}getSyncWalletNames(){const t=this.auth0.getCachedUserAddress(),e=this.auth0.getCachedUserAddressLabel();return Promise.resolve(t&&e?{[t]:e}:{})}getSyncUserDetails(){return this.auth0.getCachedUserDetails()}addCommonTags(t=[]){if(Array.isArray(t)){const e=[{name:"App-Name",value:this.appInfo.name},{name:"App-Version",value:this.appInfo.version}];return[...t,...this.config.tags,...e,...fn]}for(const{name:e,value:r}of this.config.tags)t.addTag(e,r);t.addTag("App-Name",this.appInfo.name),t.addTag("App-Version",this.appInfo.version);for(const{name:e,value:r}of fn)t.addTag(e,r)}async sign(t){const{sub:e,publicKey:r}=await this.requireUserDataOrThrow(),n=xn(this.gatewayConfig),o=t.get("tags").map((t=>({name:t.get("name",{decode:!0,string:!0}),value:t.get("value",{decode:!0,string:!0})}))),i=this.addCommonTags(o),s=await n.createTransaction({data:t.data,owner:r,reward:t.reward});i.forEach((t=>{s.addTag(t.name,t.value)}));const a=await s.getSignatureData(),c=await this.api.sign(a,e),u=await An(c);return s.setSignature({id:Sn(u),owner:r,signature:Sn(c),tags:s.tags,reward:s.reward}),s}async dispatch(t,e){var r;const n=t.get("tags").map((t=>({name:t.get("name",{decode:!0,string:!0}),value:t.get("value",{decode:!0,string:!0})}))),o=await this.signDataItem({data:t.data,tags:n,target:t.target}),i=`${(null==e?void 0:e.node)||"https://turbo.ardrive.io"}/tx`;try{const t=await Ze.post(i,o,{headers:{"Content-Type":"application/octet-stream"},maxBodyLength:1/0,maxContentLength:1/0,responseType:"json"});if(t.status>=400)throw new Error(`${t.status} - ${JSON.stringify(t.data)}`);return{...t.data,type:"BUNDLED"}}catch(n){console.warn(`Error dispatching transaction to ${i} =\n`,n);const o=await this.sign(t),s=null!=(r=null==e?void 0:e.arweave)?r:xn(this.gatewayConfig),a=await s.transactions.getUploader(o);for(;!a.isComplete;)await a.uploadChunk();return{id:o.id,signature:o.signature,owner:o.owner,type:"BASE"}}}async encrypt(t){const{sub:e}=await this.requireUserDataOrThrow();return await this.api.encrypt(t,e)}async decrypt(t){const{sub:e}=await this.requireUserDataOrThrow();return await this.api.decrypt(t,e)}async signature(t){const{sub:e}=await this.requireUserDataOrThrow();return await this.api.sign(t,e)}async signDataItem(t){const{sub:e,publicKey:r}=await this.requireUserDataOrThrow(),{data:n,tags:o,...i}=t,s={publicKey:Pn(r),signatureType:1,signatureLength:512,ownerLength:512,sign:this.api.getSignerSignFn(e)},a=Mr(n,s,{...i,tags:this.addCommonTags(o)});return await a.sign(s),a.getRaw().buffer}async signMessage(t,e){const{sub:r}=await this.requireUserDataOrThrow(),n=(null==e?void 0:e.hashAlgorithm)||"SHA-256",o=await this.crypto.subtle.digest(n,_n(t));return await this.api.sign(o,r)}async verifyMessage(t,e,r,n={hashAlgorithm:"SHA-256"}){if(!r){const t=await this.requireUserDataOrThrow();r||(r=t.publicKey)}const o=(null==n?void 0:n.hashAlgorithm)||"SHA-256",i=await this.crypto.subtle.digest(o,_n(t)),s={e:"AQAB",ext:!0,kty:"RSA",n:r},a=await this.crypto.subtle.importKey("jwk",s,{name:"RSA-PSS",hash:n.hashAlgorithm},!1,["verify"]);return await this.crypto.subtle.verify({name:"RSA-PSS",saltLength:32},a,_n(e),i)}async privateHash(t,e){return An(_n(t),null==e?void 0:e.hashAlgorithm)}getArweaveConfig(){return Promise.resolve(this.gatewayConfig)}getPermissions(){return Promise.resolve(t.ALL_PERMISSIONS)}addToken(t,e,r){return console.warn("Othent doesn't currently support this feature and only tracks added tokens temporarily in memory."),this.tokens.add(t),Promise.resolve()}isTokenAdded(t){return console.warn("Othent doesn't currently support this feature and only tracks added tokens temporarily in memory."),Promise.resolve(this.tokens.has(t))}};Nn.walletName=ln,Nn.walletVersion=hn,Nn.ALL_PERMISSIONS=["ACCESS_ADDRESS","ACCESS_ALL_ADDRESSES","ACCESS_ARWEAVE_CONFIG","ACCESS_PUBLIC_KEY","DECRYPT","DISPATCH","ENCRYPT","SIGN_TRANSACTION","SIGNATURE"];var jn=Nn;async function Dn(t){const e={Info:{hashedOthentSub:t},request:"PIN"};return await fetch("https://api2.onairos.uk/getAccountInfoFromOthentSub",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>t.json())).then((t=>t)).catch((t=>console.error(t)))}window.Buffer=n.lW;class Kn extends Error{constructor(t,e,r){super("object"==typeof e?e.message:e||t,{cause:"object"==typeof e?e.cause:r}),this.type=t,this.name="TypedError",Object.setPrototypeOf(this,Kn.prototype)}}const Mn="ERR_INVALID_VALUE",$n="ERR_UNEXPECTED_VALUE",Fn="ERR_UNEXPECTED_TYPE",Wn="ERR_PARSE";function zn(t,e){const r={};for(const n in t){const o=t[n];if(!o)continue;let i,s;"function"==typeof o?(i=n,s=o):[i,s]=o;try{const t=s(e(i));void 0!==t&&(r[n]=t)}catch(t){throw new Kn(Wn,`Parser for "${n}" property failed${i===n?"":`. Source field: "${i}"`}`,t)}}return r}function Zn(t){let e=t;if("string"==typeof e)try{e=JSON.parse(e)}catch(t){throw new Kn(Mn,{cause:t})}if("object"!=typeof e||!e||Array.isArray(e))throw new Kn($n);return e}function Hn(t,e){return r=>{const n=n=>{if(!r||void 0!==n)try{return e(n)}catch(e){throw new Kn(Wn,{message:`"${t}" transformer failed to parse the value`,cause:e})}};return Object.assign(n,{isValid(t){try{return n(t),!0}catch{return!1}}})}}function Vn(t,e){return Hn(e||"object",(e=>{const r=Zn(e);return zn(t,(t=>r[t]))}))}function Xn(t){throw new Kn(Fn,`Unexpected value received: ${JSON.stringify(t)}`)}Hn("boolean",(t=>{if("boolean"==typeof t)return t;const e=String(t);return"1"===e||"true"===e||"0"!==e&&"false"!==e&&void Xn(t)}));const Jn=Hn("string",(t=>{if("string"==typeof t||"number"==typeof t)return t.toString();Xn(t)})),qn=Hn("number",(t=>{if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);if(!Number.isNaN(e))return e}Xn(t)}));Hn("date",(t=>t instanceof Date?t:new Date(1e3*qn()(t))));function Gn(t){return/^#[\da-f]{6}$/i.test(t)}function Yn(t){const e=t.replace(/\s/g,"").toLowerCase();if(Gn(e))return e;if(function(t){return/^#[\da-f]{3}$/i.test(t)}(e)){let t="#";for(let r=0;r<3;r+=1)t+=e[1+r].repeat(2);return t}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce(((t,e)=>{const r=parseInt(e,10).toString(16);return t+(1===r.length?"0":"")+r}),"#")}const Qn=Hn("rgb",(t=>Yn(Jn()(t)))),to=Hn("themeParams",(t=>{const e=Qn(!0);return Object.entries(Zn(t)).reduce(((t,[r,n])=>(t[function(t){return t.replace(/_[a-z]/g,(t=>t[1].toUpperCase()))}(r)]=e(n),t)),{})}));class eo extends Error{constructor(t,e,r){super("object"==typeof e?e.message:e||t,{cause:"object"==typeof e?e.cause:r}),this.type=t,this.name="TypedError",Object.setPrototypeOf(this,eo.prototype)}}function ro(t){return t.replace(/[A-Z]/g,(t=>`_${t.toLowerCase()}`))}const no="ERR_INVALID_VALUE",oo="ERR_UNEXPECTED_VALUE",io="ERR_UNEXPECTED_TYPE",so="ERR_PARSE";function ao(t,e){const r={};for(const n in t){const o=t[n];if(!o)continue;let i,s;"function"==typeof o?(i=n,s=o):[i,s]=o;try{const t=s(e(i));void 0!==t&&(r[n]=t)}catch(t){throw new eo(so,`Parser for "${n}" property failed${i===n?"":`. Source field: "${i}"`}`,t)}}return r}function co(t){let e=t;if("string"==typeof e)try{e=JSON.parse(e)}catch(t){throw new eo(no,{cause:t})}if("object"!=typeof e||!e||Array.isArray(e))throw new eo(oo);return e}function uo(t,e){return r=>{const n=n=>{if(!r||void 0!==n)try{return e(n)}catch(e){throw new eo(so,{message:`"${t}" transformer failed to parse the value`,cause:e})}};return Object.assign(n,{isValid(t){try{return n(t),!0}catch{return!1}}})}}function lo(t,e){return uo(e||"object",(e=>{const r=co(e);return ao(t,(t=>r[t]))}))}function ho(t){throw new eo(io,`Unexpected value received: ${JSON.stringify(t)}`)}const fo=uo("boolean",(t=>{if("boolean"==typeof t)return t;const e=String(t);return"1"===e||"true"===e||"0"!==e&&"false"!==e&&void ho(t)})),po=uo("string",(t=>{if("string"==typeof t||"number"==typeof t)return t.toString();ho(t)})),go=uo("number",(t=>{if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);if(!Number.isNaN(e))return e}ho(t)})),yo=uo("date",(t=>t instanceof Date?t:new Date(1e3*go()(t))));function wo(t,e){return uo(e||"searchParams",(e=>{"string"!=typeof e&&!(e instanceof URLSearchParams)&&ho(e);const r="string"==typeof e?new URLSearchParams(e):e;return ao(t,(t=>{const e=r.get(t);return null===e?void 0:e}))}))}function mo(t){for(const e in t)t[e]=[ro(e),t[e]];return t}const bo=t=>{const e=go(),r=go(!0),n=po(),o=po(!0),i=fo(!0),s=lo(mo({addedToAttachmentMenu:i,allowsWriteToPm:i,firstName:n,id:e,isBot:i,isPremium:i,languageCode:o,lastName:o,photoUrl:o,username:o}),"User")(!0);return wo(mo({authDate:yo(),canSendAfter:r,chat:lo(mo({id:e,type:n,title:n,photoUrl:o,username:o}),"Chat")(!0),chatInstance:o,chatType:o,hash:n,queryId:o,receiver:s,startParam:o,signature:n,user:s}),"initData")(t)};const vo=uo("rgb",(t=>function(t){const e=t.replace(/\s/g,"").toLowerCase();if(function(t){return/^#[\da-f]{6}$/i.test(t)}(e))return e;if(function(t){return/^#[\da-f]{3}$/i.test(t)}(e)){let t="#";for(let r=0;r<3;r+=1)t+=e[1+r].repeat(2);return t}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce(((t,e)=>{const r=parseInt(e,10).toString(16);return t+(1===r.length?"0":"")+r}),"#")}(po()(t)))),_o=uo("themeParams",(t=>{const e=vo(!0);return Object.entries(co(t)).reduce(((t,[r,n])=>(t[function(t){return t.replace(/_[a-z]/g,(t=>t[1].toUpperCase()))}(r)]=e(n),t)),{})}));function Eo(t){return JSON.stringify(Object.fromEntries(Object.entries(t).map((([t,e])=>[ro(t),e]))))}const So=t=>{const e=po(),r=po(!0),n=fo(!0);return wo({botInline:["tgWebAppBotInline",n],defaultColors:["tgWebAppDefaultColors",_o(!0)],fullscreen:["tgWebAppFullscreen",n],initData:["tgWebAppData",bo(!0)],initDataRaw:["tgWebAppData",r],platform:["tgWebAppPlatform",e],showSettings:["tgWebAppShowSettings",n],startParam:["tgWebAppStartParam",r],themeParams:["tgWebAppThemeParams",_o()],version:["tgWebAppVersion",e]},"launchParams")(t)};function Ao(t){const{initDataRaw:e,startParam:r,showSettings:n,botInline:o,fullscreen:i,defaultColors:s}=t,a=new URLSearchParams;return a.set("tgWebAppPlatform",t.platform),a.set("tgWebAppThemeParams",Eo(t.themeParams)),a.set("tgWebAppVersion",t.version),e&&a.set("tgWebAppData",e),r&&a.set("tgWebAppStartParam",r),"boolean"==typeof n&&a.set("tgWebAppShowSettings",n?"1":"0"),"boolean"==typeof o&&a.set("tgWebAppBotInline",o?"1":"0"),"boolean"==typeof i&&a.set("tgWebAppFullscreen",i?"1":"0"),s&&a.set("tgWebAppDefaultColors",Eo(s)),a.toString()}const To=lo({eventType:po(),eventData:t=>t},"miniAppsMessage"),ko=uo("fn",(t=>{if("function"==typeof t)return t;ho(t)}));const Io=lo({TelegramWebviewProxy:lo({postEvent:ko()})()});function Oo(t){return Io().isValid(t)}var Ro=Object.defineProperty,Co=(t,e,r)=>((t,e,r)=>e in t?Ro(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);let Uo=class t extends Error{constructor(e,r,n){super("object"==typeof r?r.message:r||e,{cause:"object"==typeof r?r.cause:n}),this.type=e,this.name="TypedError",Object.setPrototypeOf(this,t.prototype)}};function Bo(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Po(...t){const e=t.flat(1);return[e.push.bind(e),()=>{e.forEach((t=>{t()}))}]}function Lo(t){return e=>function(t,e){return t instanceof Uo&&t.type===e}(e,t)}const xo="ERR_ABORTED",No="ERR_CANCELED",jo="ERR_TIMED_OUT";function Do(t){return new Uo(xo,{cause:t})}Lo(jo),Lo(xo),Lo(No);function Ko(t,e){return t.reject=e.reject,t}class Mo extends Promise{constructor(t,e){let r,n,o,i;"function"==typeof t?(r=t,n=e):n=t,super(((t,e)=>{n||(n={});const{abortSignal:s}=n;if(s&&s.aborted)return e(Do(s.reason));const[a,c]=Po(),u=t=>(...e)=>(c(),t(...e)),l=new AbortController,{signal:h}=l;i=u((t=>{l.abort(t),e(t)})),o=u(t),s&&a(Bo(s,"abort",(()=>{i(Do(s.reason))})));const{timeout:f}=n;if(f){const t=setTimeout((()=>{i(new Uo(jo,`Timeout reached: ${f}ms`))}),f);a((()=>{clearTimeout(t)}))}r&&r(o,i,h)})),Co(this,"reject"),this.reject=i}static withFn(t,e){return new Mo(((e,r,n)=>{try{const o=t(n);return o instanceof Promise?o.then(e,r):e(o)}catch(t){r(t)}}),e)}static resolve(t){return new Mo((e=>{e(t)}))}static reject(t){return new Mo(((e,r)=>{r(t)}))}cancel(){this.reject(new Uo(No))}catch(t){return this.then(void 0,t)}finally(t){return Ko(super.finally(t),this)}then(t,e){return Ko(super.then(t,e),this)}}function $o(t,e){return t.resolve=e.resolve,t}let Fo=class t extends Mo{constructor(t,e){let r,n,o;"function"==typeof t?(r=t,n=e):n=t,super(((t,e,n)=>{o=t,r&&r(t,e,n)}),n),Co(this,"resolve"),this.resolve=o}static withFn(e,r){return new t(((t,r,n)=>Mo.withFn(e,{abortSignal:n}).then(t,r)),r)}static resolve(e){return new t((t=>{t(e)}))}static reject(e){return new t(((t,r)=>{r(e)}))}catch(t){return this.then(void 0,t)}finally(t){return $o(super.finally(t),this)}then(t,e){return $o(super.then(t,e),this)}};function Wo(t){return`tapps/${t}`}function zo(t,e){sessionStorage.setItem(Wo(t),JSON.stringify(e))}function Zo(t){const e=sessionStorage.getItem(Wo(t));try{return e?JSON.parse(e):void 0}catch{}}function Ho(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}function Vo(t,e){e||(e={});const{textColor:r,bgColor:n,shouldLog:o=!0}=e;function i(e,...i){if(!o||"function"==typeof o&&!o())return;const s="font-weight:bold;padding:0 5px;border-radius:5px";console[e](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${t}`,`${s};background-color: lightblue;color:black`,"",`${s};${r?`color:${r};`:""}${n?`background-color:${n}`:""}`,...i)}return[function(...t){i("log",...t)},function(...t){i("error",...t)}]}function Xo(t,e){document.documentElement.style.setProperty(t,e)}function Jo(t){document.documentElement.style.removeProperty(t)}function qo(t,e){e||(e={});const r=e.equals||Object.is;let n=[],o=t;const i=t=>{if(!r(o,t)){const e=o;o=t,function(t,e){e()}(0,(()=>{[...n].forEach((([r,n])=>{r(t,e),n&&a(r,!0)}))}))}};function s(t){const e="object"!=typeof t?{once:t}:t;return{once:e.once||!1,signal:e.signal||!1}}const a=(t,e)=>{const r=s(e),o=n.findIndex((([e,n])=>e===t&&n.once===r.once&&n.signal===r.signal));o>=0&&n.splice(o,1)},c=Object.assign((function(){return function(t){Go.length&&Go[Go.length-1].add(t)}(c),o}),{destroy(){n=[]},set:i,reset(){i(t)},sub:(t,e)=>(n.push([t,s(e)]),()=>a(t,e)),unsub:a,unsubAll(){n=n.filter((t=>t[1].signal))}});return c}const Go=[];const Yo=qo(!1),[Qo,ti]=Vo("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:Yo}),ei={clipboard_text_received:lo({req_id:po(),data:t=>null===t?t:po(!0)(t)},"clipboard_text_received"),custom_method_invoked:lo({req_id:po(),result:t=>t,error:po(!0)},"custom_method_invoked"),popup_closed:uo("popup_closed",(t=>t?lo({button_id:t=>null==t?void 0:po()(t)})()(t):{})),viewport_changed:lo({height:go(),width:t=>null==t?window.innerWidth:go()(t),is_state_stable:fo(),is_expanded:fo()},"viewport_changed")};const ri=qo(),ni=qo();function oi(){return ni()||ni.set(function(t){const e=window,[,r]=Po(Bo(e,"message",(r=>{if(r.source!==e.parent)return;let n;try{n=To()(r.data)}catch{return}const{eventType:o,eventData:i}=n,s=ei[o];try{const e=s?s()(i):i;Qo("Event received:",e?{eventType:o,eventData:e}:{eventType:o}),t([o,e])}catch(t){ti([`An error occurred processing the "${o}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join("\n"),n,t)}})));return r}(ri.set)),ri}const ii=qo({});function si(t){let e=ii()[t];return e||(e=qo(void 0,{equals:()=>!1}),oi().sub((r=>{r&&r[0]===t&&e.set(r[1])})),ii.set({...ii(),[t]:e})),e}function ai(t,e,r){return si(t).sub(e,r)}const ci="ERR_RETRIEVE_LP_FAILED",ui="ERR_UNKNOWN_ENV",li="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",hi=qo("https://web.telegram.org");function fi(t,e){Qo("Posting event:",e?{eventType:t,eventData:e}:{eventType:t});const r=window;if(Oo(r))return void r.TelegramWebviewProxy.postEvent(t,JSON.stringify(e));const n=JSON.stringify({eventType:t,eventData:e});if(function(){try{return window.self!==window.top}catch{return!0}}())return r.parent.postMessage(n,hi());const{external:o}=r;if(!lo({notify:ko()})().isValid(o))throw new Uo(ui);o.notify(n)}function di(t,e,r){r||(r={});const{capture:n}=r,[o,i]=Po();return new Mo((i=>{(Array.isArray(e)?e:[e]).forEach((t=>{o(ai(t,(r=>{(!n||(Array.isArray(e)?n({event:t,payload:r}):n(r)))&&i(r)})))})),(r.postEvent||fi)(t,r.params)}),r).finally(i)}function pi(t){return So()(t)}function gi(t){return pi(t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function yi(){return gi(window.location.href)}function wi(){const t=performance.getEntriesByType("navigation")[0];if(!t)throw new Error("Unable to get first navigation entry.");return gi(t.name)}const mi="launchParams";function bi(){return pi(Zo(mi)||"")}function vi(t){zo("launchParams",Ao(t))}function _i(t){return t instanceof Error?t.message+(t.cause?`\n  ${_i(t.cause)}`:""):JSON.stringify(t)}function Ei(){const t=[];for(const e of[yi,wi,bi])try{const t=e();return vi(t),t}catch(e){t.push(e)}throw new Uo(ci,["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ð Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","Collected errors:",...t.map((t=>`â ${_i(t)}`))].join("\n"))}function Si(t){if("simple"===t)try{return Ei(),!0}catch{return!1}return Mo.withFn((async()=>{if(Oo(window))return!0;try{return await di("web_app_request_theme","theme_changed",{timeout:100}),!0}catch{return!1}}),t)}function Ai(t,e,r){si(t).unsub(e,r)}function Ti(t){return({req_id:e})=>e===t}function ki(t){return t.split(".").map(Number)}function Ii(t,e){return function(t,e){const r=ki(t),n=ki(e),o=Math.max(r.length,n.length);for(let t=0;t<o;t+=1){const e=r[t]||0,o=n[t]||0;if(e!==o)return e>o?1:-1}return 0}(t,e)<=0}function Oi(t,e,r){if("string"==typeof r){if("web_app_open_link"===t){if("try_instant_view"===e)return Ii("6.4",r);if("try_browser"===e)return Ii("7.6",r)}if("web_app_set_header_color"===t&&"color"===e)return Ii("6.9",r);if("web_app_close"===t&&"return_back"===e)return Ii("7.6",r);if("web_app_setup_main_button"===t&&"has_shine_effect"===e)return Ii("7.10",r)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return Ii("6.1",e);case"web_app_open_popup":return Ii("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return Ii("6.4",e);case"web_app_switch_inline_query":return Ii("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return Ii("6.9",e);case"web_app_setup_settings_button":return Ii("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return Ii("7.2",e);case"web_app_setup_swipe_behavior":return Ii("7.7",e);case"web_app_share_to_story":return Ii("7.8",e);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return Ii("7.10",e);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":return Ii("8.0",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function Ri(){const t=performance.getEntriesByType("navigation")[0];return!!t&&"reload"===t.type}let Ci;function Ui(t){if(Ci)return t();Ci=new Map;try{t()}finally{Ci.forEach((t=>t())),Ci=void 0}}function Bi(t,e){e||(e={});const r=e.equals||Object.is;let n=[],o=t;const i=t=>{if(!r(o,t)){const e=o;o=t,function(t,e){Ci&&Ci.set(t,e)||e()}(c,(()=>{[...n].forEach((([r,n])=>{r(t,e),n&&a(r,!0)}))}))}};function s(t){const e="object"!=typeof t?{once:t}:t;return{once:e.once||!1,signal:e.signal||!1}}const a=(t,e)=>{const r=s(e),o=n.findIndex((([e,n])=>e===t&&n.once===r.once&&n.signal===r.signal));o>=0&&n.splice(o,1)},c=Object.assign((function(){return function(t){Pi.length&&Pi[Pi.length-1].add(t)}(c),o}),{destroy(){n=[]},set:i,reset(){i(t)},sub:(t,e)=>(n.push([t,s(e)]),()=>a(t,e)),unsub:a,unsubAll(){n=n.filter((t=>t[1].signal))}});return c}const Pi=[];function Li(t,e){let r,n=new Set;function o(){return r||(r=Bi(s(),e))}function i(){o().set(s())}function s(){n.forEach((t=>{t.unsub(i,{signal:!0})}));const e=new Set;let r;Pi.push(e);try{r=t()}finally{Pi.pop()}return e.forEach((t=>{t.sub(i,{signal:!0})})),n=e,r}return Object.assign((function(){return o()()}),{destroy(){o().destroy()},sub:(...t)=>o().sub(...t),unsub(...t){o().unsub(...t)},unsubAll(...t){o().unsubAll(...t)}})}const xi=Bi((()=>{let t=0;return()=>(t+=1).toString()})()),Ni=Bi(fi),ji=Bi("0.0");function Di(){return xi()()}function Ki(t,e,r){return function(t,e,r,n){return di("web_app_invoke_custom_method","custom_method_invoked",{...n||{},params:{method:t,params:e,req_id:r},capture:Ti(r)}).then((({result:t,error:e})=>{if(e)throw new Uo(li,e);return t}))}(t,e,Di(),{...r||{},postEvent:$i})}const Mi=(t,e,r)=>(r||(r={}),r.postEvent||(r.postEvent=$i),di(t,e,r)),$i=(t,e)=>Ni()(t,e);function Fi(t){return Li((()=>Oi(t,ji())))}const Wi="ERR_POPUP_INVALID_PARAMS",zi="ERR_INVALID_URL",Zi="ERR_ALREADY_REQUESTING",Hi="ERR_ALREADY_OPENED",Vi="ERR_NOT_INITIALIZED",Xi="ERR_NOT_SUPPORTED",Ji="ERR_NOT_MOUNTED";function qi(){return typeof window>"u"}function Gi(t,e,{isSupported:r,isMounted:n,component:o,supports:i}={}){const s=`${o?`${o}.`:""}${t}()`;function a(t){if(i){const e=i[t];return Oi(e[0],e[1],ji())}return!0}r=r?Array.isArray(r)||"object"==typeof r&&"any"in r?r:[r]:void 0;const c=()=>{if(!r)return;const t=`it is unsupported in Mini Apps version ${ji()}`;function e(e){return"string"==typeof e?Oi(e,ji())?void 0:t:e.fn()?void 0:e.error}if(Array.isArray(r)){for(const t of r){const r=e(t);if(r)return r}return}let n;for(const t of r.any)if(n=e(t),!n)return;return t},u=Li((()=>!c())),l=Li((()=>"0.0"!==ji())),h=Li((()=>!n||n())),f=Li((()=>Si("simple")&&!qi()&&l()&&u()&&h()));let d;if(i){d={};for(const t in i)d[t]=Li((()=>a(t)))}return Object.assign(((...t)=>{const r=`Unable to call the ${s} ${o?"method":"function"}:`;if(qi()||!Si("simple"))throw new Uo(ui,`${r} it can't be called outside Mini Apps`);if(!l())throw new Uo(Vi,`${r} the SDK was not initialized. Use the SDK init() function`);const n=c();if(n)throw new Uo(Xi,`${r} ${n}`);const u=((...t)=>{if(i)for(const e in i)if(i[e][2](...t)&&!a(e))return`option ${e} is not supported in Mini Apps version ${ji()}`})(...t);if(u)throw new Uo(Xi,`${r} ${u}`);if(!h())throw new Uo(Ji,`${r} the component is not mounted. Use the ${o}.mount() method`);return e(...t)}),e,{isAvailable:f,ifAvailable:(...t)=>f()?e(...t):void 0},r?{isSupported:u}:{},d?{supports:d}:{})}function Yi(t,e){return e||(e={}),(r,n,o,i)=>Gi(r,n,{...e,isSupported:o||e.isSupported,supports:i,component:t})}function Qi(t,e,r){return Yi(t,{isSupported:r,isMounted:e})}function ts(t,e){return Yi(t,{isSupported:e})}const es="web_app_setup_back_button",rs="back_button_pressed",ns="backButton",os=Bi(!1),is=Bi(!1),ss=Fi(es),as=Qi(ns,is,es),cs=ts(ns,es),us=as("hide",(()=>{hs(!1)})),ls=cs("mount",(()=>{is()||(hs(Ri()&&Zo(ns)||!1),is.set(!0))}));function hs(t){t!==os()&&($i(es,{is_visible:t}),zo(ns,t),os.set(t))}const fs=cs("onClick",(t=>ai(rs,t))),ds=cs("offClick",(t=>{Ai(rs,t)})),ps=as("show",(()=>{hs(!0)}));Symbol.toStringTag;function gs(t,e,r,n,o){const i=void 0===o||o?Mo:Promise;return Object.assign(((...o)=>i.resolve().then((async()=>{if(r()){const t=e();throw n.set(t),t}let s;Ui((()=>{r.set(i.resolve(t(...o))),n.set(void 0)}));try{s=[!0,await r()]}catch(t){s=[!1,t]}if(Ui((()=>{r.set(void 0),n.set(s[0]?void 0:s[1])})),!s[0])throw s[1];return s[1]}))),t)}function ys(t,e,r,n,o,i){const s=gs(e,(()=>new Uo("ERR_ALREADY_MOUNTING",`The ${t} component is already mounting`)),o,i);return t=>Mo.resolve().then((async()=>{if(!n()){const e=await s(t);Ui((()=>{n.set(!0),r(e)}))}}))}const ws=Yi,ms=Bi({available:!1}),bs=Bi(!1),vs=Bi(!1),_s=Bi(!1),Es=Li((()=>!!As())),Ss=Bi(),As=Bi(),Ts=Li((()=>{const t=ms();return t&&t.available}));function ks(t){return t.available?{available:!0,tokenSaved:t.token_saved,deviceId:t.device_id,accessRequested:t.access_requested,type:t.type,accessGranted:t.access_granted}:{available:!1}}const Is="web_app_biometry_get_info",Os=Gi("requestBiometry",(t=>Mi(Is,"biometry_info_received",t).then(ks)),{isSupported:Is}),Rs="web_app_biometry_request_auth",Cs="biometry_info_received",Us="biometry",Bs=Fi(Rs),Ps=ws(Us),Ls=ts(Us,Rs),xs=Qi(Us,_s,Rs);function Ns(){throw new Uo("ERR_NOT_AVAILABLE","Biometry is not available")}const js=xs("authenticate",(t=>Mo.withFn((async e=>{if(bs())throw new Uo(Zi,"Authentication is already in progress");const r=ms();(!r||!r.available)&&Ns(),bs.set(!0);try{const n=await Mi(Rs,"biometry_auth_requested",{abortSignal:e,params:{reason:((t||{}).reason||"").trim()}}),{token:o}=n;return"string"==typeof o&&Fs({...r,token:o}),n}finally{bs.set(!1)}}),t))),Ds=Ls("openSettings",(()=>{$i("web_app_biometry_open_settings")})),Ks=xs("requestAccess",(t=>Mo.withFn((async e=>{if(vs())throw new Uo(Zi,"Access request is already in progress");vs.set(!0);try{const r=await Mi("web_app_biometry_request_access",Cs,{abortSignal:e,params:{reason:(t||{}).reason||""}}).then(ks);return r.available||Ns(),Fs(r),r.accessGranted}finally{vs.set(!1)}}),t))),Ms=Ps("mount",ys(Us,(t=>Ri()&&Zo(Us)||Os(t)),(t=>{ai(Cs,$s),Fs(t)}),_s,As,Ss)),$s=t=>{Fs(ks(t))};function Fs(t){ms.set(t),zo(Us,t)}const Ws=xs("updateToken",(t=>(t||(t={}),Mi("web_app_biometry_update_token","biometry_token_updated",{...t,params:{token:t.token||"",reason:t.reason}}).then((t=>t.status)))));Symbol.toStringTag;function zs(t,e){return Yi(t,{isMounted:e})}const Zs="closingBehavior",Hs=Bi(!1),Vs=Bi(!1),Xs=zs(Zs,Vs),Js=ws(Zs),qs=Xs("disableConfirmation",(()=>{Qs(!1)})),Gs=Xs("enableConfirmation",(()=>{Qs(!0)})),Ys=Js("mount",(()=>{Vs()||(Qs(Ri()&&Zo(Zs)||!1),Vs.set(!0))}));function Qs(t){t!==Hs()&&($i("web_app_setup_closing_behavior",{need_confirmation:t}),zo(Zs,t),Hs.set(t))}Symbol.toStringTag;const ta="web_app_invoke_custom_method",ea=ts("cloudStorage",ta),ra=Fi(ta),na=ea("deleteItem",((t,e)=>{const r=Array.isArray(t)?t:[t];return r.length?Ki("deleteStorageValues",{keys:r},e).then():Mo.resolve()}));const oa=ea("getItem",(function(t,e){const r=Array.isArray(t)?t:[t];return r.length?Ki("getStorageValues",{keys:r},e).then((e=>{const n=Vn(Object.fromEntries(r.map((t=>[t,Jn()]))))()(e);return Array.isArray(t)?n:n[t]})):Mo.resolve("string"==typeof t?"":{})})),ia=ea("getKeys",(t=>Ki("getStorageKeys",{},t).then(function(t,e){return Hn("array",(e=>{let r;if(Array.isArray(e))r=e;else if("string"==typeof e)try{const t=JSON.parse(e);Array.isArray(t)&&(r=t)}catch{}return r||Xn(e),r.map(t)}))}(Jn())()))),sa=ea("setItem",((t,e,r)=>Ki("saveStorageValue",{key:t,value:e},r).then())),aa=(Symbol.toStringTag,"web_app_trigger_haptic_feedback"),ca=ts("hapticFeedback",aa),ua=Fi(aa),la=ca("impactOccurred",(t=>{$i(aa,{type:"impact",impact_style:t})})),ha=ca("notificationOccurred",(t=>{$i(aa,{type:"notification",notification_type:t})})),fa=ca("selectionChanged",(()=>{$i(aa,{type:"selection_change"})})),da=(Symbol.toStringTag,Bi(void 0));function pa(t){return Li((()=>{const e=da();return e?e[t]:void 0}))}const ga=pa("authDate"),ya=pa("canSendAfter"),wa=Li((()=>{const t=ga(),e=ya();return e&&t?new Date(t.getTime()+1e3*e):void 0})),ma=pa("chat"),ba=pa("chatType"),va=pa("chatInstance"),_a=pa("hash"),Ea=pa("queryId"),Sa=Bi(),Aa=pa("receiver");const Ta=pa("startParam"),ka=pa("user");Symbol.toStringTag;const Ia="web_app_open_invoice",Oa=ts("invoice",Ia),Ra=Bi(!1),Ca=Fi(Ia);async function Ua(t,e,r){if(Ra())throw new Uo(Hi,"An invoice is already opened");let n;if("url"===e){const{hostname:e,pathname:r}=new URL(t,window.location.href);if("t.me"!==e)throw new Uo(zi,`Link has unexpected hostname: ${e}`);const o=r.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!o)throw new Uo("ERR_INVALID_SLUG",'Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,n]=o}else n=t,r=e;return Ra.set(!0),Mi(Ia,"invoice_closed",{...r,params:{slug:n},capture:t=>n===t.slug}).then((t=>t.status)).finally((()=>{Ra.set(!1)}))}const Ba=Oa("open",Ua);Symbol.toStringTag;function Pa(t){return Object.fromEntries(Object.entries(t).filter((t=>void 0!==t[1])))}function La(t){const e=Yn(t);return Math.sqrt([.299,.587,.114].reduce(((t,r,n)=>{const o=parseInt(e.slice(1+2*n,1+2*(n+1)),16);return t+o*o*r}),0))<120}const xa=Bi(!1),Na=Bi(!1),ja=Bi({});function Da(t){return Li((()=>ja()[t]))}const Ka=Da("accentTextColor"),Ma=Da("bgColor"),$a=Da("buttonColor"),Fa=Da("buttonTextColor"),Wa=Da("bottomBarBgColor"),za=Da("destructiveTextColor"),Za=Da("headerBgColor"),Ha=Da("hintColor"),Va=Li((()=>{const{bgColor:t}=ja();return!t||La(t)})),Xa=Da("linkColor"),Ja=Da("secondaryBgColor"),qa=Da("sectionBgColor"),Ga=Da("sectionHeaderTextColor"),Ya=Da("sectionSeparatorColor"),Qa=Da("subtitleTextColor"),tc=Da("textColor");function ec(t){return Li((()=>nc()[t]))}const rc=Bi({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),nc=Li((()=>{const t=rc();return{...t,backgroundColor:t.backgroundColor||$a()||"#2481cc",textColor:t.textColor||Fa()||"#ffffff"}})),oc=Bi(!1),ic=ec("backgroundColor"),sc=ec("hasShineEffect"),ac=ec("isEnabled"),cc=ec("isLoaderVisible"),uc=ec("isVisible"),lc=ec("text"),hc=ec("textColor"),fc="main_button_pressed",dc="mainButton",pc=ws(dc),gc=zs(dc,oc),yc=pc("mount",(()=>{if(!oc()){const t=Ri()&&Zo(dc);t&&rc.set(t),oc.set(!0)}})),wc=pc("onClick",(t=>ai(fc,t))),mc=pc("offClick",(t=>{Ai(fc,t)})),bc=gc("setParams",(t=>{rc.set({...rc(),...Pa(t)}),zo(dc,rc());const e=nc();e.text&&$i("web_app_setup_main_button",{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,text:e.text,text_color:e.textColor})}));Symbol.toStringTag;function vc(){throw new Uo("ERR_VARS_ALREADY_BOUND","CSS variables are already bound")}const _c="themeParams",Ec="theme_changed",Sc=ws(_c),Ac=zs(_c,xa)("bindCssVars",(t=>{function e(t){Object.entries(ja()).forEach((([e,r])=>{r&&t(e,r)}))}function r(){e(((e,r)=>{Xo(t(e),r)}))}return Na()&&vc(),t||(t=t=>`--tg-theme-${Ho(t)}`),r(),ja.sub(r),Na.set(!0),()=>{e(Jo),ja.unsub(r),Na.set(!1)}})),Tc=Sc("mount",(()=>{xa()||(ai(Ec,kc),ja.set(Ri()&&Zo(_c)||Ei().themeParams),xa.set(!0))})),kc=t=>{const e=function(t){return to()(t)}(t.theme_params);ja.set(e),zo(_c,e)};function Ic(t){return Li((()=>{const e=t();return Gn(e)?e:"bg_color"===e?Ma():Ja()}))}const Oc=Bi("bg_color"),Rc=Ic(Oc),Cc=Bi("bottom_bar_bg_color"),Uc=Li((()=>{const t=Cc();return Gn(t)?t:"bottom_bar_bg_color"===t?Wa()||Ja():"secondary_bg_color"===t?Ja():Ma()})),Bc=Bi("bg_color"),Pc=Ic(Bc),Lc=Bi(!1),xc=Bi(!1),Nc=Li((()=>{const t=Rc();return!!t&&La(t)})),jc=Bi(!0),Dc=Li((()=>({backgroundColor:Oc(),bottomBarColor:Cc(),headerColor:Bc(),isActive:jc()}))),Kc="web_app_set_background_color",Mc="web_app_set_bottom_bar_color",$c="web_app_set_header_color",Fc="visibility_changed",Wc="miniApp",zc={any:[Kc,Mc,$c]},Zc=Li((()=>zc.any.some((t=>Oi(t,ji()))))),Hc=ws(Wc),Vc=ts(Wc,zc),Xc=Qi(Wc,Lc,zc),Jc=Xc("bindCssVars",(t=>{xc()&&vc();const[e,r]=Po();function n(t,r){function n(){Xo(t,r()||null)}n(),e(r.sub(n),Jo.bind(null,t))}return t||(t=t=>`--tg-${Ho(t)}`),n(t("bgColor"),Rc),n(t("bottomBarColor"),Uc),n(t("headerColor"),Pc),e((()=>{xc.set(!1)})),xc.set(!0),r})),qc=Hc("close",(t=>{$i("web_app_close",{return_back:t})})),Gc=t=>{jc.set(t.is_visible),tu()},Yc=Vc("mount",(()=>{if(!Lc()){const t=Ri()&&Zo(Wc);Tc(),eu.ifAvailable(t?t.backgroundColor:"bg_color"),ru.ifAvailable(t?t.bottomBarColor:"bottom_bar_bg_color"),nu.ifAvailable(t?t.headerColor:"bg_color"),jc.set(!t||t.isActive),ai(Fc,Gc),Lc.set(!0)}})),Qc=Hc("ready",(()=>{$i("web_app_ready")}));function tu(){zo(Wc,Dc())}const eu=Xc("setBackgroundColor",(t=>{t!==Oc()&&($i(Kc,{color:t}),Oc.set(t),tu())}),Kc),ru=Xc("setBottomBarColor",(t=>{t!==Cc()&&($i(Mc,{color:t}),Cc.set(t),tu())}),Mc),nu=Xc("setHeaderColor",(t=>{t!==Bc()&&($i($c,Gn(t)?{color:t}:{color_key:t}),Bc.set(t),tu())}),$c,{rgb:[$c,"color",Gn]});Symbol.toStringTag;function ou(t){const e=t.message.trim(),r=(t.title||"").trim(),n=t.buttons||[];if(r.length>64)throw new Uo(Wi,`Invalid title: ${r}`);if(!e||e.length>256)throw new Uo(Wi,`Invalid message: ${e}`);if(n.length>3)throw new Uo(Wi,`Invalid buttons count: ${n.length}`);return{title:r,message:e,buttons:n.length?n.map(((t,e)=>{const r=t.id||"";if(r.length>64)throw new Uo(Wi,`Button with index ${e} has invalid id: ${r}`);if(!t.type||"default"===t.type||"destructive"===t.type){const n=t.text.trim();if(!n||n.length>64)throw new Uo(Wi,`Button with index ${e} has invalid text: ${n}`);return{type:t.type,text:n,id:r}}return{type:t.type,id:r}})):[{type:"close",id:""}]}}const iu="web_app_open_popup",su=ts("popup",iu),au=Bi(!1),cu=Fi(iu),uu=su("open",(async t=>{if(au())throw new Uo(Hi,"A popup is already opened");au.set(!0);try{const{button_id:e=null}=await Mi(iu,"popup_closed",{...t,params:ou(t)});return e}finally{au.set(!1)}})),lu=(Symbol.toStringTag,"web_app_open_scan_qr_popup"),hu=ts("qrScanner",lu),fu=hu("close",(()=>{du.set(!1),$i("web_app_close_scan_qr_popup")})),du=Bi(!1),pu=Fi(lu);const gu=hu("open",(function(t){return Mo.withFn((e=>{if(du())throw new Uo(Hi,"The QR Scanner is already opened");du.set(!0),t||(t={});const{onCaptured:r,text:n,capture:o}=t,[,i]=Po(du.sub((()=>{s.resolve()})),ai("scan_qr_popup_closed",(()=>{du.set(!1)})),ai("qr_text_received",(t=>{r?r(t.data):(!o||o(t.data))&&(s.resolve(t.data),fu())}))),s=new Fo({abortSignal:e}).catch(fu).finally(i);return(t.postEvent||$i)(lu,{text:n}),s}),t)}));Symbol.toStringTag;function yu(t){return Li((()=>mu()[t]))}const wu=Bi({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),mu=Li((()=>{const t=wu();return{...t,backgroundColor:t.backgroundColor||Uc()||"#000000",textColor:t.textColor||$a()||"#2481cc"}})),bu=Bi(!1),vu=yu("backgroundColor"),_u=yu("hasShineEffect"),Eu=yu("isEnabled"),Su=yu("isLoaderVisible"),Au=yu("isVisible"),Tu=yu("position"),ku=yu("text"),Iu=yu("textColor"),Ou="web_app_setup_secondary_button",Ru="secondary_button_pressed",Cu="secondaryButton",Uu=ts(Cu,Ou),Bu=Qi(Cu,bu,Ou),Pu=Fi(Ou),Lu=Uu("mount",(()=>{if(!bu()){const t=Ri()&&Zo(Cu);t&&wu.set(t),bu.set(!0)}})),xu=Uu("onClick",(t=>ai(Ru,t))),Nu=Uu("offClick",(t=>{Ai(Ru,t)})),ju=Bu("setParams",(t=>{wu.set({...wu(),...Object.fromEntries(Object.entries(t).filter((([,t])=>void 0!==t)))}),zo(Cu,wu());const e=mu();e.text&&$i(Ou,{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,position:e.position,text:e.text,text_color:e.textColor})}));Symbol.toStringTag;const Du="web_app_setup_settings_button",Ku="settings_button_pressed",Mu="settingsButton",$u=Bi(!1),Fu=Bi(!1),Wu=Fi(Du),zu=ts(Mu,Du),Zu=Qi(Mu,Fu,Du),Hu=Zu("hide",(()=>{Xu(!1)})),Vu=zu("mount",(()=>{Fu()||(Xu(Ri()&&Zo(Mu)||!1),Fu.set(!0))}));function Xu(t){t!==$u()&&($i(Du,{is_visible:t}),zo(Mu,t),$u.set(t))}const Ju=zu("onClick",(t=>ai(Ku,t))),qu=zu("offClick",(t=>{Ai(Ku,t)})),Gu=Zu("show",(()=>{Xu(!0)}));Symbol.toStringTag;const Yu="web_app_setup_swipe_behavior",Qu="swipeBehavior",tl=Bi(!1),el=Fi(Yu),rl=Bi(!0),nl=ts(Qu,Yu),ol=Qi(Qu,tl,Yu),il=ol("disableVertical",(()=>{cl(!1)})),sl=ol("enableVertical",(()=>{cl(!0)})),al=nl("mount",(()=>{tl()||(cl(Ri()&&Zo(Qu)||!1,!0),tl.set(!0))}));function cl(t,e){(t!==rl()||e)&&($i(Yu,{allow_vertical_swipe:t}),zo(Qu,t),rl.set(t))}Symbol.toStringTag,Symbol.toStringTag;const ul="viewport",ll="web_app_request_fullscreen",hl="fullscreen_changed",fl="safe_area_changed",dl="content_safe_area_changed",pl="viewport_changed",gl="web_app_request_safe_area",yl="web_app_request_content_safe_area",wl={left:0,top:0,bottom:0,right:0};function ml(t){return Math.max(t,0)}const bl=Bi({contentSafeAreaInsets:wl,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:wl,stableHeight:0,width:0});function vl(t){return Li((()=>bl()[t]))}function _l(t){const{height:e,stableHeight:r,width:n}=t;bl.set({...bl(),...Pa({...t,height:e?ml(e):void 0,width:n?ml(n):void 0,stableHeight:r?ml(r):void 0})}),zo(ul,bl())}const El=vl("isFullscreen"),Sl=Bi(),Al=Li((()=>!!Sl())),Tl=Bi(),kl=Bi(!1),Il=Li((()=>!!Rl())),Ol=Bi(void 0),Rl=Bi(),Cl=Qi(ul,kl,ll);function Ul(t,e){return Cl(t,gs((t=>Mi(e,[hl,"fullscreen_failed"],t).then((t=>{if("error"in t){if("ALREADY_FULLSCREEN"===t.error)return!0;throw new Uo("ERR_FULLSCREEN_FAILED","Fullscreen request failed",t.error)}return t.is_fullscreen})).then((t=>{t!==El()&&_l({isFullscreen:t})}))),(()=>new Uo(Zi,"Fullscreen mode change is already being requested")),Sl,Tl))}const Bl=Ul("requestFullscreen",ll),Pl=Ul("exitFullscreen","web_app_exit_fullscreen"),Ll=ws(ul),xl=zs(ul,kl);function Nl(t){return Li((()=>jl()[t]))}const jl=vl("safeAreaInsets"),Dl=Nl("bottom"),Kl=Nl("left"),Ml=Nl("right"),$l=Nl("top");function Fl(t){return Li((()=>Wl()[t]))}const Wl=vl("contentSafeAreaInsets"),zl=Fl("bottom"),Zl=Fl("left"),Hl=Fl("right"),Vl=Fl("top"),Xl=Gi("requestContentSafeAreaInsets",(t=>Mi(yl,"content_safe_area_changed",t)),{isSupported:yl}),Jl=Gi("requestSafeAreaInsets",(t=>Mi(gl,"safe_area_changed",t)),{isSupported:gl});const ql=t=>{const{height:e}=t;_l({isExpanded:t.is_expanded,height:e,width:t.width,stableHeight:t.is_state_stable?e:void 0})},Gl=t=>{_l({isFullscreen:t.is_fullscreen})},Yl=t=>{_l({safeAreaInsets:t})},Ql=t=>{_l({contentSafeAreaInsets:t})},th=Ll("mount",ys(ul,(t=>Mo.resolve().then((async()=>{const e=Ri()&&Zo(ul);if(e)return e;const[r,n]=await Mo.all([Jl.ifAvailable(t)||jl(),Xl.ifAvailable(t)||Wl()]),o=Ei(),i={contentSafeAreaInsets:n,isFullscreen:!!o.fullscreen,safeAreaInsets:r};if(["macos","tdesktop","unigram","webk","weba","web"].includes(o.platform)){const t=window;return{...i,height:t.innerHeight,isExpanded:!0,stableHeight:t.innerHeight,width:t.innerWidth}}return function(t){return Mi("web_app_request_viewport","viewport_changed",t).then((t=>({height:t.height,width:t.width,isExpanded:t.is_expanded,isStable:t.is_state_stable})))}(t).then((t=>({...i,height:t.height,isExpanded:t.isExpanded,stableHeight:t.isStable?t.height:0,width:t.width})))}))),(t=>{ai(pl,ql),ai(hl,Gl),ai(fl,Yl),ai(dl,Ql),_l(t)}),kl,Rl,Ol));const eh=Bi(!1),rh=vl("height"),nh=vl("stableHeight"),oh=vl("width"),ih=xl("bindCssVars",(t=>{eh()&&vc(),t||(t=t=>`--tg-viewport-${Ho(t)}`);const e=[["height",rh],["stableHeight",nh],["width",oh],["safeAreaInsetTop",$l],["safeAreaInsetBottom",Dl],["safeAreaInsetLeft",Kl],["safeAreaInsetRight",Ml],["contentSafeAreaInsetTop",Vl],["contentSafeAreaInsetBottom",zl],["contentSafeAreaInsetLeft",Zl],["contentSafeAreaInsetRight",Hl]].reduce(((e,[r,n])=>{const o=t(r);if(o){const t=()=>{Xo(o,`${n()}px`)};e.push([t,n.sub(t),o])}return e}),[]);return e.forEach((t=>{t[0]()})),eh.set(!0),()=>{e.forEach((t=>{t[1](),Jo(t[2])})),eh.set(!1)}})),sh=Ll("expand",(()=>{$i("web_app_expand")})),ah=vl("isExpanded"),ch=Li((()=>rh()===nh())),uh=(Symbol.toStringTag,ws()("openLink",((t,e)=>{if("string"==typeof t)try{t=new URL(t)}catch(e){throw new Uo(zi,`"${t.toString()}" is invalid URL`,e)}e||(e={}),$i("web_app_open_link",{url:t.toString(),try_browser:e.tryBrowser,try_instant_view:e.tryInstantView})})),"web_app_open_tg_link"),lh=ws()("openTelegramLink",(t=>{const e=t.toString();if(!e.match(/^https:\/\/t.me\/.+/))throw new Uo(zi,`"${e}" is invalid URL`);Oi(uh,ji())?(t=new URL(t),$i(uh,{path_full:t.pathname+t.search})):window.location.href=e}));ws()("shareURL",((t,e)=>{lh("https://t.me/share/url?"+new URLSearchParams({url:t,text:e||""}).toString().replace(/\+/g,"%20"))}));function hh(){try{const t=document.createElement("iframe"),e=function(){if("undefined"!=typeof chrome&&chrome.runtime)return chrome.runtime.getURL("data_request_iframe.html");const t=window.location.origin,e="undefined"!=typeof window&&window.__NEXT_DATA__;return"".concat(t,e?"/_next/static/data_request_iframe.html":"/data_request_iframe.html")}();t.setAttribute("src",e),t.setAttribute("title","Onairos Terminal"),t.classList.add("iframe-class"),t.style.width="100%",t.style.height="600px",t.style.border="none",t.style.backgroundColor="transparent";const r=400,n=600,o=10,i=window.innerWidth-r-10,s=window.open(e,"Onairos Terminal","width=".concat(r,",height=").concat(n,",top=").concat(o,",left=").concat(i,",resizable=no"));if(!s)throw new Error("Failed to open window - popup blocked");return s.document.body.style.margin="0",s.document.body.style.padding="0",s.document.body.style.overflow="hidden",s.addEventListener("beforeunload",(()=>{window.postMessage({action:"terminalClosed"},"*")})),s}catch(t){return console.error("Error opening iframe:",t),alert("Unable to open Onairos Terminal. Please ensure popups are allowed for this site."),null}}function fh(t){if(t&&!t.closed)try{t.close(),window.postMessage({action:"terminalClosed"},"*")}catch(t){console.error("Error closing iframe:",t)}}const dh=async()=>(await a.e(423).then(a.t.bind(a,153,23))).default;function ph(t){let{requestData:n,webpageName:o,inferenceData:i=null,onComplete:s=null,autoFetch:a=!0,proofMode:c=!1,textLayout:u="below",textColor:l="white",login:h=!1,buttonType:f="pill",loginReturn:d=null,loginType:p="signIn",visualType:g="full"}=t;const y=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return void 0!==window.Telegram&&/telegram/i.test(t)&&/mobile/i.test(navigator.userAgent)},[w,m]=(0,e.useState)(null);(0,e.useEffect)((()=>{let t=!0;if(y()){const r=(0,e.useMemo)(Ei,[]);t&&m(r)}return()=>{t=!1}}),[]),(0,e.useEffect)((()=>{if(w&&(console.log("Launch Params:",w),w.startParam))try{ht("Received parameters: ".concat(w.startParam)),q({show:!0,type:"callback",data:{startParam:w.startParam}})}catch(t){console.error("Error parsing launch params:",t)}}),[w]),(0,e.useEffect)((()=>{if(y())try{var t;const e=null===(t=window.Telegram)||void 0===t?void 0:t.WebApp;e&&e.ready()}catch(t){console.error("Error initializing Telegram WebApp:",t)}}),[]);const[b,v]=(0,e.useState)(null),[_,E]=(0,e.useState)(!1),[S,A]=(0,e.useState)([]),[T,k]=(0,e.useState)(0),[I,O]=(0,e.useState)({}),[R,C]=(0,e.useState)(!1),[U,B]=(0,e.useState)(!1),[P,L]=(0,e.useState)(!1),[x,N]=(0,e.useState)(!1),j=(0,e.useRef)(!1),D=(0,e.useRef)(!1),[K,M]=(0,e.useState)(!1),[$,F]=(0,e.useState)(null),[W,z]=(0,e.useState)(!0),[Z,H]=(0,e.useState)(null),[V,X]=(0,e.useState)(null),[J,q]=(0,e.useState)({show:!1,type:null,data:null}),[G,Y]=(0,e.useState)(null),[Q,tt]=(0,e.useState)(!1),[et,rt]=(0,e.useState)(!1),nt=(0,e.useRef)(!1),[ot,it]=(0,e.useState)(null),[st,at]=(0,e.useState)({show:!1,color:null,message:null}),[ct,ut]=(0,e.useState)(null),[lt,ht]=(0,e.useState)("Initializing..."),ft="https://api2.onairos.uk";(0,e.useEffect)((()=>{if(!y())return;(async()=>{const t=new URL(window.location.href),e=t.searchParams.get("code"),r=t.searchParams.get("state");if(e&&r&&!nt.current&&!et){nt.current=!0,rt(!0);try{const t=await fetch("".concat(ft,"/auth/callback"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,state:r})});if(!t.ok)throw new Error("Failed to get Othent token");const{sessionId:n}=await t.json();(async()=>{const t=setInterval((async()=>{try{const e=await fetch("".concat(ft,"/auth/token/").concat(n),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("HTTP error! Status: ".concat(e.status));const r=await e.json();r.othentToken&&(clearInterval(t),await dt(r.othentToken),N(!0),window.history.replaceState({},document.title,window.location.pathname))}catch(e){console.error("Error polling for token:",e),clearInterval(t),it("Failed to retrieve authentication token"),rt(!1)}}),3e3);setTimeout((()=>{clearInterval(t),x||(it("Authentication timeout"),rt(!1))}),12e4)})()}catch(t){console.error("Auth callback processing failed:",t),it(t.message),rt(!1)}}})()}),[]);const dt=async t=>{try{const e=new jn({appInfo:{name:"Onairos",version:"1.0.0",env:"production"},throwErrors:!0,auth0LogInMethod:"redirect",auth0RedirectURI:window.location.href,auth0ReturnToURI:window.location.href}),r=await e.completeConnectionWithToken(t);M(!0);const n=(await dh())(r.sub).toString();H(n);const o=await Dn(n);X(o.result),F(o.token),await _t(r.email,!0),E(!0),localStorage.setItem("othentToken",JSON.stringify(r)),localStorage.setItem("onairosToken",r.token)}catch(t){throw at({show:!0,color:"red",message:"An error has occurred, please try again"}),console.error("Authentication failed:",t),t}finally{rt(!1)}};(0,e.useEffect)((()=>{ot&&console.error("Authentication error:",ot)}),[ot]);const pt=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(t)};(0,e.useEffect)((()=>{if(a&&i&&"function"==typeof s){const t=async t=>{if(t.data&&"content-script"===t.data.source&&"API_URL_RESPONSE"===t.data.type&&"Onairos-Response"===t.data.unique){const{APIurl:e,approved:r,accessToken:n}=t.data,o=(t=>{const e={Small:16,Medium:32,Large:64};let r=null,n=0;return t.forEach((t=>{const o=e[t.data];o>n&&(n=o,r=t)})),n})(r),a={Input:i.slice(0,o)};try{const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(a)}),r=await t.json();s(r)}catch(t){console.error(t),s(null,t)}}};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}}),[]);window.location.href;const[gt,yt]=(0,e.useState)(null),wt=(0,e.useRef)(null);(0,e.useEffect)((()=>()=>{wt.current&&wt.current(),gt&&fh(gt)}),[gt]);const mt="flex items-center justify-center font-bold rounded cursor-pointer ".concat("pill"===f?"px-4 py-2":"w-12 h-12"," bg-transparent OnairosConnect"),bt={flexDirection:"below"===u?"column":"row",backgroundColor:"transparent",color:l,border:"1px solid transparent"},vt={width:"20px",height:"20px",marginRight:"full"===g?"12px":"0"},_t=async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const r=e?{Info:{identifier:t}}:{Info:{userName:t}},n=e?"/getAccountInfo/email":"/getAccountInfo",o=await fetch("".concat(ft).concat(n),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("onairosToken"))},body:JSON.stringify(r)});if(!o.ok)throw new Error("Failed to fetch account info");const i=await o.json();return"No Account Found"===i.AccountInfo?(j.current=!0,Y(null),null):(Y(i.AccountInfo),i.AccountInfo.models?A(i.AccountInfo.models):D.current=!0,i.AccountInfo.avatar&&C(!0),i.AccountInfo.UserTraits&&B(!0),i.AccountInfo.othent&&L(!0),i.AccountInfo)}catch(t){throw console.error("Error fetching account info:",t),t}};(0,e.useEffect)((()=>{pt()&&(async()=>{try{const t=localStorage.getItem("onairosToken"),e=localStorage.getItem("token"),r=t||e;if(r){const t=await fetch("https://api2.onairos.uk/verifyToken",{headers:{Authorization:"Bearer ".concat(r)}});if(t.ok)if((await t.json()).valid){F(r),M(!0);const t=localStorage.getItem("username");await _t(t)}else localStorage.removeItem("onairosToken"),localStorage.removeItem("token")}}catch(t){console.error("Token verification failed:",t)}finally{z(!1)}})()}),[]);(0,e.useEffect)((()=>{const t=localStorage.getItem("onairosToken"),e=localStorage.getItem("username");t&&e&&_t(e,!1)}),[]);return(0,e.useEffect)((()=>{(async()=>{const t=localStorage.getItem("onairosToken"),e=localStorage.getItem("username"),r=localStorage.getItem("othentToken");if(t)try{if((await fetch("".concat(ft,"/verifyToken"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})).ok){if(M(!0),e)await _t(e,!1);else if(r){const t=JSON.parse(r);await _t(t.email,!0)}}else localStorage.removeItem("onairosToken"),localStorage.removeItem("username"),localStorage.removeItem("othentToken")}catch(t){console.error("Token verification failed:",t)}})()}),[]),r().createElement("div",{className:"flex items-center justify-center"},r().createElement("button",{className:mt,onClick:async()=>{try{const t=hh();if(!t)return void console.error("Failed to open iframe window");yt(t);const e=function(t){const e=e=>{e.data&&"onairosIframe"===e.data.source&&t(e.data)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}((async e=>{try{"iframeReady"===e.action?await function(t,e){return new Promise(((r,n)=>{if(t&&!t.closed)try{t.postMessage(e,"*");const o=setTimeout((()=>{n(new Error("Timeout waiting for iframe response"))}),5e3),i=t=>{t.data&&"dataReceived"===t.data.action&&(clearTimeout(o),window.removeEventListener("message",i),r())};window.addEventListener("message",i)}catch(t){n(t)}else n(new Error("Iframe window is not available"))}))}(t,{type:"initDataRequest",requestData:n,dataRequester:o,domain:window.location.href}):"dataRequestConfirmed"===e.action?(s&&await s(e.approvedRequests),yt(null)):"dataRequestRejected"===e.action?(s&&await s(null),yt(null)):"terminalClosed"===e.action&&yt(null)}catch(e){console.error("Error handling iframe message:",e),fh(t),yt(null)}}));wt.current=e}catch(t){console.error("Error in openTerminal:",t),yt(null)}},style:bt},("full"===g||"icon"===g)&&r().createElement("img",{src:"https://onairos.sirv.com/Images/OnairosBlack.png",alt:"Onairos Logo",style:vt,className:"".concat("pill"===f?"w-6 h-6":"w-8 h-8"," object-contain")}),("full"===g||"textOnly"===g)&&r().createElement("span",{className:"".concat("black"===l?"text-black":"text-white"," ").concat("icon"===g?"sr-only":""," ").concat("right"===u?"ml-2":"left"===u?"mr-2":"")},(()=>{switch(p){case"signUp":return"Sign Up with Onairos";case"signOut":return"Sign Out of Onairos";default:return"Sign In with Onairos"}})())))}function gh(t){return r().createElement(r().Fragment,null,r().createElement(ph,t))}const yh=gh})(),c})()));
//# sourceMappingURL=onairos.bundle.js.map